var t=Object.defineProperty,e=Object.prototype.hasOwnProperty,n=Object.getOwnPropertySymbols,i=Object.prototype.propertyIsEnumerable,s=(e,n,i)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i,r=(t,r)=>{for(var o in r||(r={}))e.call(r,o)&&s(t,o,r[o]);if(n)for(var o of n(r))i.call(r,o)&&s(t,o,r[o]);return t};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const o="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,a=(t,e,n=null)=>{for(;e!==n;){const n=e.nextSibling;t.removeChild(e),e=n}},c=`{{lit-${String(Math.random()).slice(2)}}}`,h=`\x3c!--${c}--\x3e`,l=new RegExp(`${c}|${h}`);class u{constructor(t,e){this.parts=[],this.element=e;const n=[],i=[],s=document.createTreeWalker(e.content,133,null,!1);let r=0,o=-1,a=0;const{strings:h,values:{length:u}}=t;for(;a<u;){const t=s.nextNode();if(null!==t){if(o++,1===t.nodeType){if(t.hasAttributes()){const e=t.attributes,{length:n}=e;let i=0;for(let t=0;t<n;t++)d(e[t].name,"$lit$")&&i++;for(;i-- >0;){const e=h[a],n=g.exec(e)[2],i=n.toLowerCase()+"$lit$",s=t.getAttribute(i);t.removeAttribute(i);const r=s.split(l);this.parts.push({type:"attribute",index:o,name:n,strings:r}),a+=r.length-1}}"TEMPLATE"===t.tagName&&(i.push(t),s.currentNode=t.content)}else if(3===t.nodeType){const e=t.data;if(e.indexOf(c)>=0){const i=t.parentNode,s=e.split(l),r=s.length-1;for(let e=0;e<r;e++){let n,r=s[e];if(""===r)n=p();else{const t=g.exec(r);null!==t&&d(t[2],"$lit$")&&(r=r.slice(0,t.index)+t[1]+t[2].slice(0,-"$lit$".length)+t[3]),n=document.createTextNode(r)}i.insertBefore(n,t),this.parts.push({type:"node",index:++o})}""===s[r]?(i.insertBefore(p(),t),n.push(t)):t.data=s[r],a+=r}}else if(8===t.nodeType)if(t.data===c){const e=t.parentNode;null!==t.previousSibling&&o!==r||(o++,e.insertBefore(p(),t)),r=o,this.parts.push({type:"node",index:o}),null===t.nextSibling?t.data="":(n.push(t),o--),a++}else{let e=-1;for(;-1!==(e=t.data.indexOf(c,e+1));)this.parts.push({type:"node",index:-1}),a++}}else s.currentNode=i.pop()}for(const c of n)c.parentNode.removeChild(c)}}const d=(t,e)=>{const n=t.length-e.length;return n>=0&&t.slice(n)===e},f=t=>-1!==t.index,p=()=>document.createComment(""),g=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function m(t,e){const{element:{content:n},parts:i}=t,s=document.createTreeWalker(n,133,null,!1);let r=v(i),o=i[r],a=-1,c=0;const h=[];let l=null;for(;s.nextNode();){a++;const t=s.currentNode;for(t.previousSibling===l&&(l=null),e.has(t)&&(h.push(t),null===l&&(l=t)),null!==l&&c++;void 0!==o&&o.index===a;)o.index=null!==l?-1:o.index-c,r=v(i,r),o=i[r]}h.forEach((t=>t.parentNode.removeChild(t)))}const y=t=>{let e=11===t.nodeType?0:1;const n=document.createTreeWalker(t,133,null,!1);for(;n.nextNode();)e++;return e},v=(t,e=-1)=>{for(let n=e+1;n<t.length;n++){const e=t[n];if(f(e))return n}return-1};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const b=new WeakMap,_=t=>(...e)=>{const n=t(...e);return b.set(n,!0),n},w=t=>"function"==typeof t&&b.has(t),x={},S={};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class E{constructor(t,e,n){this.__parts=[],this.template=t,this.processor=e,this.options=n}update(t){let e=0;for(const n of this.__parts)void 0!==n&&n.setValue(t[e]),e++;for(const n of this.__parts)void 0!==n&&n.commit()}_clone(){const t=o?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),e=[],n=this.template.parts,i=document.createTreeWalker(t,133,null,!1);let s,r=0,a=0,c=i.nextNode();for(;r<n.length;)if(s=n[r],f(s)){for(;a<s.index;)a++,"TEMPLATE"===c.nodeName&&(e.push(c),i.currentNode=c.content),null===(c=i.nextNode())&&(i.currentNode=e.pop(),c=i.nextNode());if("node"===s.type){const t=this.processor.handleTextExpression(this.options);t.insertAfterNode(c.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(c,s.name,s.strings,this.options));r++}else this.__parts.push(void 0),r++;return o&&(document.adoptNode(t),customElements.upgrade(t)),t}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const T=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:t=>t}),k=` ${c} `;class I{constructor(t,e,n,i){this.strings=t,this.values=e,this.type=n,this.processor=i}getHTML(){const t=this.strings.length-1;let e="",n=!1;for(let i=0;i<t;i++){const t=this.strings[i],s=t.lastIndexOf("\x3c!--");n=(s>-1||n)&&-1===t.indexOf("--\x3e",s+1);const r=g.exec(t);e+=null===r?t+(n?k:h):t.substr(0,r.index)+r[1]+r[2]+"$lit$"+r[3]+c}return e+=this.strings[t],e}getTemplateElement(){const t=document.createElement("template");let e=this.getHTML();return void 0!==T&&(e=T.createHTML(e)),t.innerHTML=e,t}}
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const C=t=>null===t||!("object"==typeof t||"function"==typeof t),A=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]);class M{constructor(t,e,n){this.dirty=!0,this.element=t,this.name=e,this.strings=n,this.parts=[];for(let i=0;i<n.length-1;i++)this.parts[i]=this._createPart()}_createPart(){return new D(this)}_getValue(){const t=this.strings,e=t.length-1,n=this.parts;if(1===e&&""===t[0]&&""===t[1]){const t=n[0].value;if("symbol"==typeof t)return String(t);if("string"==typeof t||!A(t))return t}let i="";for(let s=0;s<e;s++){i+=t[s];const e=n[s];if(void 0!==e){const t=e.value;if(C(t)||!A(t))i+="string"==typeof t?t:String(t);else for(const e of t)i+="string"==typeof e?e:String(e)}}return i+=t[e],i}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class D{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===x||C(t)&&t===this.value||(this.value=t,w(t)||(this.committer.dirty=!0))}commit(){for(;w(this.value);){const t=this.value;this.value=x,t(this)}this.value!==x&&this.committer.commit()}}class O{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(p()),this.endNode=t.appendChild(p())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=p()),t.__insert(this.endNode=p())}insertAfterPart(t){t.__insert(this.startNode=p()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){if(null===this.startNode.parentNode)return;for(;w(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=x,t(this)}const t=this.__pendingValue;t!==x&&(C(t)?t!==this.value&&this.__commitText(t):t instanceof I?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):A(t)?this.__commitIterable(t):t===S?(this.value=S,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const e=this.startNode.nextSibling,n="string"==typeof(t=null==t?"":t)?t:String(t);e===this.endNode.previousSibling&&3===e.nodeType?e.data=n:this.__commitNode(document.createTextNode(n)),this.value=t}__commitTemplateResult(t){const e=this.options.templateFactory(t);if(this.value instanceof E&&this.value.template===e)this.value.update(t.values);else{const n=new E(e,t.processor,this.options),i=n._clone();n.update(t.values),this.__commitNode(i),this.value=n}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const e=this.value;let n,i=0;for(const s of t)n=e[i],void 0===n&&(n=new O(this.options),e.push(n),0===i?n.appendIntoPart(this):n.insertAfterPart(e[i-1])),n.setValue(s),n.commit(),i++;i<e.length&&(e.length=i,this.clear(n&&n.endNode))}clear(t=this.startNode){a(this.startNode.parentNode,t.nextSibling,this.endNode)}}class P{constructor(t,e,n){if(this.value=void 0,this.__pendingValue=void 0,2!==n.length||""!==n[0]||""!==n[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=e,this.strings=n}setValue(t){this.__pendingValue=t}commit(){for(;w(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=x,t(this)}if(this.__pendingValue===x)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=x}}class R extends M{constructor(t,e,n){super(t,e,n),this.single=2===n.length&&""===n[0]&&""===n[1]}_createPart(){return new N(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class N extends D{}let L=!1;(()=>{try{const t={get capture(){return L=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})();class V{constructor(t,e,n){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=e,this.eventContext=n,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;w(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=x,t(this)}if(this.__pendingValue===x)return;const t=this.__pendingValue,e=this.value,n=null==t||null!=e&&(t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive),i=null!=t&&(null==e||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),i&&(this.__options=F(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=x}handleEvent(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const F=t=>t&&(L?{capture:t.capture,passive:t.passive,once:t.once}:t.capture)
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */;function U(t){let e=j.get(t.type);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},j.set(t.type,e));let n=e.stringsArray.get(t.strings);if(void 0!==n)return n;const i=t.strings.join(c);return n=e.keyString.get(i),void 0===n&&(n=new u(t,t.getTemplateElement()),e.keyString.set(i,n)),e.stringsArray.set(t.strings,n),n}const j=new Map,B=new WeakMap;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */const z=new
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
class{handleAttributeExpressions(t,e,n,i){const s=e[0];if("."===s){return new R(t,e.slice(1),n).parts}if("@"===s)return[new V(t,e.slice(1),i.eventContext)];if("?"===s)return[new P(t,e.slice(1),n)];return new M(t,e,n).parts}handleTextExpression(t){return new O(t)}};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");const H=(t,...e)=>new I(t,e,"html",z)
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */,W=(t,e)=>`${t}--${e}`;let $=!0;void 0===window.ShadyCSS?$=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),$=!1);const q=t=>e=>{const n=W(e.type,t);let i=j.get(n);void 0===i&&(i={stringsArray:new WeakMap,keyString:new Map},j.set(n,i));let s=i.stringsArray.get(e.strings);if(void 0!==s)return s;const r=e.strings.join(c);if(s=i.keyString.get(r),void 0===s){const n=e.getTemplateElement();$&&window.ShadyCSS.prepareTemplateDom(n,t),s=new u(e,n),i.keyString.set(r,s)}return i.stringsArray.set(e.strings,s),s},K=["html","svg"],G=new Set,Y=(t,e,n)=>{G.add(t);const i=n?n.element:document.createElement("template"),s=e.querySelectorAll("style"),{length:r}=s;if(0===r)return void window.ShadyCSS.prepareTemplateStyles(i,t);const o=document.createElement("style");for(let h=0;h<r;h++){const t=s[h];t.parentNode.removeChild(t),o.textContent+=t.textContent}(t=>{K.forEach((e=>{const n=j.get(W(e,t));void 0!==n&&n.keyString.forEach((t=>{const{element:{content:e}}=t,n=new Set;Array.from(e.querySelectorAll("style")).forEach((t=>{n.add(t)})),m(t,n)}))}))})(t);const a=i.content;n?function(t,e,n=null){const{element:{content:i},parts:s}=t;if(null==n)return void i.appendChild(e);const r=document.createTreeWalker(i,133,null,!1);let o=v(s),a=0,c=-1;for(;r.nextNode();)for(c++,r.currentNode===n&&(a=y(e),n.parentNode.insertBefore(e,n));-1!==o&&s[o].index===c;){if(a>0){for(;-1!==o;)s[o].index+=a,o=v(s,o);return}o=v(s,o)}}(n,o,a.firstChild):a.insertBefore(o,a.firstChild),window.ShadyCSS.prepareTemplateStyles(i,t);const c=a.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==c)e.insertBefore(c.cloneNode(!0),e.firstChild);else if(n){a.insertBefore(o,a.firstChild);const t=new Set;t.add(o),m(n,t)}};window.JSCompiler_renameProperty=(t,e)=>t;const X={toAttribute(t,e){switch(e){case Boolean:return t?"":null;case Object:case Array:return null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){switch(e){case Boolean:return null!==t;case Number:return null===t?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},Q=(t,e)=>e!==t&&(e==e||t==t),J={attribute:!0,type:String,converter:X,reflect:!1,hasChanged:Q};class Z extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const t=[];return this._classProperties.forEach(((e,n)=>{const i=this._attributeNameForProperty(n,e);void 0!==i&&(this._attributeToPropertyMap.set(i,n),t.push(i))})),t}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach(((t,e)=>this._classProperties.set(e,t)))}}static createProperty(t,e=J){if(this._ensureClassProperties(),this._classProperties.set(t,e),e.noAccessor||this.prototype.hasOwnProperty(t))return;const n="symbol"==typeof t?Symbol():`__${t}`,i=this.getPropertyDescriptor(t,n,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}static getPropertyDescriptor(t,e,n){return{get(){return this[e]},set(i){const s=this[t];this[e]=i,this.requestUpdateInternal(t,s,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this._classProperties&&this._classProperties.get(t)||J}static finalize(){const t=Object.getPrototypeOf(this);if(t.hasOwnProperty("finalized")||t.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const t=this.properties,e=[...Object.getOwnPropertyNames(t),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[]];for(const n of e)this.createProperty(n,t[n])}}static _attributeNameForProperty(t,e){const n=e.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof t?t.toLowerCase():void 0}static _valueHasChanged(t,e,n=Q){return n(t,e)}static _propertyValueFromAttribute(t,e){const n=e.type,i=e.converter||X,s="function"==typeof i?i:i.fromAttribute;return s?s(t,n):t}static _propertyValueToAttribute(t,e){if(void 0===e.reflect)return;const n=e.type,i=e.converter;return(i&&i.toAttribute||X.toAttribute)(t,n)}initialize(){this._updateState=0,this._updatePromise=new Promise((t=>this._enableUpdatingResolver=t)),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach(((t,e)=>{if(this.hasOwnProperty(e)){const t=this[e];delete this[e],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(e,t)}}))}_applyInstanceProperties(){this._instanceProperties.forEach(((t,e)=>this[e]=t)),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(t,e,n){e!==n&&this._attributeToProperty(t,n)}_propertyToAttribute(t,e,n=J){const i=this.constructor,s=i._attributeNameForProperty(t,n);if(void 0!==s){const t=i._propertyValueToAttribute(e,n);if(void 0===t)return;this._updateState=8|this._updateState,null==t?this.removeAttribute(s):this.setAttribute(s,t),this._updateState=-9&this._updateState}}_attributeToProperty(t,e){if(8&this._updateState)return;const n=this.constructor,i=n._attributeToPropertyMap.get(t);if(void 0!==i){const t=n.getPropertyOptions(i);this._updateState=16|this._updateState,this[i]=n._propertyValueFromAttribute(e,t),this._updateState=-17&this._updateState}}requestUpdateInternal(t,e,n){let i=!0;if(void 0!==t){const s=this.constructor;n=n||s.getPropertyOptions(t),s._valueHasChanged(this[t],e,n.hasChanged)?(this._changedProperties.has(t)||this._changedProperties.set(t,e),!0!==n.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(t,n))):i=!1}!this._hasRequestedUpdate&&i&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(t,e){return this.requestUpdateInternal(t,e),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(e){}const t=this.performUpdate();return null!=t&&await t,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let t=!1;const e=this._changedProperties;try{t=this.shouldUpdate(e),t?this.update(e):this._markUpdated()}catch(n){throw t=!1,this._markUpdated(),n}t&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(e)),this.updated(e))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._updatePromise}shouldUpdate(t){return!0}update(t){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach(((t,e)=>this._propertyToAttribute(e,this[e],t))),this._reflectingProperties=void 0),this._markUpdated()}updated(t){}firstUpdated(t){}}Z.finalized=!0;
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const tt=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?Object.assign(Object.assign({},e),{finisher(n){n.createProperty(e.key,t)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(n){n.createProperty(e.key,t)}};function et(t){return function(t){return(e,n)=>void 0!==n?((t,e,n)=>{e.constructor.createProperty(n,t)})(t,e,n):tt(t,e)}({attribute:!1,hasChanged:null==t?void 0:t.hasChanged})}const nt=t=>et(t);function it(t,e){return(n,i)=>{const s={get(){return this.renderRoot.querySelector(t)},enumerable:!0,configurable:!0};if(e){const e=void 0!==i?i:n.key,r="symbol"==typeof e?Symbol():`__${e}`;s.get=function(){return void 0===this[r]&&(this[r]=this.renderRoot.querySelector(t)),this[r]}}return void 0!==i?st(s,n,i):rt(s,n)}}const st=(t,e,n)=>{Object.defineProperty(e,n,t)},rt=(t,e)=>({kind:"method",placement:"prototype",key:e.key,descriptor:t})
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/,ot=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,at=Symbol();class ct{constructor(t,e){if(e!==at)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){return void 0===this._styleSheet&&(ot?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const ht=t=>new ct(String(t),at),lt=(t,...e)=>{const n=e.reduce(((e,n,i)=>e+(t=>{if(t instanceof ct)return t.cssText;if("number"==typeof t)return t;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${t}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(n)+t[i+1]),t[0]);return new ct(n,at)};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
(window.litElementVersions||(window.litElementVersions=[])).push("2.5.1");const ut={};class dt extends Z{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const t=this.getStyles();if(Array.isArray(t)){const e=(t,n)=>t.reduceRight(((t,n)=>Array.isArray(n)?e(n,t):(t.add(n),t)),n),n=e(t,new Set),i=[];n.forEach((t=>i.unshift(t))),this._styles=i}else this._styles=void 0===t?[]:[t];this._styles=this._styles.map((t=>{if(t instanceof CSSStyleSheet&&!ot){const e=Array.prototype.slice.call(t.cssRules).reduce(((t,e)=>t+e.cssText),"");return ht(e)}return t}))}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow(this.constructor.shadowRootOptions)}adoptStyles(){const t=this.constructor._styles;0!==t.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?ot?this.renderRoot.adoptedStyleSheets=t.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(t.map((t=>t.cssText)),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(t){const e=this.render();super.update(t),e!==ut&&this.constructor.render(e,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach((t=>{const e=document.createElement("style");e.textContent=t.cssText,this.renderRoot.appendChild(e)})))}render(){return ut}}dt.finalized=!0,dt.render=(t,e,n)=>{if(!n||"object"!=typeof n||!n.scopeName)throw new Error("The `scopeName` option is required.");const i=n.scopeName,s=B.has(e),r=$&&11===e.nodeType&&!!e.host,o=r&&!G.has(i),c=o?document.createDocumentFragment():e;if(((t,e,n)=>{let i=B.get(e);void 0===i&&(a(e,e.firstChild),B.set(e,i=new O(Object.assign({templateFactory:U},n))),i.appendInto(e)),i.setValue(t),i.commit()})(t,c,Object.assign({templateFactory:q(i)},n)),o){const t=B.get(c);B.delete(c);const n=t.value instanceof E?t.value.template:void 0;Y(i,c,n),a(e,e.firstChild),e.appendChild(c),B.set(e,t)}!s&&r&&window.ShadyCSS.styleElement(e.host)},dt.shadowRootOptions={mode:"open"};var ft=function(t,e){return(ft=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function pt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}ft(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function gt(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]])}return n}function mt(t,e,n,i){return new(n||(n=Promise))((function(s,r){function o(t){try{c(i.next(t))}catch(e){r(e)}}function a(t){try{c(i.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}function yt(t,e){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(a){r=[6,a],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}function vt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function bt(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,s,r=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function _t(t,e,n){if(n||2===arguments.length)for(var i,s=0,r=e.length;s<r;s++)!i&&s in e||(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}function wt(t){return this instanceof wt?(this.v=t,this):new wt(t)}function xt(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,s=n.apply(t,e||[]),r=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(t){s[t]&&(i[t]=function(e){return new Promise((function(n,i){r.push([t,e,n,i])>1||a(t,e)}))})}function a(t,e){try{(n=s[t](e)).value instanceof wt?Promise.resolve(n.value.v).then(c,h):l(r[0][2],n)}catch(i){l(r[0][3],i)}var n}function c(t){a("next",t)}function h(t){a("throw",t)}function l(t,e){t(e),r.shift(),r.length&&a(r[0][0],r[0][1])}}function St(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=vt(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){return new Promise((function(i,s){(function(t,e,n,i){Promise.resolve(i).then((function(e){t({value:e,done:n})}),e)})(i,s,(e=t[n](e)).done,e.value)}))}}}function Et(t){return"function"==typeof t}function Tt(t){var e=t((function(t){Error.call(t),t.stack=(new Error).stack}));return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var kt=Tt((function(t){return function(e){t(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}}));function It(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Ct=function(){function t(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}var e;return t.prototype.unsubscribe=function(){var t,e,n,i,s;if(!this.closed){this.closed=!0;var r=this._parentage;if(r)if(this._parentage=null,Array.isArray(r))try{for(var o=vt(r),a=o.next();!a.done;a=o.next()){a.value.remove(this)}}catch(f){t={error:f}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}else r.remove(this);var c=this.initialTeardown;if(Et(c))try{c()}catch(p){s=p instanceof kt?p.errors:[p]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var l=vt(h),u=l.next();!u.done;u=l.next()){var d=u.value;try{Dt(d)}catch(g){s=null!=s?s:[],g instanceof kt?s=_t(_t([],bt(s)),bt(g.errors)):s.push(g)}}}catch(m){n={error:m}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}if(s)throw new kt(s)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)Dt(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}},t.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},t.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},t.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&It(e,t)},t.prototype.remove=function(e){var n=this._finalizers;n&&It(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}(),At=Ct.EMPTY;function Mt(t){return t instanceof Ct||t&&"closed"in t&&Et(t.remove)&&Et(t.add)&&Et(t.unsubscribe)}function Dt(t){Et(t)?t():t.unsubscribe()}var Ot=null,Pt=void 0,Rt=!1,Nt=!1,Lt={setTimeout:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var s=Lt.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,_t([t,e],bt(n))):setTimeout.apply(void 0,_t([t,e],bt(n)))},clearTimeout:function(t){var e=Lt.delegate;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function Vt(t){Lt.setTimeout((function(){if(!Ot)throw t;Ot(t)}))}function Ft(){}var Ut=null;function jt(t){if(Rt){var e=!Ut;if(e&&(Ut={errorThrown:!1,error:null}),t(),e){var n=Ut,i=n.errorThrown,s=n.error;if(Ut=null,i)throw s}}else t()}var Bt=function(t){function e(e){var n=t.call(this)||this;return n.isStopped=!1,e?(n.destination=e,Mt(e)&&e.add(n)):n.destination=Kt,n}return pt(e,t),e.create=function(t,e,n){return new $t(t,e,n)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(Ct),zt=Function.prototype.bind;function Ht(t,e){return zt.call(t,e)}var Wt=function(){function t(t){this.partialObserver=t}return t.prototype.next=function(t){var e=this.partialObserver;if(e.next)try{e.next(t)}catch(n){qt(n)}},t.prototype.error=function(t){var e=this.partialObserver;if(e.error)try{e.error(t)}catch(n){qt(n)}else qt(t)},t.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(e){qt(e)}},t}(),$t=function(t){function e(e,n,i){var s,r,o=t.call(this)||this;Et(e)||!e?s={next:null!=e?e:void 0,error:null!=n?n:void 0,complete:null!=i?i:void 0}:o&&Nt?((r=Object.create(e)).unsubscribe=function(){return o.unsubscribe()},s={next:e.next&&Ht(e.next,r),error:e.error&&Ht(e.error,r),complete:e.complete&&Ht(e.complete,r)}):s=e;return o.destination=new Wt(s),o}return pt(e,t),e}(Bt);function qt(t){Vt(t)}var Kt={closed:!0,next:Ft,error:function(t){throw t},complete:Ft},Gt="function"==typeof Symbol&&Symbol.observable||"@@observable";function Yt(t){return t}function Xt(t){return 0===t.length?Yt:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var Qt=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var i,s=this,r=(i=t)&&i instanceof Bt||function(t){return t&&Et(t.next)&&Et(t.error)&&Et(t.complete)}(i)&&Mt(i)?t:new $t(t,e,n);return jt((function(){var t=s,e=t.operator,n=t.source;r.add(e?e.call(r,n):n?s._subscribe(r):s._trySubscribe(r))})),r},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=Jt(e))((function(e,i){var s=new $t({next:function(e){try{t(e)}catch(n){i(n),s.unsubscribe()}},error:i,complete:e});n.subscribe(s)}))},t.prototype._subscribe=function(t){var e;return null===(e=this.source)||void 0===e?void 0:e.subscribe(t)},t.prototype[Gt]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xt(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=Jt(t))((function(t,n){var i;e.subscribe((function(t){return i=t}),(function(t){return n(t)}),(function(){return t(i)}))}))},t.create=function(e){return new t(e)},t}();function Jt(t){var e;return null!==(e=null!=t?t:Pt)&&void 0!==e?e:Promise}function Zt(t){return function(e){if(function(t){return Et(null==t?void 0:t.lift)}(e))return e.lift((function(e){try{return t(e,this)}catch(n){this.error(n)}}));throw new TypeError("Unable to lift unknown Observable type")}}function te(t,e,n,i,s){return new ee(t,e,n,i,s)}var ee=function(t){function e(e,n,i,s,r,o){var a=t.call(this,e)||this;return a.onFinalize=r,a.shouldUnsubscribe=o,a._next=n?function(t){try{n(t)}catch(i){e.error(i)}}:t.prototype._next,a._error=s?function(t){try{s(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:t.prototype._error,a._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._complete,a}return pt(e,t),e.prototype.unsubscribe=function(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;t.prototype.unsubscribe.call(this),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}},e}(Bt),ne=Tt((function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),ie=function(t){function e(){var e=t.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return pt(e,t),e.prototype.lift=function(t){var e=new se(this,this);return e.operator=t,e},e.prototype._throwIfClosed=function(){if(this.closed)throw new ne},e.prototype.next=function(t){var e=this;jt((function(){var n,i;if(e._throwIfClosed(),!e.isStopped){e.currentObservers||(e.currentObservers=Array.from(e.observers));try{for(var s=vt(e.currentObservers),r=s.next();!r.done;r=s.next()){r.value.next(t)}}catch(o){n={error:o}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}}))},e.prototype.error=function(t){var e=this;jt((function(){if(e._throwIfClosed(),!e.isStopped){e.hasError=e.isStopped=!0,e.thrownError=t;for(var n=e.observers;n.length;)n.shift().error(t)}}))},e.prototype.complete=function(){var t=this;jt((function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var e=t.observers;e.length;)e.shift().complete()}}))},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(e){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var e=this,n=this,i=n.hasError,s=n.isStopped,r=n.observers;return i||s?At:(this.currentObservers=null,r.push(t),new Ct((function(){e.currentObservers=null,It(r,t)})))},e.prototype._checkFinalizedStatuses=function(t){var e=this,n=e.hasError,i=e.thrownError,s=e.isStopped;n?t.error(i):s&&t.complete()},e.prototype.asObservable=function(){var t=new Qt;return t.source=this,t},e.create=function(t,e){return new se(t,e)},e}(Qt),se=function(t){function e(e,n){var i=t.call(this)||this;return i.destination=e,i.source=n,i}return pt(e,t),e.prototype.next=function(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===n||n.call(e,t)},e.prototype.error=function(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===n||n.call(e,t)},e.prototype.complete=function(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)},e.prototype._subscribe=function(t){var e,n;return null!==(n=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==n?n:At},e}(ie),re=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function oe(t){return Et(null==t?void 0:t.then)}function ae(t){return Et(t[Gt])}function ce(t){return Symbol.asyncIterator&&Et(null==t?void 0:t[Symbol.asyncIterator])}function he(t){return new TypeError("You provided "+(null!==t&&"object"==typeof t?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var le,ue,de="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function fe(t){return Et(null==t?void 0:t[de])}function pe(t){return xt(this,arguments,(function(){var e,n,i;return yt(this,(function(s){switch(s.label){case 0:e=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,wt(e.read())];case 3:return n=s.sent(),i=n.value,n.done?[4,wt(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,wt(i)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}}))}))}function ge(t){return Et(null==t?void 0:t.getReader)}function me(t){if(t instanceof Qt)return t;if(null!=t){if(ae(t))return s=t,new Qt((function(t){var e=s[Gt]();if(Et(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(re(t))return i=t,new Qt((function(t){for(var e=0;e<i.length&&!t.closed;e++)t.next(i[e]);t.complete()}));if(oe(t))return n=t,new Qt((function(t){n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,Vt)}));if(ce(t))return ye(t);if(fe(t))return e=t,new Qt((function(t){var n,i;try{for(var s=vt(e),r=s.next();!r.done;r=s.next()){var o=r.value;if(t.next(o),t.closed)return}}catch(a){n={error:a}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}t.complete()}));if(ge(t))return ye(pe(t))}var e,n,i,s;throw he(t)}function ye(t){return new Qt((function(e){(function(t,e){var n,i,s,r;return mt(this,void 0,void 0,(function(){var o,a;return yt(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=St(t),c.label=1;case 1:return[4,n.next()];case 2:if((i=c.sent()).done)return[3,4];if(o=i.value,e.next(o),e.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),s={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),i&&!i.done&&(r=n.return)?[4,r.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}}))}))})(t,e).catch((function(t){return e.error(t)}))}))}function ve(t,e,n,i,s){void 0===i&&(i=0),void 0===s&&(s=!1);var r=e.schedule((function(){n(),s?t.add(this.schedule(null,i)):this.unsubscribe()}),i);if(t.add(r),!s)return r}function be(t,e){return void 0===e&&(e=0),Zt((function(n,i){n.subscribe(te(i,(function(n){return ve(i,t,(function(){return i.next(n)}),e)}),(function(){return ve(i,t,(function(){return i.complete()}),e)}),(function(n){return ve(i,t,(function(){return i.error(n)}),e)})))}))}function _e(t,e){return void 0===e&&(e=0),Zt((function(n,i){i.add(t.schedule((function(){return n.subscribe(i)}),e))}))}function we(t,e){if(!t)throw new Error("Iterable cannot be null");return new Qt((function(n){ve(n,e,(function(){var i=t[Symbol.asyncIterator]();ve(n,e,(function(){i.next().then((function(t){t.done?n.complete():n.next(t.value)}))}),0,!0)}))}))}function xe(t,e){if(null!=t){if(ae(t))return function(t,e){return me(t).pipe(_e(e),be(e))}(t,e);if(re(t))return function(t,e){return new Qt((function(n){var i=0;return e.schedule((function(){i===t.length?n.complete():(n.next(t[i++]),n.closed||this.schedule())}))}))}(t,e);if(oe(t))return function(t,e){return me(t).pipe(_e(e),be(e))}(t,e);if(ce(t))return we(t,e);if(fe(t))return function(t,e){return new Qt((function(n){var i;return ve(n,e,(function(){i=t[de](),ve(n,e,(function(){var t,e,s;try{e=(t=i.next()).value,s=t.done}catch(r){return void n.error(r)}s?n.complete():n.next(e)}),0,!0)})),function(){return Et(null==i?void 0:i.return)&&i.return()}}))}(t,e);if(ge(t))return function(t,e){return we(pe(t),e)}(t,e)}throw he(t)}function Se(t,e){return e?xe(t,e):me(t)}function Ee(t,e){return Zt((function(n,i){var s=0;n.subscribe(te(i,(function(n){i.next(t.call(e,n,s++))})))}))}const Te=Symbol("unsubscribe"),ke=Symbol("subscriptions");class Ie extends dt{constructor(){super(...arguments),this[le]=new ie,this[ue]=new Map}subscribe(t,e){var n,i;if(!(i=e)||!(i instanceof Qt||Et(i.lift)&&Et(i.subscribe)))throw new Error("Invalid Observable!");const s=this[ke].get(t);if(s){if((null==s?void 0:s.stream$)===e)return;null===(n=null==s?void 0:s.subscription)||void 0===n||n.unsubscribe()}const r=e.pipe((o=this[Te],Zt((function(t,e){me(o).subscribe(te(e,(function(){return e.complete()}),Ft)),!e.closed&&t.subscribe(e)})))).subscribe((e=>{this[t]=e,this.requestUpdate()}));var o;this[ke].set(t,{stream$:e,subscription:r})}disconnectedCallback(){this[Te].next(),super.disconnectedCallback()}}le=Te,ue=ke;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var Ce=function(){return(Ce=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function Ae(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]])}return n}function Me(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function De(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,s,r=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function Oe(t,e,n){if(n||2===arguments.length)for(var i,s=0,r=e.length;s<r;s++)!i&&s in e||(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}var Pe={};function Re(t){return Object.keys(t)}function Ne(t,e,n){void 0===n&&(n=".");var i=Fe(t,n),s=Fe(e,n);return tn(s)?!!tn(i)&&s===i:tn(i)?i in s:Re(i).every((function(t){return t in s&&Ne(i[t],s[t])}))}function Le(t){try{return tn(t)||"number"==typeof t?"".concat(t):t.type}catch(e){throw new Error("Events must be strings or objects with a string event.type property.")}}function Ve(t,e){try{return Je(t)?t:t.toString().split(e)}catch(n){throw new Error("'".concat(t,"' is not a valid state path."))}}function Fe(t,e){return"object"==typeof(n=t)&&"value"in n&&"context"in n&&"event"in n&&"_event"in n?t.value:Je(t)?Ue(t):"string"!=typeof t?t:Ue(Ve(t,e));var n}function Ue(t){if(1===t.length)return t[0];for(var e={},n=e,i=0;i<t.length-1;i++)i===t.length-2?n[t[i]]=t[i+1]:(n[t[i]]={},n=n[t[i]]);return e}function je(t,e){for(var n={},i=Re(t),s=0;s<i.length;s++){var r=i[s];n[r]=e(t[r],r,t,s)}return n}function Be(t,e,n){var i,s,r={};try{for(var o=Me(Re(t)),a=o.next();!a.done;a=o.next()){var c=a.value,h=t[c];n(h)&&(r[c]=e(h,c,t))}}catch(l){i={error:l}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}return r}var ze=function(t){return function(e){var n,i,s=e;try{for(var r=Me(t),o=r.next();!o.done;o=r.next()){s=s[o.value]}}catch(a){n={error:a}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return s}};function He(t){return t?tn(t)?[[t]]:We(Re(t).map((function(e){var n=t[e];return"string"==typeof n||n&&Object.keys(n).length?He(t[e]).map((function(t){return[e].concat(t)})):[[e]]}))):[[]]}function We(t){var e;return(e=[]).concat.apply(e,Oe([],De(t),!1))}function $e(t){return Je(t)?t:[t]}function qe(t){return void 0===t?[]:$e(t)}function Ke(t,e,n){var i,s;if(Ze(t))return t(e,n.data);var r={};try{for(var o=Me(Object.keys(t)),a=o.next();!a.done;a=o.next()){var c=a.value,h=t[c];Ze(h)?r[c]=h(e,n.data):r[c]=h}}catch(l){i={error:l}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}return r}function Ge(t){return t instanceof Promise||!(null===t||!Ze(t)&&"object"!=typeof t||!Ze(t.then))}function Ye(t,e){var n,i,s=De([[],[]],2),r=s[0],o=s[1];try{for(var a=Me(t),c=a.next();!c.done;c=a.next()){var h=c.value;e(h)?r.push(h):o.push(h)}}catch(l){n={error:l}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return[r,o]}function Xe(t,e){return je(t.states,(function(t,n){if(t){var i=(tn(e)?void 0:e[n])||(t?t.current:void 0);if(i)return{current:i,states:Xe(t,i)}}}))}function Qe(t,e,n,i){return t?n.reduce((function(t,n){var s,r,o=n.assignment,a={state:i,action:n,_event:e},c={};if(Ze(o))c=o(t,e.data,a);else try{for(var h=Me(Re(o)),l=h.next();!l.done;l=h.next()){var u=l.value,d=o[u];c[u]=Ze(d)?d(t,e.data,a):d}}catch(f){s={error:f}}finally{try{l&&!l.done&&(r=h.return)&&r.call(h)}finally{if(s)throw s.error}}return Object.assign({},t,c)}),t):t}function Je(t){return Array.isArray(t)}function Ze(t){return"function"==typeof t}function tn(t){return"string"==typeof t}function en(t,e){if(t)return tn(t)?{type:"xstate.guard",name:t,predicate:e?e[t]:void 0}:Ze(t)?{type:"xstate.guard",name:t.name,predicate:t}:t}var nn,sn,rn,on,an=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function cn(t){try{return"__xstatenode"in t}catch(e){return!1}}function hn(t,e){return tn(t)||"number"==typeof t?Ce({type:t},e):t}function ln(t,e){if(!tn(t)&&"$$type"in t&&"scxml"===t.$$type)return t;var n=hn(t);return Ce({name:n.type,data:n,$$type:"scxml",type:"external"},e)}function un(t,e){return $e(e).map((function(e){return void 0===e||"string"==typeof e||cn(e)?{target:e,event:t}:Ce(Ce({},e),{event:t})}))}function dn(t,e,n,i,s){var r=t.options.guards,o={state:s,cond:e,_event:i};if("xstate.guard"===e.type)return((null==r?void 0:r[e.name])||e.predicate)(n,i.data,o);var a=r[e.type];if(!a)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return a(n,i.data,o)}function fn(t){return"string"==typeof t?{type:t}:t}function pn(t,e,n){if("object"==typeof t)return t;var i=function(){};return{next:t,error:e||i,complete:n||i}}(sn=nn||(nn={})).Start="xstate.start",sn.Stop="xstate.stop",sn.Raise="xstate.raise",sn.Send="xstate.send",sn.Cancel="xstate.cancel",sn.NullEvent="",sn.Assign="xstate.assign",sn.After="xstate.after",sn.DoneState="done.state",sn.DoneInvoke="done.invoke",sn.Log="xstate.log",sn.Init="xstate.init",sn.Invoke="xstate.invoke",sn.ErrorExecution="error.execution",sn.ErrorCommunication="error.communication",sn.ErrorPlatform="error.platform",sn.ErrorCustom="xstate.error",sn.Update="xstate.update",sn.Pure="xstate.pure",sn.Choose="xstate.choose",(on=rn||(rn={})).Parent="#_parent",on.Internal="#_internal";var gn=nn.Start,mn=nn.Stop,yn=nn.Raise,vn=nn.Send,bn=nn.Cancel,_n=nn.NullEvent,wn=nn.Assign;nn.After,nn.DoneState;var xn=nn.Log,Sn=nn.Init,En=nn.Invoke;nn.ErrorExecution;var Tn=nn.ErrorPlatform,kn=nn.ErrorCustom,In=nn.Update,Cn=nn.Choose,An=nn.Pure,Mn=ln({type:Sn});function Dn(t,e){return e&&e[t]||void 0}function On(t,e){var n;if(tn(t)||"number"==typeof t)n=Ze(i=Dn(t,e))?{type:t,exec:i}:i||{type:t,exec:void 0};else if(Ze(t))n={type:t.name||t.toString(),exec:t};else{var i;if(Ze(i=Dn(t.type,e)))n=Ce(Ce({},t),{exec:i});else if(i){var s=i.type||t.type;n=Ce(Ce(Ce({},i),t),{type:s})}else n=t}return n}var Pn=function(t,e){return t?(Je(t)?t:[t]).map((function(t){return On(t,e)})):[]};function Rn(t){var e=On(t);return Ce(Ce({id:tn(t)?t:e.id},e),{type:e.type})}function Nn(t){return tn(t)?{type:yn,event:t}:Ln(t,{to:rn.Internal})}function Ln(t,e){return{to:e?e.to:void 0,type:vn,event:Ze(t)?t:hn(t),delay:e?e.delay:void 0,id:e&&void 0!==e.id?e.id:Ze(t)?t.name:Le(t)}}function Vn(t,e){var n="".concat(nn.DoneState,".").concat(t),i={type:n,data:e,toString:function(){return n}};return i}function Fn(t,e){var n="".concat(nn.DoneInvoke,".").concat(t),i={type:n,data:e,toString:function(){return n}};return i}function Un(t,e){var n="".concat(nn.ErrorPlatform,".").concat(t),i={type:n,data:e,toString:function(){return n}};return i}function jn(t,e,n,i,s,r){void 0===r&&(r=!1);var o=De(r?[[],s]:Ye(s,(function(t){return t.type===wn})),2),a=o[0],c=o[1],h=a.length?Qe(n,i,a,e):n,l=r?[n]:void 0;return[We(c.map((function(n){var s;switch(n.type){case yn:return{type:yn,_event:ln(n.event)};case vn:return function(t,e,n,i){var s,r={_event:n},o=ln(Ze(t.event)?t.event(e,n.data,r):t.event);if(tn(t.delay)){var a=i&&i[t.delay];s=Ze(a)?a(e,n.data,r):a}else s=Ze(t.delay)?t.delay(e,n.data,r):t.delay;var c=Ze(t.to)?t.to(e,n.data,r):t.to;return Ce(Ce({},t),{to:c,_event:o,event:o.data,delay:s})}(n,h,i,t.options.delays);case xn:return function(t,e,n){return Ce(Ce({},t),{value:tn(t.expr)?t.expr:t.expr(e,n.data,{_event:n})})}(n,h,i);case Cn:if(!(u=null===(s=n.conds.find((function(n){var s=en(n.cond,t.options.guards);return!s||dn(t,s,h,i,e)})))||void 0===s?void 0:s.actions))return[];var o=De(jn(t,e,h,i,Pn(qe(u),t.options.actions),r),2),a=o[0],c=o[1];return h=c,null==l||l.push(h),a;case An:var u;if(!(u=n.get(h,i.data)))return[];var d=De(jn(t,e,h,i,Pn(qe(u),t.options.actions),r),2),f=d[0],p=d[1];return h=p,null==l||l.push(h),f;case mn:return function(t,e,n){var i=Ze(t.activity)?t.activity(e,n.data):t.activity,s="string"==typeof i?{id:i}:i;return{type:nn.Stop,activity:s}}(n,h,i);case wn:h=Qe(h,i,[n],e),null==l||l.push(h);break;default:var g=On(n,t.options.actions),m=g.exec;if(m&&l){var y=l.length-1;g=Ce(Ce({},g),{exec:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];m.apply(void 0,Oe([l[y]],De(e),!1))}})}return g}})).filter((function(t){return!!t}))),h]}var Bn=function(t){return"atomic"===t.type||"final"===t.type};function zn(t){return Re(t.states).map((function(e){return t.states[e]}))}function Hn(t){var e=[t];return Bn(t)?e:e.concat(We(zn(t).map(Hn)))}function Wn(t,e){var n,i,s,r,o,a,c,h,l=qn(new Set(t)),u=new Set(e);try{for(var d=Me(u),f=d.next();!f.done;f=d.next())for(var p=(S=f.value).parent;p&&!u.has(p);)u.add(p),p=p.parent}catch(E){n={error:E}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}var g=qn(u);try{for(var m=Me(u),y=m.next();!y.done;y=m.next()){if("compound"!==(S=y.value).type||g.get(S)&&g.get(S).length){if("parallel"===S.type)try{for(var v=(o=void 0,Me(zn(S))),b=v.next();!b.done;b=v.next()){var _=b.value;"history"!==_.type&&(u.has(_)||(u.add(_),l.get(_)?l.get(_).forEach((function(t){return u.add(t)})):_.initialStateNodes.forEach((function(t){return u.add(t)}))))}}catch(T){o={error:T}}finally{try{b&&!b.done&&(a=v.return)&&a.call(v)}finally{if(o)throw o.error}}}else l.get(S)?l.get(S).forEach((function(t){return u.add(t)})):S.initialStateNodes.forEach((function(t){return u.add(t)}))}}catch(k){s={error:k}}finally{try{y&&!y.done&&(r=m.return)&&r.call(m)}finally{if(s)throw s.error}}try{for(var w=Me(u),x=w.next();!x.done;x=w.next()){var S;for(p=(S=x.value).parent;p&&!u.has(p);)u.add(p),p=p.parent}}catch(I){c={error:I}}finally{try{x&&!x.done&&(h=w.return)&&h.call(w)}finally{if(c)throw c.error}}return u}function $n(t,e){var n=e.get(t);if(!n)return{};if("compound"===t.type){var i=n[0];if(!i)return{};if(Bn(i))return i.key}var s={};return n.forEach((function(t){s[t.key]=$n(t,e)})),s}function qn(t){var e,n,i=new Map;try{for(var s=Me(t),r=s.next();!r.done;r=s.next()){var o=r.value;i.has(o)||i.set(o,[]),o.parent&&(i.has(o.parent)||i.set(o.parent,[]),i.get(o.parent).push(o))}}catch(a){e={error:a}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return i}function Kn(t,e){return $n(t,qn(Wn([t],e)))}function Gn(t,e){return Array.isArray(t)?t.some((function(t){return t===e})):t instanceof Set&&t.has(e)}function Yn(t,e){return"compound"===e.type?zn(e).some((function(e){return"final"===e.type&&Gn(t,e)})):"parallel"===e.type&&zn(e).every((function(e){return Yn(t,e)}))}function Xn(t){return new Set(We(t.map((function(t){return t.tags}))))}function Qn(t,e){if(t===e)return!0;if(void 0===t||void 0===e)return!1;if(tn(t)||tn(e))return t===e;var n=Re(t),i=Re(e);return n.length===i.length&&n.every((function(n){return Qn(t[n],e[n])}))}var Jn=function(){function t(t){var e,n,i=this;this.actions=[],this.activities=Pe,this.meta={},this.events=[],this.value=t.value,this.context=t.context,this._event=t._event,this._sessionid=t._sessionid,this.event=this._event.data,this.historyValue=t.historyValue,this.history=t.history,this.actions=t.actions||[],this.activities=t.activities||Pe,this.meta=(void 0===(n=t.configuration)&&(n=[]),n.reduce((function(t,e){return void 0!==e.meta&&(t[e.id]=e.meta),t}),{})),this.events=t.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=t.configuration,this.transitions=t.transitions,this.children=t.children,this.done=!!t.done,this.tags=null!==(e=Array.isArray(t.tags)?new Set(t.tags):t.tags)&&void 0!==e?e:new Set,this.machine=t.machine,Object.defineProperty(this,"nextEvents",{get:function(){return function(t){return Oe([],De(new Set(We(Oe([],De(t.map((function(t){return t.ownEvents}))),!1)))),!1)}(i.configuration)}})}return t.from=function(e,n){return e instanceof t?e.context!==n?new t({value:e.value,context:n,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e:new t({value:e,context:n,_event:Mn,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,n){if(e instanceof t){if(!e.actions.length)return e;var i=Mn;return new t({value:e.value,context:n,_event:i,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,n)},t.prototype.toStrings=function(t,e){var n=this;if(void 0===t&&(t=this.value),void 0===e&&(e="."),tn(t))return[t];var i=Re(t);return i.concat.apply(i,Oe([],De(i.map((function(i){return n.toStrings(t[i],e).map((function(t){return i+e+t}))}))),!1))},t.prototype.toJSON=function(){var t=this;t.configuration,t.transitions;var e=t.tags;t.machine;var n=Ae(t,["configuration","transitions","tags","machine"]);return Ce(Ce({},n),{tags:Array.from(e)})},t.prototype.matches=function(t){return Ne(t,this.value)},t.prototype.hasTag=function(t){return this.tags.has(t)},t.prototype.can=function(t){var e;this.machine;var n=null===(e=this.machine)||void 0===e?void 0:e.getTransitionData(this,t);return!!(null==n?void 0:n.transitions.length)&&n.transitions.some((function(t){return void 0!==t.target||t.actions.length}))},t}(),Zn=function(t,e){return e(t)};function ti(t){return{id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}}}function ei(t,e,n,i){var s,r=fn(t.src),o=null===(s=null==e?void 0:e.options.services)||void 0===s?void 0:s[r.type],a=t.data?Ke(t.data,n,i):void 0,c=o?function(t,e,n){var i=ti(e);if(i.deferred=!0,cn(t)){var s=i.state=Zn(void 0,(function(){return(n?t.withContext(n):t).initialState}));i.getSnapshot=function(){return s}}return i}(o,t.id,a):ti(t.id);return c.meta=t,c}function ni(t){if("string"==typeof t){var e={type:t,toString:function(){return t}};return e}return t}function ii(t){return Ce(Ce({type:En},t),{toJSON:function(){t.onDone,t.onError;var e=Ae(t,["onDone","onError"]);return Ce(Ce({},e),{type:En,src:ni(t.src)})}})}var si={},ri=function(t){return"#"===t[0]},oi=function(){function t(e,n,i){var s,r=this;void 0===i&&(i="context"in e?e.context:void 0),this.config=e,this._context=i,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},n),this.parent=this.options._parent,this.key=this.config.key||this.options._key||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||Oe([this.machine.key],De(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Re(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(s=this.config.schema)&&void 0!==s?s:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?je(this.config.states,(function(e,n){var i,s=new t(e,{_parent:r,_key:n});return Object.assign(r.idMap,Ce(((i={})[s.id]=s,i),s.idMap)),s})):si;var o=0;!function t(e){var n,i;e.order=o++;try{for(var s=Me(zn(e)),r=s.next();!r.done;r=s.next()){t(r.value)}}catch(a){n={error:a}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some((function(t){return""===t.event})):""in this.config.on),this.strict=!!this.config.strict,this.onEntry=qe(this.config.entry||this.config.onEntry).map((function(t){return On(t)})),this.onExit=qe(this.config.exit||this.config.onExit).map((function(t){return On(t)})),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=qe(this.config.invoke).map((function(t,e){var n,i;if(cn(t))return r.machine.options.services=Ce(((n={})[t.id]=t,n),r.machine.options.services),ii({src:t.id,id:t.id});if(tn(t.src))return ii(Ce(Ce({},t),{id:t.id||t.src,src:t.src}));if(cn(t.src)||Ze(t.src)){var s="".concat(r.id,":invocation[").concat(e,"]");return r.machine.options.services=Ce(((i={})[s]=t.src,i),r.machine.options.services),ii(Ce(Ce({id:s},t),{src:s}))}var o=t.src;return ii(Ce(Ce({id:o.type},t),{src:o}))})),this.activities=qe(this.config.activities).concat(this.invoke).map((function(t){return Rn(t)})),this.transition=this.transition.bind(this),this.tags=qe(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||Hn(this).forEach((function(t){return t.on}))},t.prototype.withConfig=function(e,n){var i=this.options,s=i.actions,r=i.activities,o=i.guards,a=i.services,c=i.delays;return new t(this.config,{actions:Ce(Ce({},s),e.actions),activities:Ce(Ce({},r),e.activities),guards:Ce(Ce({},o),e.guards),services:Ce(Ce({},a),e.services),delays:Ce(Ce({},c),e.delays)},null!=n?n:this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return Ze(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:je(this.states,(function(t){return t.definition})),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var t=this.transitions;return this.__cache.on=t.reduce((function(t,e){return t[e.eventType]=t[e.eventType]||[],t[e.eventType].push(e),t}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(t){if(this.__cache.candidates[t])return this.__cache.candidates[t];var e=""===t,n=this.transitions.filter((function(n){var i=n.eventType===t;return e?i:i||"*"===n.eventType}));return this.__cache.candidates[t]=n,n},t.prototype.getDelayedTransitions=function(){var t=this,e=this.config.after;if(!e)return[];var n=function(e,n){var i=function(t,e){var n=e?"#".concat(e):"";return"".concat(nn.After,"(").concat(t,")").concat(n)}(Ze(e)?"".concat(t.id,":delay[").concat(n,"]"):e,t.id);return t.onEntry.push(Ln(i,{delay:e})),t.onExit.push({type:bn,sendId:i}),i};return(Je(e)?e.map((function(t,e){var i=n(t.delay,e);return Ce(Ce({},t),{event:i})})):We(Re(e).map((function(t,i){var s=e[t],r=tn(s)?{target:s}:s,o=isNaN(+t)?t:+t,a=n(o,i);return qe(r).map((function(t){return Ce(Ce({},t),{event:a,delay:o})}))})))).map((function(e){var n=e.delay;return Ce(Ce({},t.formatTransition(e)),{delay:n})}))},t.prototype.getStateNodes=function(t){var e,n=this;if(!t)return[];var i=t instanceof Jn?t.value:Fe(t,this.delimiter);if(tn(i)){var s=this.getStateNode(i).initial;return void 0!==s?this.getStateNodes(((e={})[i]=s,e)):[this,this.states[i]]}var r=Re(i),o=[this];return o.push.apply(o,Oe([],De(We(r.map((function(t){return n.getStateNode(t).getStateNodes(i[t])})))),!1)),o},t.prototype.handles=function(t){var e=Le(t);return this.events.includes(e)},t.prototype.resolveState=function(t){var e=Array.from(Wn([],this.getStateNodes(t.value)));return new Jn(Ce(Ce({},t),{value:this.resolve(t.value),configuration:e,done:Yn(e,this),tags:Xn(e)}))},t.prototype.transitionLeafNode=function(t,e,n){var i=this.getStateNode(t).next(e,n);return i&&i.transitions.length?i:this.next(e,n)},t.prototype.transitionCompoundNode=function(t,e,n){var i=Re(t),s=this.getStateNode(i[0])._transition(t[i[0]],e,n);return s&&s.transitions.length?s:this.next(e,n)},t.prototype.transitionParallelNode=function(t,e,n){var i,s,r={};try{for(var o=Me(Re(t)),a=o.next();!a.done;a=o.next()){var c=a.value,h=t[c];if(h){var l=this.getStateNode(c)._transition(h,e,n);l&&(r[c]=l)}}}catch(g){i={error:g}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}var u=Re(r).map((function(t){return r[t]})),d=We(u.map((function(t){return t.transitions})));if(!u.some((function(t){return t.transitions.length>0})))return this.next(e,n);var f=We(u.map((function(t){return t.entrySet}))),p=We(Re(r).map((function(t){return r[t].configuration})));return{transitions:d,entrySet:f,exitSet:We(u.map((function(t){return t.exitSet}))),configuration:p,source:e,actions:We(Re(r).map((function(t){return r[t].actions})))}},t.prototype._transition=function(t,e,n){return tn(t)?this.transitionLeafNode(t,e,n):1===Re(t).length?this.transitionCompoundNode(t,e,n):this.transitionParallelNode(t,e,n)},t.prototype.getTransitionData=function(t,e){return this._transition(t.value,t,ln(e))},t.prototype.next=function(t,e){var n,i,s,r=this,o=e.name,a=[],c=[];try{for(var h=Me(this.getCandidates(o)),l=h.next();!l.done;l=h.next()){var u=l.value,d=u.cond,f=u.in,p=t.context,g=!f||(tn(f)&&ri(f)?t.matches(Fe(this.getStateNodeById(f).path,this.delimiter)):Ne(Fe(f,this.delimiter),ze(this.path.slice(0,-2))(t.value))),m=!1;try{m=!d||dn(this.machine,d,p,e,t)}catch(b){throw new Error("Unable to evaluate guard '".concat(d.name||d.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,"':\n").concat(b.message))}if(m&&g){void 0!==u.target&&(c=u.target),a.push.apply(a,Oe([],De(u.actions),!1)),s=u;break}}}catch(_){n={error:_}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}if(s){if(!c.length)return{transitions:[s],entrySet:[],exitSet:[],configuration:t.value?[this]:[],source:t,actions:a};var y=We(c.map((function(e){return r.getRelativeStateNodes(e,t.historyValue)}))),v=!!s.internal;return{transitions:[s],entrySet:v?[]:We(y.map((function(t){return r.nodesFromChild(t)}))),exitSet:v?[]:[this],configuration:y,source:t,actions:a}}},t.prototype.nodesFromChild=function(t){if(t.escapes(this))return[];for(var e=[],n=t;n&&n!==this;)e.push(n),n=n.parent;return e.push(this),e},t.prototype.escapes=function(t){if(this===t)return!1;for(var e=this.parent;e;){if(e===t)return!1;e=e.parent}return!0},t.prototype.getActions=function(t,e,n,i){var s,r,o,a,c=Wn([],i?this.getStateNodes(i.value):[this]),h=t.configuration.length?Wn(c,t.configuration):c;try{for(var l=Me(h),u=l.next();!u.done;u=l.next()){Gn(c,p=u.value)||t.entrySet.push(p)}}catch(w){s={error:w}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(s)throw s.error}}try{for(var d=Me(c),f=d.next();!f.done;f=d.next()){var p;Gn(h,p=f.value)&&!Gn(t.exitSet,p.parent)||t.exitSet.push(p)}}catch(x){o={error:x}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}var g=We(t.entrySet.map((function(i){var s=[];if("final"!==i.type)return s;var r=i.parent;if(!r.parent)return s;s.push(Vn(i.id,i.doneData),Vn(r.id,i.doneData?Ke(i.doneData,e,n):void 0));var o=r.parent;return"parallel"===o.type&&zn(o).every((function(e){return Yn(t.configuration,e)}))&&s.push(Vn(o.id)),s})));t.exitSet.sort((function(t,e){return e.order-t.order})),t.entrySet.sort((function(t,e){return t.order-e.order}));var m=new Set(t.entrySet),y=new Set(t.exitSet),v=De([We(Array.from(m).map((function(t){return Oe(Oe([],De(t.activities.map((function(t){return function(t){var e=Rn(t);return{type:nn.Start,activity:e,exec:void 0}}(t)}))),!1),De(t.onEntry),!1)}))).concat(g.map(Nn)),We(Array.from(y).map((function(t){return Oe(Oe([],De(t.onExit),!1),De(t.activities.map((function(t){return function(t){var e=Ze(t)?t:Rn(t);return{type:nn.Stop,activity:e,exec:void 0}}(t)}))),!1)})))],2),b=v[0],_=v[1];return Pn(_.concat(t.actions).concat(b),this.machine.options.actions)},t.prototype.transition=function(t,e,n){void 0===t&&(t=this.initialState);var i,s,r=ln(e);if(t instanceof Jn)i=void 0===n?t:this.resolveState(Jn.from(t,n));else{var o=tn(t)?this.resolve(Ue(this.getResolvedPath(t))):this.resolve(t),a=null!=n?n:this.machine.context;i=this.resolveState(Jn.from(o,a))}if(this.strict&&!this.events.includes(r.name)&&(s=r.name,!/^(done|error)\./.test(s)))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(r.name,"'"));var c=this._transition(i.value,i,r)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:i,actions:[]},h=Wn([],this.getStateNodes(i.value)),l=c.configuration.length?Wn(h,c.configuration):h;return c.configuration=Oe([],De(l),!1),this.resolveTransition(c,i,r)},t.prototype.resolveRaisedTransition=function(t,e,n){var i,s=t.actions;return(t=this.transition(t,e))._event=n,t.event=n.data,(i=t.actions).unshift.apply(i,Oe([],De(s),!1)),t},t.prototype.resolveTransition=function(t,e,n,i){var s,r,o=this;void 0===n&&(n=Mn),void 0===i&&(i=this.machine.context);var a=t.configuration,c=!e||t.transitions.length>0,h=c?Kn(this.machine,a):void 0,l=e?e.historyValue?e.historyValue:t.source?this.machine.historyValue(e.value):void 0:void 0,u=e?e.context:i,d=this.getActions(t,u,n,e),f=e?Ce({},e.activities):{};try{for(var p=Me(d),g=p.next();!g.done;g=p.next()){var m=g.value;m.type===gn?f[m.activity.id||m.activity.type]=m:m.type===mn&&(f[m.activity.id||m.activity.type]=!1)}}catch(N){s={error:N}}finally{try{g&&!g.done&&(r=p.return)&&r.call(p)}finally{if(s)throw s.error}}var y,v,b=De(jn(this,e,u,n,d,this.machine.config.preserveActionOrder),2),_=b[0],w=b[1],x=De(Ye(_,(function(t){return t.type===yn||t.type===vn&&t.to===rn.Internal})),2),S=x[0],E=x[1],T=_.filter((function(t){var e;return t.type===gn&&(null===(e=t.activity)||void 0===e?void 0:e.type)===En})).reduce((function(t,e){return t[e.activity.id]=ei(e.activity,o.machine,w,n),t}),e?Ce({},e.children):{}),k=h?t.configuration:e?e.configuration:[],I=Yn(k,this),C=new Jn({value:h||e.value,context:w,_event:n,_sessionid:e?e._sessionid:null,historyValue:h?l?(y=l,v=h,{current:v,states:Xe(y,v)}):void 0:e?e.historyValue:void 0,history:!h||t.source?e:void 0,actions:h?E:[],activities:h?f:e?e.activities:{},events:[],configuration:k,transitions:t.transitions,children:T,done:I,tags:null==e?void 0:e.tags,machine:this}),A=u!==w;C.changed=n.name===In||A;var M=C.history;M&&delete M.history;var D=!I&&(this._transient||a.some((function(t){return t._transient})));if(!(c||D&&""!==n.name))return C;var O=C;if(!I)for(D&&(O=this.resolveRaisedTransition(O,{type:_n},n));S.length;){var P=S.shift();O=this.resolveRaisedTransition(O,P._event,n)}var R=O.changed||(M?!!O.actions.length||A||typeof M.value!=typeof O.value||!Qn(O.value,M.value):void 0);return O.changed=R,O.history=M,O.tags=Xn(O.configuration),O},t.prototype.getStateNode=function(t){if(ri(t))return this.machine.getStateNodeById(t);if(!this.states)throw new Error("Unable to retrieve child state '".concat(t,"' from '").concat(this.id,"'; no child states exist."));var e=this.states[t];if(!e)throw new Error("Child state '".concat(t,"' does not exist on '").concat(this.id,"'"));return e},t.prototype.getStateNodeById=function(t){var e=ri(t)?t.slice("#".length):t;if(e===this.id)return this;var n=this.machine.idMap[e];if(!n)throw new Error("Child state node '#".concat(e,"' does not exist on machine '").concat(this.id,"'"));return n},t.prototype.getStateNodeByPath=function(t){if("string"==typeof t&&ri(t))try{return this.getStateNodeById(t.slice(1))}catch(s){}for(var e=Ve(t,this.delimiter).slice(),n=this;e.length;){var i=e.shift();if(!i.length)break;n=n.getStateNode(i)}return n},t.prototype.resolve=function(t){var e,n=this;if(!t)return this.initialStateValue||si;switch(this.type){case"parallel":return je(this.initialStateValue,(function(e,i){return e?n.getStateNode(i).resolve(t[i]||e):si}));case"compound":if(tn(t)){var i=this.getStateNode(t);return"parallel"===i.type||"compound"===i.type?((e={})[t]=i.initialStateValue,e):t}return Re(t).length?je(t,(function(t,e){return t?n.getStateNode(e).resolve(t):si})):this.initialStateValue||{};default:return t||si}},t.prototype.getResolvedPath=function(t){if(ri(t)){var e=this.machine.idMap[t.slice("#".length)];if(!e)throw new Error("Unable to find state node '".concat(t,"'"));return e.path}return Ve(t,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var t,e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)e=Be(this.states,(function(t){return t.initialStateValue||si}),(function(t){return!("history"===t.type)}));else if(void 0!==this.initial){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));e=Bn(this.states[this.initial])?this.initial:((t={})[this.initial]=this.states[this.initial].initialStateValue,t)}else e={};return this.__cache.initialStateValue=e,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(t,e){var n=this.getStateNodes(t);return this.resolveTransition({configuration:n,entrySet:n,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,void 0,e)},Object.defineProperty(t.prototype,"initialState",{get:function(){this._init();var t=this.initialStateValue;if(!t)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var t;if("history"===this.type){var e=this.config;t=tn(e.target)&&ri(e.target)?Ue(this.machine.getStateNodeById(e.target).path.slice(this.path.length-1)):e.target}return t},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(t,e,n){return void 0===n&&(n=!0),n?"history"===t.type?t.resolveHistory(e):t.initialStateNodes:[t]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var t=this;return Bn(this)?[this]:"compound"!==this.type||this.initial?We(He(this.initialStateValue).map((function(e){return t.getFromRelativePath(e)}))):[this]},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(t){if(!t.length)return[this];var e=De(t),n=e[0],i=e.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var s=this.getStateNode(n);if("history"===s.type)return s.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(i)},t.prototype.historyValue=function(t){if(Re(this.states).length)return{current:t||this.initialStateValue,states:Be(this.states,(function(e,n){if(!t)return e.historyValue();var i=tn(t)?void 0:t[n];return e.historyValue(i||e.initialStateValue)}),(function(t){return!t.history}))}},t.prototype.resolveHistory=function(t){var e=this;if("history"!==this.type)return[this];var n=this.parent;if(!t){var i=this.target;return i?We(He(i).map((function(t){return n.getFromRelativePath(t)}))):n.initialStateNodes}var s,r,o=(s=n.path,r="states",function(t){var e,n,i=t;try{for(var o=Me(s),a=o.next();!a.done;a=o.next()){var c=a.value;i=i[r][c]}}catch(h){e={error:h}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return i})(t).current;return tn(o)?[n.getStateNode(o)]:We(He(o).map((function(t){return"deep"===e.history?n.getFromRelativePath(t):[n.states[t[0]]]})))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var t=this,e=We(Re(this.states).map((function(e){return t.states[e].stateIds})));return[this.id].concat(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var t,e,n,i;if(this.__cache.events)return this.__cache.events;var s=this.states,r=new Set(this.ownEvents);if(s)try{for(var o=Me(Re(s)),a=o.next();!a.done;a=o.next()){var c=s[a.value];if(c.states)try{for(var h=(n=void 0,Me(c.events)),l=h.next();!l.done;l=h.next()){var u=l.value;r.add("".concat(u))}}catch(d){n={error:d}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}}catch(f){t={error:f}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return this.__cache.events=Array.from(r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var t=new Set(this.transitions.filter((function(t){return!(!t.target&&!t.actions.length&&t.internal)})).map((function(t){return t.eventType})));return Array.from(t)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(t){var e=this;if(void 0!==t)return t.map((function(t){if(!tn(t))return t;var n=t[0]===e.delimiter;if(n&&!e.parent)return e.getStateNodeByPath(t.slice(1));var i=n?e.key+t:t;if(!e.parent)return e.getStateNodeByPath(i);try{return e.parent.getStateNodeByPath(i)}catch(s){throw new Error("Invalid transition definition for state node '".concat(e.id,"':\n").concat(s.message))}}))},t.prototype.formatTransition=function(t){var e=this,n=function(t){if(void 0!==t&&""!==t)return qe(t)}(t.target),i="internal"in t?t.internal:!n||n.some((function(t){return tn(t)&&t[0]===e.delimiter})),s=this.machine.options.guards,r=this.resolveTarget(n),o=Ce(Ce({},t),{actions:Pn(qe(t.actions)),cond:en(t.cond,s),target:r,source:this,internal:i,eventType:t.event,toJSON:function(){return Ce(Ce({},o),{target:o.target?o.target.map((function(t){return"#".concat(t.id)})):void 0,source:"#".concat(e.id)})}});return o},t.prototype.formatTransitions=function(){var t,e,n,i=this;if(this.config.on)if(Array.isArray(this.config.on))n=this.config.on;else{var s=this.config.on,r="*",o=s[r],a=void 0===o?[]:o,c=Ae(s,["*"]);n=We(Re(c).map((function(t){var e=un(t,c[t]);return e})).concat(un("*",a)))}else n=[];var h=this.config.always?un("",this.config.always):[],l=this.config.onDone?un(String(Vn(this.id)),this.config.onDone):[];var u=We(this.invoke.map((function(t){var e=[];return t.onDone&&e.push.apply(e,Oe([],De(un(String(Fn(t.id)),t.onDone)),!1)),t.onError&&e.push.apply(e,Oe([],De(un(String(Un(t.id)),t.onError)),!1)),e}))),d=this.after,f=We(Oe(Oe(Oe(Oe([],De(l),!1),De(u),!1),De(n),!1),De(h),!1).map((function(t){return qe(t).map((function(t){return i.formatTransition(t)}))})));try{for(var p=Me(d),g=p.next();!g.done;g=p.next()){var m=g.value;f.push(m)}}catch(y){t={error:y}}finally{try{g&&!g.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}return f},t}();function ai(t,e){return new oi(t,e)}var ci={deferEvents:!1},hi=function(){function t(t){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=Ce(Ce({},ci),t)}return t.prototype.initialize=function(t){if(this.initialized=!0,t){if(!this.options.deferEvents)return void this.schedule(t);this.process(t)}this.flushEvents()},t.prototype.schedule=function(t){if(this.initialized&&!this.processingEvent){if(0!==this.queue.length)throw new Error("Event queue should be empty when it is not processing events");this.process(t),this.flushEvents()}else this.queue.push(t)},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var t=this.queue.shift();t;)this.process(t),t=this.queue.shift()},t.prototype.process=function(t){this.processingEvent=!0;try{t()}catch(e){throw this.clear(),e}finally{this.processingEvent=!1}},t}(),li=new Map,ui=0,di=function(){return"x:".concat(ui++)},fi=function(t,e){return li.set(t,e),t},pi=function(t){return li.get(t)},gi=function(t){li.delete(t)};function mi(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0}function yi(t){if(mi()){var e=function(){var t=mi();if(t&&"__xstate__"in t)return t.__xstate__}();e&&e.register(t)}}function vi(t,e){void 0===e&&(e={});var n,i=t.initialState,s=new Set,r=[],o=!1,a=(n={id:e.id,send:function(e){r.push(e),function(){if(!o){for(o=!0;r.length>0;){var e=r.shift();i=t.transition(i,e,c),s.forEach((function(t){return t.next(i)}))}o=!1}}()},getSnapshot:function(){return i},subscribe:function(t,e,n){var r=pn(t,e,n);return s.add(r),r.next(i),{unsubscribe:function(){s.delete(r)}}}},Ce({subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},n)),c={parent:e.parent,self:a,id:e.id||"anonymous",observers:s};return i=t.start?t.start(c):i,a}var bi,_i,wi={sync:!1,autoForward:!1};(_i=bi||(bi={}))[_i.NotStarted=0]="NotStarted",_i[_i.Running=1]="Running",_i[_i.Stopped=2]="Stopped";var xi=function(){function t(e,n){var i=this;void 0===n&&(n=t.defaultOptions),this.machine=e,this.scheduler=new hi,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=bi.NotStarted,this.children=new Map,this.forwardTo=new Set,this.init=this.start,this.send=function(t,e){if(Je(t))return i.batch(t),i.state;var n=ln(hn(t,e));if(i.status===bi.Stopped)return i.state;if(i.status!==bi.Running&&!i.options.deferEvents)throw new Error('Event "'.concat(n.name,'" was sent to uninitialized service "').concat(i.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(JSON.stringify(n.data)));return i.scheduler.schedule((function(){i.forward(n);var t=i.nextState(n);i.update(t,n)})),i._state},this.sendTo=function(t,e){var n,s=i.parent&&(e===rn.Parent||i.parent.id===e),r=s?i.parent:tn(e)?i.children.get(e)||pi(e):(n=e)&&"function"==typeof n.send?e:void 0;if(r)"machine"in r?r.send(Ce(Ce({},t),{name:t.name===kn?"".concat(Un(i.id)):t.name,origin:i.sessionId})):r.send(t.data);else if(!s)throw new Error("Unable to send event to child '".concat(e,"' from service '").concat(i.id,"'."))};var s=Ce(Ce({},t.defaultOptions),n),r=s.clock,o=s.logger,a=s.parent,c=s.id,h=void 0!==c?c:e.id;this.id=h,this.logger=o,this.clock=r,this.parent=a,this.options=s,this.scheduler=new hi({deferEvents:this.options.deferEvents}),this.sessionId=di()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var t=this;return this._initialState?this._initialState:Zn(this,(function(){return t._initialState=t.machine.initialState,t._initialState}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(t,e){var n,i;try{for(var s=Me(t.actions),r=s.next();!r.done;r=s.next()){var o=r.value;this.exec(o,t,e)}}catch(a){n={error:a}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}},t.prototype.update=function(t,e){var n,i,s,r,o,a,c,h,l=this;if(t._sessionid=this.sessionId,this._state=t,this.options.execute&&this.execute(this.state),this.children.forEach((function(t){l.state.children[t.id]=t})),this.devTools&&this.devTools.send(e.data,t),t.event)try{for(var u=Me(this.eventListeners),d=u.next();!d.done;d=u.next()){(0,d.value)(t.event)}}catch(x){n={error:x}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}try{for(var f=Me(this.listeners),p=f.next();!p.done;p=f.next()){(0,p.value)(t,t.event)}}catch(S){s={error:S}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(s)throw s.error}}try{for(var g=Me(this.contextListeners),m=g.next();!m.done;m=g.next()){(0,m.value)(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(E){o={error:E}}finally{try{m&&!m.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}var y=Yn(t.configuration||[],this.machine);if(this.state.configuration&&y){var v=t.configuration.find((function(t){return"final"===t.type&&t.parent===l.machine})),b=v&&v.doneData?Ke(v.doneData,t.context,e):void 0;try{for(var _=Me(this.doneListeners),w=_.next();!w.done;w=_.next()){(0,w.value)(Fn(this.id,b))}}catch(T){c={error:T}}finally{try{w&&!w.done&&(h=_.return)&&h.call(_)}finally{if(c)throw c.error}}this.stop()}},t.prototype.onTransition=function(t){return this.listeners.add(t),this.status===bi.Running&&t(this.state,this.state.event),this},t.prototype.subscribe=function(t,e,n){var i,s=this;if(!t)return{unsubscribe:function(){}};var r=n;return"function"==typeof t?i=t:(i=t.next.bind(t),r=t.complete.bind(t)),this.listeners.add(i),this.status===bi.Running&&i(this.state),r&&this.onDone(r),{unsubscribe:function(){i&&s.listeners.delete(i),r&&s.doneListeners.delete(r)}}},t.prototype.onEvent=function(t){return this.eventListeners.add(t),this},t.prototype.onSend=function(t){return this.sendListeners.add(t),this},t.prototype.onChange=function(t){return this.contextListeners.add(t),this},t.prototype.onStop=function(t){return this.stopListeners.add(t),this},t.prototype.onDone=function(t){return this.doneListeners.add(t),this},t.prototype.off=function(t){return this.listeners.delete(t),this.eventListeners.delete(t),this.sendListeners.delete(t),this.stopListeners.delete(t),this.doneListeners.delete(t),this.contextListeners.delete(t),this},t.prototype.start=function(t){var e=this;if(this.status===bi.Running)return this;fi(this.sessionId,this),this.initialized=!0,this.status=bi.Running;var n=void 0===t?this.initialState:Zn(this,(function(){return!tn(n=t)&&"value"in n&&"history"in n?e.machine.resolveState(t):e.machine.resolveState(Jn.from(t,e.machine.context));var n}));return this.options.devTools&&this.attachDev(),this.scheduler.initialize((function(){e.update(n,Mn)})),this},t.prototype.stop=function(){var t,e,n,i,s,r,o,a,c,h,l=this;try{for(var u=Me(this.listeners),d=u.next();!d.done;d=u.next()){var f=d.value;this.listeners.delete(f)}}catch(S){t={error:S}}finally{try{d&&!d.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}try{for(var p=Me(this.stopListeners),g=p.next();!g.done;g=p.next()){(f=g.value)(),this.stopListeners.delete(f)}}catch(E){n={error:E}}finally{try{g&&!g.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}try{for(var m=Me(this.contextListeners),y=m.next();!y.done;y=m.next()){f=y.value;this.contextListeners.delete(f)}}catch(T){s={error:T}}finally{try{y&&!y.done&&(r=m.return)&&r.call(m)}finally{if(s)throw s.error}}try{for(var v=Me(this.doneListeners),b=v.next();!b.done;b=v.next()){f=b.value;this.doneListeners.delete(f)}}catch(k){o={error:k}}finally{try{b&&!b.done&&(a=v.return)&&a.call(v)}finally{if(o)throw o.error}}if(!this.initialized)return this;this.state.configuration.forEach((function(t){var e,n;try{for(var i=Me(t.definition.exit),s=i.next();!s.done;s=i.next()){var r=s.value;l.exec(r,l.state)}}catch(o){e={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}})),this.children.forEach((function(t){Ze(t.stop)&&t.stop()}));try{for(var _=Me(Re(this.delayedEventsMap)),w=_.next();!w.done;w=_.next()){var x=w.value;this.clock.clearTimeout(this.delayedEventsMap[x])}}catch(I){c={error:I}}finally{try{w&&!w.done&&(h=_.return)&&h.call(_)}finally{if(c)throw c.error}}return this.scheduler.clear(),this.initialized=!1,this.status=bi.Stopped,gi(this.sessionId),this},t.prototype.batch=function(t){var e=this;if(this.status===bi.NotStarted&&this.options.deferEvents)0;else if(this.status!==bi.Running)throw new Error("".concat(t.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));this.scheduler.schedule((function(){var n,i,s=e.state,r=!1,o=[],a=function(t){var n=ln(t);e.forward(n),s=Zn(e,(function(){return e.machine.transition(s,n)})),o.push.apply(o,Oe([],De(s.actions.map((function(t){return n=s,i=(e=t).exec,Ce(Ce({},e),{exec:void 0!==i?function(){return i(n.context,n.event,{action:e,state:n,_event:n._event})}:void 0});var e,n,i}))),!1)),r=r||!!s.changed};try{for(var c=Me(t),h=c.next();!h.done;h=c.next()){a(h.value)}}catch(l){n={error:l}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}s.changed=r,s.actions=o,e.update(s,ln(t[t.length-1]))}))},t.prototype.sender=function(t){return this.send.bind(this,t)},t.prototype.nextState=function(t){var e=this,n=ln(t);if(0===n.name.indexOf(Tn)&&!this.state.nextEvents.some((function(t){return 0===t.indexOf(Tn)})))throw n.data.data;return Zn(this,(function(){return e.machine.transition(e.state,n)}))},t.prototype.forward=function(t){var e,n;try{for(var i=Me(this.forwardTo),s=i.next();!s.done;s=i.next()){var r=s.value,o=this.children.get(r);if(!o)throw new Error("Unable to forward event '".concat(t,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(r,"'."));o.send(t)}}catch(a){e={error:a}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.defer=function(t){var e=this;this.delayedEventsMap[t.id]=this.clock.setTimeout((function(){t.to?e.sendTo(t._event,t.to):e.send(t._event)}),t.delay)},t.prototype.cancel=function(t){this.clock.clearTimeout(this.delayedEventsMap[t]),delete this.delayedEventsMap[t]},t.prototype.exec=function(t,e,n){void 0===n&&(n=this.machine.options.actions);var i=e.context,s=e._event,r=t.exec||Dn(t.type,n),o=Ze(r)?r:r?r.exec:t.exec;if(o)try{return o(i,s.data,{action:t,state:this.state,_event:s})}catch(b){throw this.parent&&this.parent.send({type:"xstate.error",data:b}),b}switch(t.type){case vn:var a=t;if("number"==typeof a.delay)return void this.defer(a);a.to?this.sendTo(a._event,a.to):this.send(a._event);break;case bn:this.cancel(t.sendId);break;case gn:if(this.status!==bi.Running)return;var c=t.activity;if(!this.state.activities[c.id||c.type])break;if(c.type===nn.Invoke){var h=fn(c.src),l=this.machine.options.services?this.machine.options.services[h.type]:void 0,u=c.id,d=c.data;0;var f="autoForward"in c?c.autoForward:!!c.forward;if(!l)return void 0;var p=d?Ke(d,i,s):void 0;if("string"==typeof l)return;var g=Ze(l)?l(i,s.data,{data:p,src:h,meta:c.meta}):l;if(!g)return;var m=void 0;cn(g)&&(g=p?g.withContext(p):g,m={autoForward:f}),this.spawn(g,u,m)}else this.spawnActivity(c);break;case mn:this.stopChild(t.activity.id);break;case xn:var y=t.label,v=t.value;y?this.logger(y,v):this.logger(v);break;default:0}},t.prototype.removeChild=function(t){var e;this.children.delete(t),this.forwardTo.delete(t),null===(e=this.state)||void 0===e||delete e.children[t]},t.prototype.stopChild=function(t){var e=this.children.get(t);e&&(this.removeChild(t),Ze(e.stop)&&e.stop())},t.prototype.spawn=function(t,e,n){if(Ge(t))return this.spawnPromise(Promise.resolve(t),e);if(Ze(t))return this.spawnCallback(t,e);if(function(t){try{return"function"==typeof t.send}catch(e){return!1}}(s=t)&&"id"in s)return this.spawnActor(t,e);if(function(t){try{return"subscribe"in t&&Ze(t.subscribe)}catch(e){return!1}}(t))return this.spawnObservable(t,e);if(cn(t))return this.spawnMachine(t,Ce(Ce({},n),{id:e}));if(null!==(i=t)&&"object"==typeof i&&"transition"in i&&"function"==typeof i.transition)return this.spawnBehavior(t,e);throw new Error('Unable to spawn entity "'.concat(e,'" of type "').concat(typeof t,'".'));var i,s},t.prototype.spawnMachine=function(e,n){var i=this;void 0===n&&(n={});var s=new t(e,Ce(Ce({},this.options),{parent:this,id:n.id||e.id})),r=Ce(Ce({},wi),n);r.sync&&s.onTransition((function(t){i.send(In,{state:t,id:s.id})}));var o=s;return this.children.set(s.id,o),r.autoForward&&this.forwardTo.add(s.id),s.onDone((function(t){i.removeChild(s.id),i.send(ln(t,{origin:s.id}))})).start(),o},t.prototype.spawnBehavior=function(t,e){var n=vi(t,{id:e,parent:this});return this.children.set(e,n),n},t.prototype.spawnPromise=function(t,e){var n,i=this,s=!1;t.then((function(t){s||(n=t,i.removeChild(e),i.send(ln(Fn(e,t),{origin:e})))}),(function(t){if(!s){i.removeChild(e);var n=Un(e,t);try{i.send(ln(n,{origin:e}))}catch(r){i.devTools&&i.devTools.send(n,i.state),i.machine.strict&&i.stop()}}}));var r={id:e,send:function(){},subscribe:function(e,n,i){var s=pn(e,n,i),r=!1;return t.then((function(t){r||(s.next(t),r||s.complete())}),(function(t){r||s.error(t)})),{unsubscribe:function(){return r=!0}}},stop:function(){s=!0},toJSON:function(){return{id:e}},getSnapshot:function(){return n}};return this.children.set(e,r),r},t.prototype.spawnCallback=function(t,e){var n,i,s=this,r=!1,o=new Set,a=new Set;try{i=t((function(t){n=t,a.forEach((function(e){return e(t)})),r||s.send(ln(t,{origin:e}))}),(function(t){o.add(t)}))}catch(h){this.send(Un(e,h))}if(Ge(i))return this.spawnPromise(i,e);var c={id:e,send:function(t){return o.forEach((function(e){return e(t)}))},subscribe:function(t){return a.add(t),{unsubscribe:function(){a.delete(t)}}},stop:function(){r=!0,Ze(i)&&i()},toJSON:function(){return{id:e}},getSnapshot:function(){return n}};return this.children.set(e,c),c},t.prototype.spawnObservable=function(t,e){var n,i=this,s=t.subscribe((function(t){n=t,i.send(ln(t,{origin:e}))}),(function(t){i.removeChild(e),i.send(ln(Un(e,t),{origin:e}))}),(function(){i.removeChild(e),i.send(ln(Fn(e),{origin:e}))})),r={id:e,send:function(){},subscribe:function(e,n,i){return t.subscribe(e,n,i)},stop:function(){return s.unsubscribe()},getSnapshot:function(){return n},toJSON:function(){return{id:e}}};return this.children.set(e,r),r},t.prototype.spawnActor=function(t,e){return this.children.set(e,t),t},t.prototype.spawnActivity=function(t){var e=this.machine.options&&this.machine.options.activities?this.machine.options.activities[t.type]:void 0;if(e){var n=e(this.state.context,t);this.spawnEffect(t.id,n)}},t.prototype.spawnEffect=function(t,e){this.children.set(t,{id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:e||void 0,getSnapshot:function(){},toJSON:function(){return{id:t}}})},t.prototype.attachDev=function(){var t=mi();if(this.options.devTools&&t){if(t.__REDUX_DEVTOOLS_EXTENSION__){var e="object"==typeof this.options.devTools?this.options.devTools:void 0;this.devTools=t.__REDUX_DEVTOOLS_EXTENSION__.connect(Ce(Ce({name:this.id,autoPause:!0,stateSanitizer:function(t){return{value:t.value,context:t.context,actions:t.actions}}},e),{features:Ce({jump:!1,skip:!1},e?e.features:void 0)}),this.machine),this.devTools.init(this.state)}yi(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[an]=function(){return this},t.prototype.getSnapshot=function(){return this.status===bi.NotStarted?this.initialState:this._state},t.defaultOptions=function(t){return{execute:!0,deferEvents:!0,clock:{setTimeout:function(t,e){return setTimeout(t,e)},clearTimeout:function(t){return clearTimeout(t)}},logger:(typeof self!=="undefined"?self:global).console.log.bind(console),devTools:!1}}(),t.interpret=Si,t}();function Si(t,e){return new xi(t,e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let s=t.charCodeAt(i);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296==(64512&s)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++i)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},Ti={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<t.length;s+=3){const e=t[s],r=s+1<t.length,o=r?t[s+1]:0,a=s+2<t.length,c=a?t[s+2]:0,h=e>>2,l=(3&e)<<4|o>>4;let u=(15&o)<<2|c>>6,d=63&c;a||(d=64,r||(u=64)),i.push(n[h],n[l],n[u],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ei(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const s=t[n++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=t[n++];e[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const r=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(r>>10)),e[i++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<t.length;){const e=n[t.charAt(s++)],r=s<t.length?n[t.charAt(s)]:0;++s;const o=s<t.length?n[t.charAt(s)]:64;++s;const a=s<t.length?n[t.charAt(s)]:64;if(++s,null==e||null==r||null==o||null==a)throw Error();const c=e<<2|r>>4;if(i.push(c),64!==o){const t=r<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},ki=function(t){return function(t){const e=Ei(t);return Ti.encodeByteArray(e,!0)}(t).replace(/\./g,"")};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ii{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ci(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ai(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ci())}function Mi(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function Di(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Oi(){const t=Ci();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}class Pi extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Pi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ri.prototype.create)}}class Ri{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,s=this.errors[t],r=s?function(t,e){return t.replace(Ni,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(s,n):"Error",o=`${this.serviceName}: ${r} (${i}).`;return new Pi(i,o,n)}}const Ni=/\{\$([^}]+)}/g;function Li(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const s of n){if(!i.includes(s))return!1;const n=t[s],r=e[s];if(Vi(n)&&Vi(r)){if(!Li(n,r))return!1}else if(n!==r)return!1}for(const s of i)if(!n.includes(s))return!1;return!0}function Vi(t){return null!==t&&"object"==typeof t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Ui(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function ji(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class Bi{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t,e){if("object"!=typeof t||null===t)return!1;for(const n of e)if(n in t&&"function"==typeof t[n])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=zi),void 0===i.error&&(i.error=zi),void 0===i.complete&&(i.complete=zi);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),s}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(n){"undefined"!=typeof console&&console.error&&console.error(n)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function zi(){}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hi(t){return t&&t._delegate?t._delegate:t}class Wi{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class $i{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new Ii;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(n){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t))try{this.getOrInitializeService({instanceIdentifier:"[DEFAULT]"})}catch(e){}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:i});n.resolve(t)}catch(e){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[s,r]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&r.resolve(i)}return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch(i){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,"[DEFAULT]"===i?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(s){}var i;return n||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class qi{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new $i(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ki,Gi;(Gi=Ki||(Ki={}))[Gi.DEBUG=0]="DEBUG",Gi[Gi.VERBOSE=1]="VERBOSE",Gi[Gi.INFO=2]="INFO",Gi[Gi.WARN=3]="WARN",Gi[Gi.ERROR=4]="ERROR",Gi[Gi.SILENT=5]="SILENT";const Yi={debug:Ki.DEBUG,verbose:Ki.VERBOSE,info:Ki.INFO,warn:Ki.WARN,error:Ki.ERROR,silent:Ki.SILENT},Xi=Ki.INFO,Qi={[Ki.DEBUG]:"log",[Ki.VERBOSE]:"log",[Ki.INFO]:"info",[Ki.WARN]:"warn",[Ki.ERROR]:"error"},Ji=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),s=Qi[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${i}]  ${t.name}:`,...n)};class Zi{constructor(t){this.name=t,this._logLevel=Xi,this._logHandler=Ji,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ki))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?Yi[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ki.DEBUG,...t),this._logHandler(this,Ki.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ki.VERBOSE,...t),this._logHandler(this,Ki.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ki.INFO,...t),this._logHandler(this,Ki.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ki.WARN,...t),this._logHandler(this,Ki.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ki.ERROR,...t),this._logHandler(this,Ki.ERROR,...t)}}let ts,es;const ns=new WeakMap,is=new WeakMap,ss=new WeakMap,rs=new WeakMap,os=new WeakMap;let as={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return is.get(t);if("objectStoreNames"===e)return t.objectStoreNames||ss.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ls(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function cs(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(es||(es=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(us(this),e),ls(ns.get(this))}:function(...e){return ls(t.apply(us(this),e))}:function(e,...n){const i=t.call(us(this),e,...n);return ss.set(i,e.sort?e.sort():[e]),ls(i)}}function hs(t){return"function"==typeof t?cs(t):(t instanceof IDBTransaction&&function(t){if(is.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{e(),i()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)}));is.set(t,e)}(t),e=t,(ts||(ts=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>e instanceof t))?new Proxy(t,as):t);var e}function ls(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{e(ls(t.result)),i()},r=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&ns.set(e,t)})).catch((()=>{})),os.set(e,t),e}(t);if(rs.has(t))return rs.get(t);const e=hs(t);return e!==t&&(rs.set(t,e),os.set(e,t)),e}const us=t=>os.get(t);const ds=["get","getKey","getAll","getAllKeys","count"],fs=["put","add","delete","clear"],ps=new Map;function gs(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(ps.get(e))return ps.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=fs.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!ds.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),s&&r.done]))[0]};return ps.set(e,r),r}as=(t=>r(r({},t),{get:(e,n,i)=>gs(e,n)||t.get(e,n,i),has:(e,n)=>!!gs(e,n)||t.has(e,n)}))(as);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ms{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const ys="@firebase/app",vs=new Zi("@firebase/app"),bs={[ys]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},_s=new Map,ws=new Map;function xs(t,e){try{t.container.addComponent(e)}catch(n){vs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ss(t){const e=t.name;if(ws.has(e))return vs.debug(`There were multiple attempts to register component ${e}.`),!1;ws.set(e,t);for(const n of _s.values())xs(n,t);return!0}function Es(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts=new Ri("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ks{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Wi("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ts.create("app-deleted",{appName:this._name})}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(t,e={}){if("object"!=typeof e){e={name:e}}const n=Object.assign({name:"[DEFAULT]",automaticDataCollectionEnabled:!1},e),i=n.name;if("string"!=typeof i||!i)throw Ts.create("bad-app-name",{appName:String(i)});const s=_s.get(i);if(s){if(Li(t,s.options)&&Li(n,s.config))return s;throw Ts.create("duplicate-app",{appName:i})}const r=new qi(i);for(const a of ws.values())r.addComponent(a);const o=new ks(t,n,r);return _s.set(i,o),o}function Cs(t="[DEFAULT]"){const e=_s.get(t);if(!e)throw Ts.create("no-app",{appName:t});return e}function As(t,e,n){var i;let s=null!==(i=bs[t])&&void 0!==i?i:t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const t=[`Unable to register library "${s}" with version "${e}":`];return r&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void vs.warn(t.join(" "))}Ss(new Wi(`${s}-version`,(()=>({library:s,version:e})),"VERSION"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ms="firebase-heartbeat-store";let Ds=null;function Os(){return Ds||(Ds=function(t,e,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(t,e),a=ls(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(ls(o.result),t.oldVersion,t.newVersion,ls(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((t=>{r&&t.addEventListener("close",(()=>r())),s&&t.addEventListener("versionchange",(()=>s()))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ms)}}}).catch((t=>{throw Ts.create("idb-open",{originalErrorMessage:t.message})}))),Ds}async function Ps(t,e){var n;try{const n=(await Os()).transaction(Ms,"readwrite"),i=n.objectStore(Ms);return await i.put(e,Rs(t)),n.done}catch(i){if(i instanceof Pi)vs.warn(i.message);else{const t=Ts.create("idb-set",{originalErrorMessage:null===(n=i)||void 0===n?void 0:n.message});vs.warn(t.message)}}}function Rs(t){return`${t.name}!${t.options.appId}`}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Vs(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=Ls();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=Ls(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let i=t.slice();for(const s of t){const t=n.find((t=>t.agent===s.agent));if(t){if(t.dates.push(s.date),Fs(n)>e){t.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Fs(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=ki(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Ls(){return(new Date).toISOString().substring(0,10)}class Vs{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return"object"==typeof indexedDB&&new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")}}catch(n){e(n)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(t){var e;try{return(await Os()).transaction(Ms).objectStore(Ms).get(Rs(t))}catch(n){if(n instanceof Pi)vs.warn(n.message);else{const t=Ts.create("idb-get",{originalErrorMessage:null===(e=n)||void 0===e?void 0:e.message});vs.warn(t.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ps(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ps(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function Fs(t){return ki(JSON.stringify({version:2,heartbeats:t})).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Us;function js(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}Us="",Ss(new Wi("platform-logger",(t=>new ms(t)),"PRIVATE")),Ss(new Wi("heartbeat",(t=>new Ns(t)),"PRIVATE")),As(ys,"0.7.32",Us),As(ys,"0.7.32","esm2017"),As("fire-js","");const Bs=js,zs=new Ri("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Hs=new Zi("@firebase/auth");function Ws(t,...e){Hs.logLevel<=Ki.ERROR&&Hs.error(`Auth (9.9.4): ${t}`,...e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $s(t,...e){throw Ks(t,...e)}function qs(t,...e){return Ks(t,...e)}function Ks(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return zs.create(t,...e)}function Gs(t,e,...n){if(!t)throw Ks(e,...n)}function Ys(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ws(e),new Error(e)}function Xs(t,e){t||Ys(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs=new Map;function Js(t){Xs(t instanceof Function,"Expected a class definition");let e=Qs.get(t);return e?(Xs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Qs.set(t,e),e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Zs(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function tr(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(){return"undefined"==typeof navigator||!navigator||!("onLine"in navigator)||"boolean"!=typeof navigator.onLine||"http:"!==tr()&&"https:"!==tr()&&!Mi()&&!("connection"in navigator)||navigator.onLine}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class nr{constructor(t,e){this.shortDelay=t,this.longDelay=e,Xs(e>t,"Short delay should be less than long delay!"),this.isMobile=Ai()||Di()}get(){return er()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(t,e){Xs(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Ys("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Ys("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Ys("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},or=new nr(3e4,6e4);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ar(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function cr(t,e,n,i,s={}){return hr(t,s,(async()=>{let s={},r={};i&&("GET"===e?r=i:s={body:JSON.stringify(i)});const o=Fi(Object.assign({key:t.config.apiKey},r)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),sr.fetch()(ur(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},s))}))}async function hr(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},rr),e);try{const e=new dr(t),s=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const r=await s.json();if("needConfirmation"in r)throw fr(t,"account-exists-with-different-credential",r);if(s.ok&&!("errorMessage"in r))return r;{const e=s.ok?r.errorMessage:r.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw fr(t,"credential-already-in-use",r);if("EMAIL_EXISTS"===n)throw fr(t,"email-already-in-use",r);if("USER_DISABLED"===n)throw fr(t,"user-disabled",r);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(t,e,n){const i=Object.assign(Object.assign({},Bs()),{[e]:n});return new Ri("auth","Firebase",i).create(e,{appName:t.name})}(t,a,o);$s(t,a)}}catch(s){if(s instanceof Pi)throw s;$s(t,"network-request-failed")}}async function lr(t,e,n,i,s={}){const r=await cr(t,e,n,i,s);return"mfaPendingCredential"in r&&$s(t,"multi-factor-auth-required",{_serverResponse:r}),r}function ur(t,e,n,i){const s=`${e}${n}?${i}`;return t.config.emulator?ir(t.config,s):`${t.config.apiScheme}://${s}`}class dr{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(qs(this.auth,"network-request-failed"))),or.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function fr(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const s=qs(t,e,i);return s.customData._tokenResponse=n,s}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function pr(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(e){}}function gr(t){return 1e3*Number(t)}function mr(t){var e;const[n,i,s]=t.split(".");if(void 0===n||void 0===i||void 0===s)return Ws("JWT malformed, contained fewer than 3 sections"),null;try{const t=function(t){try{return Ti.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null}(i);return t?JSON.parse(t):(Ws("Failed to decode base64 JWT payload"),null)}catch(r){return Ws("Caught error parsing JWT payload as JSON",null===(e=r)||void 0===e?void 0:e.toString()),null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function yr(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Pi&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}class vr{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){var t;try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===(t=e)||void 0===t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=pr(this.lastLoginAt),this.creationTime=pr(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _r(t){var e;const n=t.auth,i=await t.getIdToken(),s=await yr(t,async function(t,e){return cr(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));Gs(null==s?void 0:s.users.length,n,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const o=(null===(e=r.providerUserInfo)||void 0===e?void 0:e.length)?r.providerUserInfo.map((t=>{var{providerId:e}=t,n=gt(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const a=(c=t.providerData,h=o,[...c.filter((t=>!h.some((e=>e.providerId===t.providerId)))),...h]);var c,h;const l=t.isAnonymous,u=!(t.email&&r.passwordHash||(null==a?void 0:a.length)),d=!!l&&u,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new br(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(t,f)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class wr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Gs(t.idToken,"internal-error"),Gs(void 0!==t.idToken,"internal-error"),Gs(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=mr(t);return Gs(e,"internal-error"),Gs(void 0!==e.exp,"internal-error"),Gs(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return Gs(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:s}=await
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function(t,e){const n=await hr(t,{},(async()=>{const n=Fi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,r=ur(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",sr.fetch()(r,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:s}=e,r=new wr;return n&&(Gs("string"==typeof n,"internal-error",{appName:t}),r.refreshToken=n),i&&(Gs("string"==typeof i,"internal-error",{appName:t}),r.accessToken=i),s&&(Gs("number"==typeof s,"internal-error",{appName:t}),r.expirationTime=s),r}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new wr,this.toJSON())}_performRefresh(){return Ys("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xr(t,e){Gs("string"==typeof t||void 0===t,"internal-error",{appName:e})}class Sr{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,s=gt(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new vr(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new br(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const e=await yr(this,this.stsTokenManager.getToken(this.auth,t));return Gs(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=Hi(t),i=await n.getIdToken(e),s=mr(i);Gs(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const r="object"==typeof s.firebase?s.firebase:void 0,o=null==r?void 0:r.sign_in_provider;return{claims:s,token:i,authTime:pr(gr(s.auth_time)),issuedAtTime:pr(gr(s.iat)),expirationTime:pr(gr(s.exp)),signInProvider:o||null,signInSecondFactor:(null==r?void 0:r.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=Hi(t);await _r(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(Gs(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new Sr(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){Gs(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await _r(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await yr(this,async function(t,e){return cr(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,s,r,o,a,c,h;const l=null!==(n=e.displayName)&&void 0!==n?n:void 0,u=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(s=e.phoneNumber)&&void 0!==s?s:void 0,f=null!==(r=e.photoURL)&&void 0!==r?r:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,g=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=e.createdAt)&&void 0!==c?c:void 0,y=null!==(h=e.lastLoginAt)&&void 0!==h?h:void 0,{uid:v,emailVerified:b,isAnonymous:_,providerData:w,stsTokenManager:x}=e;Gs(v&&x,t,"internal-error");const S=wr.fromJSON(this.name,x);Gs("string"==typeof v,t,"internal-error"),xr(l,t.name),xr(u,t.name),Gs("boolean"==typeof b,t,"internal-error"),Gs("boolean"==typeof _,t,"internal-error"),xr(d,t.name),xr(f,t.name),xr(p,t.name),xr(g,t.name),xr(m,t.name),xr(y,t.name);const E=new Sr({uid:v,auth:t,email:u,emailVerified:b,displayName:l,isAnonymous:_,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:S,createdAt:m,lastLoginAt:y});return w&&Array.isArray(w)&&(E.providerData=w.map((t=>Object.assign({},t)))),g&&(E._redirectEventId=g),E}static async _fromIdTokenResponse(t,e,n=!1){const i=new wr;i.updateFromServerResponse(e);const s=new Sr({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await _r(s),s}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Er.type="NONE";const Tr=Er;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(t,e,n){return`firebase:${t}:${e}:${n}`}class Ir{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=kr(this.userKey,i.apiKey,s),this.fullPersistenceKey=kr("persistence",i.apiKey,s),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Sr._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new Ir(Js(Tr),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let s=i[0]||Js(Tr);const r=kr(n,t.config.apiKey,t.name);let o=null;for(const h of e)try{const e=await h._get(r);if(e){const n=Sr._fromJSON(t,e);h!==s&&(o=n),s=h;break}}catch(c){}const a=i.filter((t=>t._shouldAllowMigration));return s._shouldAllowMigration&&a.length?(s=a[0],o&&await s._set(r,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==s)try{await t._remove(r)}catch(c){}}))),new Ir(s,t,n)):new Ir(s,t,n)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Or(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ar(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Rr(e))return"Blackberry";if(Nr(e))return"Webos";if(Mr(e))return"Safari";if((e.includes("chrome/")||Dr(e))&&!e.includes("edge/"))return"Chrome";if(Pr(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Ar(t=Ci()){return/firefox\//i.test(t)}function Mr(t=Ci()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Dr(t=Ci()){return/crios\//i.test(t)}function Or(t=Ci()){return/iemobile/i.test(t)}function Pr(t=Ci()){return/android/i.test(t)}function Rr(t=Ci()){return/blackberry/i.test(t)}function Nr(t=Ci()){return/webos/i.test(t)}function Lr(t=Ci()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Vr(t=Ci()){return Lr(t)||Pr(t)||Nr(t)||Rr(t)||/windows phone/i.test(t)||Or(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Fr(t,e=[]){let n;switch(t){case"Browser":n=Cr(Ci());break;case"Worker":n=`${Cr(Ci())}-${t}`;break;default:n=t}return`${n}/JsCore/9.9.4/${e.length?e.join(","):"FirebaseCore-web"}`}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(s){i(s)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){var e;if(this.auth.currentUser===t)return;const n=[];try{for(const e of this.queue)await e(t),e.onAbort&&n.push(e.onAbort)}catch(i){n.reverse();for(const t of n)try{t()}catch(s){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===(e=i)||void 0===e?void 0:e.message})}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(t,e,n){this.app=t,this.heartbeatServiceProvider=e,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zr(this),this.idTokenSubscription=new zr(this),this.beforeStateQueue=new Ur(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=zs,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Js(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Ir.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(s){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(t,!0)):void 0}async initializeCurrentUser(t){var e;const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,r=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==r||!(null==o?void 0:o.user)||(i=o.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(r){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(r)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Gs(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(n){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){var e;try{await _r(t)}catch(n){if("auth/network-request-failed"!==(null===(e=n)||void 0===e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?Hi(t):null;return e&&Gs(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Gs(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(Js(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new Ri("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Js(t)||this._popupRedirectResolver;Gs(e,this,"argument-error"),this.redirectPersistenceManager=await Ir.create(this,[Js(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const s="function"==typeof e?e:e.next.bind(e),r=this._isInitialized?Promise.resolve():this._initializationPromise;return Gs(r,this,"internal-error"),r.then((()=>s(this.currentUser))),"function"==typeof e?t.addObserver(e,n,i):t.addObserver(e)}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Gs(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Fr(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());return n&&(e["X-Firebase-Client"]=n),e}}function Br(t){return Hi(t)}class zr{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new Bi(t,e);return n.subscribe.bind(n)}((t=>this.observer=t))}get next(){return Gs(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Ys("not implemented")}_getIdTokenResponse(t){return Ys("not implemented")}_linkToIdToken(t,e){return Ys("not implemented")}_getReauthenticationResolver(t){return Ys("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Wr extends Hr{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Wr(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new Wr(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return async function(t,e){return lr(t,"POST","/v1/accounts:signInWithPassword",ar(t,e))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return lr(t,"POST","/v1/accounts:signInWithEmailLink",ar(t,e))}(t,{email:this._email,oobCode:this._password});default:$s(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return async function(t,e){return cr(t,"POST","/v1/accounts:update",e)}(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return lr(t,"POST","/v1/accounts:signInWithEmailLink",ar(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:$s(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $r(t,e){return lr(t,"POST","/v1/accounts:signInWithIdp",ar(t,e))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr extends Hr{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new qr(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):$s("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,s=gt(e,["providerId","signInMethod"]);if(!n||!i)return null;const r=new qr(n,i);return r.idToken=s.idToken||void 0,r.accessToken=s.accessToken||void 0,r.secret=s.secret,r.nonce=s.nonce,r.pendingToken=s.pendingToken||null,r}_getIdTokenResponse(t){return $r(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,$r(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,$r(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=Fi(e)}return t}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(t){var e,n,i,s,r,o;const a=Ui(ji(t)),c=null!==(e=a.apiKey)&&void 0!==e?e:null,h=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Gs(c&&h&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=h,this.continueUrl=null!==(s=a.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(r=a.languageCode)&&void 0!==r?r:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=Ui(ji(t)).link,n=e?Ui(ji(e)).deep_link_id:null,i=Ui(ji(t)).deep_link_id;return(i?Ui(ji(i)).link:null)||i||n||e||t}(t);try{return new Kr(e)}catch(n){return null}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(){this.providerId=Gr.PROVIDER_ID}static credential(t,e){return Wr._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=Kr.parseLink(e);return Gs(n,"argument-error"),Wr._fromEmailAndCode(t,n.code,n.tenantId)}}Gr.PROVIDER_ID="password",Gr.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Gr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Yr{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr extends Yr{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr extends Xr{constructor(){super("facebook.com")}static credential(t){return qr._fromParams({providerId:Qr.PROVIDER_ID,signInMethod:Qr.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Qr.credentialFromTaggedObject(t)}static credentialFromError(t){return Qr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Qr.credential(t.oauthAccessToken)}catch(e){return null}}}Qr.FACEBOOK_SIGN_IN_METHOD="facebook.com",Qr.PROVIDER_ID="facebook.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Jr extends Xr{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return qr._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return Jr.credentialFromTaggedObject(t)}static credentialFromError(t){return Jr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return Jr.credential(e,n)}catch(i){return null}}}Jr.GOOGLE_SIGN_IN_METHOD="google.com",Jr.PROVIDER_ID="google.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Zr extends Xr{constructor(){super("github.com")}static credential(t){return qr._fromParams({providerId:Zr.PROVIDER_ID,signInMethod:Zr.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Zr.credentialFromTaggedObject(t)}static credentialFromError(t){return Zr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Zr.credential(t.oauthAccessToken)}catch(e){return null}}}Zr.GITHUB_SIGN_IN_METHOD="github.com",Zr.PROVIDER_ID="github.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class to extends Xr{constructor(){super("twitter.com")}static credential(t,e){return qr._fromParams({providerId:to.PROVIDER_ID,signInMethod:to.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return to.credentialFromTaggedObject(t)}static credentialFromError(t){return to.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return to.credential(e,n)}catch(i){return null}}}to.TWITTER_SIGN_IN_METHOD="twitter.com",to.PROVIDER_ID="twitter.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class eo{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const s=await Sr._fromIdTokenResponse(t,n,i),r=no(n);return new eo({user:s,providerId:r,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=no(n);return new eo({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function no(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io extends Pi{constructor(t,e,n,i){var s;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,io.prototype),this.customData={appName:t.name,tenantId:null!==(s=t.tenantId)&&void 0!==s?s:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new io(t,e,n,i)}}function so(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw io._fromErrorAndOperation(t,n,e,i);throw n}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function ro(t,e,n=!1){const i="signIn",s=await so(t,i,e),r=await eo._fromIdTokenResponse(t,i,s);return n||await t._updateCurrentUser(r.user),r}function oo(t,e,n){return async function(t,e){return ro(Br(t),e)}(Hi(t),Gr.credential(e,n))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ao(t,e){return Hi(t).setPersistence(e)}function co(t){return Hi(t).signOut()}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ho{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem("__sak","1"),this.storage.removeItem("__sak"),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo extends ho{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=Ci();return Mr(t)||Lr(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=Vr(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},s=this.storage.getItem(n);Oi()&&10===document.documentMode&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,10):i()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}lo.type="LOCAL";const uo=lo;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo extends ho{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}fo.type="SESSION";const po=fo;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class go{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new go(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:s}=e.data,r=this.handlersMap[i];if(!(null==r?void 0:r.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(r).map((async t=>t(e.origin,s))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function mo(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(10*Math.random());return t+n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */go.receivers=[];class yo{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,r;return new Promise(((o,a)=>{const c=mo("",20);i.port1.start();const h=setTimeout((()=>{a(new Error("unsupported_event"))}),n);r={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(h),s=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),o(e.data.response);break;default:clearTimeout(h),clearTimeout(s),a(new Error("invalid_response"))}}},this.handlers.add(r),i.port1.addEventListener("message",r.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])})).finally((()=>{r&&this.removeMessageHandler(r)}))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vo(){return window}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function bo(){return void 0!==vo().WorkerGlobalScope&&"function"==typeof vo().importScripts}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const _o="firebaseLocalStorageDb";class wo{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function xo(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly").objectStore("firebaseLocalStorage")}function So(){const t=indexedDB.open(_o,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(i){n(i)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains("firebaseLocalStorage")?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(_o);return new wo(t).toPromise()}(),e(await So()))}))}))}async function Eo(t,e,n){const i=xo(t,!0).put({fbase_key:e,value:n});return new wo(i).toPromise()}function To(t,e){const n=xo(t,!0).delete(e);return new wo(n).toPromise()}class ko{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await So()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(n){if(e++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return bo()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=go._getInstance(bo()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new yo(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await So();return await Eo(t,"__sak","1"),await To(t,"__sak"),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>Eo(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=xo(t,!1).get(e),i=await new wo(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>To(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=xo(t,!1).getAll();return new wo(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;for(const{fbase_key:i,value:s}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),e.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),e.push(i));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const i of Array.from(n))i(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}ko.type="LOCAL";const Io=ko;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Co(t){return new Promise(((e,n)=>{const i=document.createElement("script");var s,r;i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=qs("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",(null!==(r=null===(s=document.getElementsByTagName("head"))||void 0===s?void 0:s[0])&&void 0!==r?r:document).appendChild(i)}))}new nr(3e4,6e4);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ao extends Hr{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return $r(t,this._buildIdpRequest())}_linkToIdToken(t,e){return $r(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return $r(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Mo(t){return ro(t.auth,new Ao(t),t.bypassAuthState)}function Do(t){const{auth:e,user:n}=t;return Gs(n,e,"internal-error"),
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function(t,e,n=!1){var i;const{auth:s}=t,r="reauthenticate";try{const i=await yr(t,so(s,r,e,t),n);Gs(i.idToken,s,"internal-error");const o=mr(i.idToken);Gs(o,s,"internal-error");const{sub:a}=o;return Gs(t.uid===a,s,"user-mismatch"),eo._forOperation(t,r,i)}catch(o){throw"auth/user-not-found"===(null===(i=o)||void 0===i?void 0:i.code)&&$s(s,"user-mismatch"),o}}(n,new Ao(t),t.bypassAuthState)}async function Oo(t){const{auth:e,user:n}=t;return Gs(n,e,"internal-error"),async function(t,e,n=!1){const i=await yr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return eo._forOperation(t,"link",i)}(n,new Ao(t),t.bypassAuthState)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(t,e,n,i,s=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:s,error:r,type:o}=t;if(r)return void this.reject(r);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Mo;case"linkViaPopup":case"linkViaRedirect":return Oo;case"reauthViaPopup":case"reauthViaRedirect":return Do;default:$s(this.auth,"internal-error")}}resolve(t){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro=new nr(2e3,1e4);class No extends Po{constructor(t,e,n,i,s){super(t,e,i,s),this.provider=n,this.authWindow=null,this.pollId=null,No.currentPopupAction&&No.currentPopupAction.cancel(),No.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Gs(t,this.auth,"internal-error"),t}async onExecution(){Xs(1===this.filter.length,"Popup operations only handle one event");const t=mo();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(qs(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(qs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,No.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(qs(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(t,Ro.get())};t()}}No.currentPopupAction=null;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Lo=new Map;class Vo extends Po{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=Lo.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return kr("pendingRedirect",t.config.apiKey,t.name)}(e),i=function(t){return Js(t._redirectPersistence)}(t);if(!(await i._isAvailable()))return!1;const s="true"===await i._get(n);return await i._remove(n),s}(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(e)}catch(e){t=()=>Promise.reject(e)}Lo.set(this.auth._key(),t)}return this.bypassAuthState||Lo.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Fo(t,e){Lo.set(t._key(),e)}async function Uo(t,e,n=!1){const i=Br(t),s=
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(t,e){return e?Js(e):(Gs(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(i,e),r=new Vo(i,s,n),o=await r.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zo(t);default:return!1}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!zo(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(qs(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Bo(t))}saveEventToCache(t){this.cachedEventUids.add(Bo(t)),this.lastProcessedEventTime=Date.now()}}function Bo(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function zo({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Ho=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Wo=/^https?/;async function $o(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return cr(t,"GET","/v1/projects",e)}(t);for(const i of e)try{if(qo(i))return}catch(n){}$s(t,"unauthorized-domain")}function qo(t){const e=Zs(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return""===s.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===i}if(!Wo.test(n))return!1;if(Ho.test(t))return i===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ko=new nr(3e4,6e4);function Go(){const t=vo().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}function Yo(t){return new Promise(((e,n)=>{var i,s,r;function o(){Go(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Go(),n(qs(t,"network-request-failed"))},timeout:Ko.get()})}if(null===(s=null===(i=vo().gapi)||void 0===i?void 0:i.iframes)||void 0===s?void 0:s.Iframe)e(gapi.iframes.getContext());else{if(!(null===(r=vo().gapi)||void 0===r?void 0:r.load)){const e=`__${"iframefcb"}${Math.floor(1e6*Math.random())}`;return vo()[e]=()=>{gapi.load?o():n(qs(t,"network-request-failed"))},Co(`https://apis.google.com/js/api.js?onload=${e}`).catch((t=>n(t)))}o()}})).catch((t=>{throw Xo=null,t}))}let Xo=null;
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Qo=new nr(5e3,15e3),Jo={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Zo=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ta(t){const e=t.config;Gs(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ir(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,i={apiKey:e.apiKey,appName:t.name,v:"9.9.4"},s=Zo.get(t.config.apiHost);s&&(i.eid=s);const r=t._getFrameworks();return r.length&&(i.fw=r.join(",")),`${n}?${Fi(i).slice(1)}`}async function ea(t){const e=await function(t){return Xo=Xo||Yo(t),Xo}(t),n=vo().gapi;return Gs(n,t,"internal-error"),e.open({where:document.body,url:ta(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Jo,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const s=qs(t,"network-request-failed"),r=vo().setTimeout((()=>{i(s)}),Qo.get());function o(){vo().clearTimeout(r),n(e)}e.ping(o).then(o,(()=>{i(s)}))}))))}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ia{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function sa(t,e,n,i=500,s=600){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},na),{width:i.toString(),height:s.toString(),top:r,left:o}),h=Ci().toLowerCase();n&&(a=Dr(h)?"_blank":n),Ar(h)&&(e=e||"http://localhost",c.scrollbars="yes");const l=Object.entries(c).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=Ci()){var e;return Lr(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(h)&&"_self"!==a)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e||"",a),new ia(null);const u=window.open(e||"",a,l);Gs(u,t,"popup-blocked");try{u.focus()}catch(d){}return new ia(u)}function ra(t,e,n,i,s,r){Gs(t.config.authDomain,t,"auth-domain-config-required"),Gs(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:"9.9.4",eventId:s};if(e instanceof Yr){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(r||{}))o[t]=e}if(e instanceof Xr){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))void 0===a[c]&&delete a[c];return`${function({config:t}){if(!t.emulator)return`https://${t.authDomain}/__/auth/handler`;return ir(t,"emulator/auth/handler")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)}?${Fi(a).slice(1)}`}const oa=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=po,this._completeRedirectFn=Uo,this._overrideRedirectResult=Fo}async _openPopup(t,e,n,i){var s;Xs(null===(s=this.eventManagers[t._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");return sa(t,ra(t,e,n,Zs(),i),mo())}async _openRedirect(t,e,n,i){var s;return await this._originValidation(t),s=ra(t,e,n,Zs(),i),vo().location.href=s,new Promise((()=>{}))}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(Xs(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await ea(t),n=new jo(t);return e.register("authEvent",(e=>{Gs(null==e?void 0:e.authEvent,t,"invalid-auth-event");return{status:n.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send("webStorageSupport",{type:"webStorageSupport"},(n=>{var i;const s=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i.webStorageSupport;void 0!==s&&e(!!s),$s(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=$o(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Vr()||Mr()||Lr()}};var aa;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ca{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(t)}}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{var n;t((null===(n=e)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Gs(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ha(t=Cs()){const e=Es(t,"auth");return e.isInitialized()?e.getImmediate():function(t,e){const n=Es(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(Li(n.getOptions(),null!=e?e:{}))return t;$s(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:oa,persistence:[Io,uo,po]})}aa="Browser",Ss(new Wi("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),{apiKey:s,authDomain:r}=n.options;return((t,n)=>{Gs(s&&!s.includes(":"),"invalid-api-key",{appName:t.name}),Gs(!(null==r?void 0:r.includes(":")),"argument-error",{appName:t.name});const i={apiKey:s,authDomain:r,clientPlatform:aa,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Fr(aa)},o=new jr(t,n,i);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Js);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(o,e),o})(n,i)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),Ss(new Wi("auth-internal",(t=>{const e=Br(t.getProvider("auth").getImmediate());return new ca(e)}),"PRIVATE").setInstantiationMode("EXPLICIT")),As("@firebase/auth","0.20.6",function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(aa)),As("@firebase/auth","0.20.6","esm2017");var la,ua="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},da=da||{},fa=ua||self;function pa(){}function ga(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function ma(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ya="closure_uid_"+(1e9*Math.random()>>>0),va=0;function ba(t,e,n){return t.call.apply(t.bind,arguments)}function _a(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function wa(t,e,n){return(wa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ba:_a).apply(null,arguments)}function xa(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Sa(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,i){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return e.prototype[n].apply(t,s)}}function Ea(){this.s=this.s,this.o=this.o}Ea.prototype.s=!1,Ea.prototype.na=function(){var t;!this.s&&(this.s=!0,this.M(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,ya)&&t[ya]||(t[ya]=++va))},Ea.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ta=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},ka=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const i=t.length,s="string"==typeof t?t.split(""):t;for(let r=0;r<i;r++)r in s&&e.call(n,s[r],r,t)};function Ia(t){return Array.prototype.concat.apply([],arguments)}function Ca(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function Aa(t){return/^[\s\xa0]*$/.test(t)}var Ma,Da=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Oa(t,e){return-1!=t.indexOf(e)}function Pa(t,e){return t<e?-1:t>e?1:0}t:{var Ra=fa.navigator;if(Ra){var Na=Ra.userAgent;if(Na){Ma=Na;break t}}Ma=""}function La(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function Va(t){const e={};for(const n in t)e[n]=t[n];return e}var Fa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ua(t,e){let n,i;for(let s=1;s<arguments.length;s++){for(n in i=arguments[s],i)t[n]=i[n];for(let e=0;e<Fa.length;e++)n=Fa[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ja(t){return ja[" "](t),t}ja[" "]=pa;var Ba,za,Ha=Oa(Ma,"Opera"),Wa=Oa(Ma,"Trident")||Oa(Ma,"MSIE"),$a=Oa(Ma,"Edge"),qa=$a||Wa,Ka=Oa(Ma,"Gecko")&&!(Oa(Ma.toLowerCase(),"webkit")&&!Oa(Ma,"Edge"))&&!(Oa(Ma,"Trident")||Oa(Ma,"MSIE"))&&!Oa(Ma,"Edge"),Ga=Oa(Ma.toLowerCase(),"webkit")&&!Oa(Ma,"Edge");function Ya(){var t=fa.document;return t?t.documentMode:void 0}t:{var Xa="",Qa=(za=Ma,Ka?/rv:([^\);]+)(\)|;)/.exec(za):$a?/Edge\/([\d\.]+)/.exec(za):Wa?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(za):Ga?/WebKit\/(\S+)/.exec(za):Ha?/(?:Version)[ \/]?(\S+)/.exec(za):void 0);if(Qa&&(Xa=Qa?Qa[1]:""),Wa){var Ja=Ya();if(null!=Ja&&Ja>parseFloat(Xa)){Ba=String(Ja);break t}}Ba=Xa}var Za,tc={};function ec(){return function(t){var e=tc;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){let t=0;const e=Da(String(Ba)).split("."),n=Da("9").split("."),i=Math.max(e.length,n.length);for(let o=0;0==t&&o<i;o++){var s=e[o]||"",r=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],0==s[0].length&&0==r[0].length)break;t=Pa(0==s[1].length?0:parseInt(s[1],10),0==r[1].length?0:parseInt(r[1],10))||Pa(0==s[2].length,0==r[2].length)||Pa(s[2],r[2]),s=s[3],r=r[3]}while(0==t)}return 0<=t}))}if(fa.document&&Wa){var nc=Ya();Za=nc||(parseInt(Ba,10)||void 0)}else Za=void 0;var ic=Za,sc=function(){if(!fa.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{fa.addEventListener("test",pa,e),fa.removeEventListener("test",pa,e)}catch(n){}return t}();function rc(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function oc(t,e){if(rc.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Ka){t:{try{ja(e.nodeName);var s=!0;break t}catch(r){}s=!1}s||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ac[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&oc.Z.h.call(this)}}rc.prototype.h=function(){this.defaultPrevented=!0},Sa(oc,rc);var ac={2:"touch",3:"pen",4:"mouse"};oc.prototype.h=function(){oc.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var cc="closure_listenable_"+(1e6*Math.random()|0),hc=0;function lc(t,e,n,i,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ia=s,this.key=++hc,this.ca=this.fa=!1}function uc(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function dc(t){this.src=t,this.g={},this.h=0}function fc(t,e){var n=e.type;if(n in t.g){var i,s=t.g[n],r=Ta(s,e);(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(uc(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function pc(t,e,n,i){for(var s=0;s<t.length;++s){var r=t[s];if(!r.ca&&r.listener==e&&r.capture==!!n&&r.ia==i)return s}return-1}dc.prototype.add=function(t,e,n,i,s){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var o=pc(t,e,i,s);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new lc(e,this.src,r,!!i,s)).fa=n,t.push(e)),e};var gc="closure_lm_"+(1e6*Math.random()|0),mc={};function yc(t,e,n,i,s){if(i&&i.once)return bc(t,e,n,i,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)yc(t,e[r],n,i,s);return null}return n=kc(n),t&&t[cc]?t.N(e,n,ma(i)?!!i.capture:!!i,s):vc(t,e,n,!1,i,s)}function vc(t,e,n,i,s,r){if(!e)throw Error("Invalid event type");var o=ma(s)?!!s.capture:!!s,a=Ec(t);if(a||(t[gc]=a=new dc(t)),(n=a.add(e,n,i,o,r)).proxy)return n;if(i=function(){function t(n){return e.call(t.src,t.listener,n)}var e=Sc;return t}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)sc||(s=o),void 0===s&&(s=!1),t.addEventListener(e.toString(),i,s);else if(t.attachEvent)t.attachEvent(xc(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function bc(t,e,n,i,s){if(Array.isArray(e)){for(var r=0;r<e.length;r++)bc(t,e[r],n,i,s);return null}return n=kc(n),t&&t[cc]?t.O(e,n,ma(i)?!!i.capture:!!i,s):vc(t,e,n,!0,i,s)}function _c(t,e,n,i,s){if(Array.isArray(e))for(var r=0;r<e.length;r++)_c(t,e[r],n,i,s);else i=ma(i)?!!i.capture:!!i,n=kc(n),t&&t[cc]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=pc(r=t.g[e],n,i,s))&&(uc(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete t.g[e],t.h--)))):t&&(t=Ec(t))&&(e=t.g[e.toString()],t=-1,e&&(t=pc(e,n,i,s)),(n=-1<t?e[t]:null)&&wc(n))}function wc(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[cc])fc(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(xc(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Ec(e))?(fc(n,t),0==n.h&&(n.src=null,e[gc]=null)):uc(t)}}}function xc(t){return t in mc?mc[t]:mc[t]="on"+t}function Sc(t,e){if(t.ca)t=!0;else{e=new oc(e,this);var n=t.listener,i=t.ia||t.src;t.fa&&wc(t),t=n.call(i,e)}return t}function Ec(t){return(t=t[gc])instanceof dc?t:null}var Tc="__closure_events_fn_"+(1e9*Math.random()>>>0);function kc(t){return"function"==typeof t?t:(t[Tc]||(t[Tc]=function(e){return t.handleEvent(e)}),t[Tc])}function Ic(){Ea.call(this),this.i=new dc(this),this.P=this,this.I=null}function Cc(t,e){var n,i=t.I;if(i)for(n=[];i;i=i.I)n.push(i);if(t=t.P,i=e.type||e,"string"==typeof e)e=new rc(e,t);else if(e instanceof rc)e.target=e.target||t;else{var s=e;Ua(e=new rc(i,t),s)}if(s=!0,n)for(var r=n.length-1;0<=r;r--){var o=e.g=n[r];s=Ac(o,i,!0,e)&&s}if(s=Ac(o=e.g=t,i,!0,e)&&s,s=Ac(o,i,!1,e)&&s,n)for(r=0;r<n.length;r++)s=Ac(o=e.g=n[r],i,!1,e)&&s}function Ac(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&fc(t.i,o),s=!1!==a.call(c,i)&&s}}return s&&!i.defaultPrevented}Sa(Ic,Ea),Ic.prototype[cc]=!0,Ic.prototype.removeEventListener=function(t,e,n,i){_c(this,t,e,n,i)},Ic.prototype.M=function(){if(Ic.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)uc(n[i]);delete e.g[t],e.h--}}this.I=null},Ic.prototype.N=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},Ic.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var Mc=fa.JSON.stringify;function Dc(){var t=Fc;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Oc,Pc=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Rc),(t=>t.reset()));class Rc{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Nc(t){fa.setTimeout((()=>{throw t}),0)}function Lc(t,e){Oc||function(){var t=fa.Promise.resolve(void 0);Oc=function(){t.then(Uc)}}(),Vc||(Oc(),Vc=!0),Fc.add(t,e)}var Vc=!1,Fc=new class{constructor(){this.h=this.g=null}add(t,e){const n=Pc.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function Uc(){for(var t;t=Dc();){try{t.h.call(t.g)}catch(n){Nc(n)}var e=Pc;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Vc=!1}function jc(t,e){Ic.call(this),this.h=t||1,this.g=e||fa,this.j=wa(this.kb,this),this.l=Date.now()}function Bc(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function zc(t,e,n){if("function"==typeof t)n&&(t=wa(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=wa(t.handleEvent,t)}return 2147483647<Number(e)?-1:fa.setTimeout(t,e||0)}function Hc(t){t.g=zc((()=>{t.g=null,t.i&&(t.i=!1,Hc(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Sa(jc,Ic),(la=jc.prototype).da=!1,la.S=null,la.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Cc(this,"tick"),this.da&&(Bc(this),this.start()))}},la.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},la.M=function(){jc.Z.M.call(this),Bc(this),delete this.g};class Wc extends Ea{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Hc(this)}M(){super.M(),this.g&&(fa.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $c(t){Ea.call(this),this.h=t,this.g={}}Sa($c,Ea);var qc=[];function Kc(t,e,n,i){Array.isArray(n)||(n&&(qc[0]=n.toString()),n=qc);for(var s=0;s<n.length;s++){var r=yc(e,n[s],i||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function Gc(t){La(t.g,(function(t,e){this.g.hasOwnProperty(e)&&wc(t)}),t),t.g={}}function Yc(){this.g=!0}function Xc(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<s.length;o++)s[o]=""}}}return Mc(n)}catch(a){return e}}(t,n)+(i?" "+i:"")}))}$c.prototype.M=function(){$c.Z.M.call(this),Gc(this)},$c.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Yc.prototype.Aa=function(){this.g=!1},Yc.prototype.info=function(){};var Qc={},Jc=null;function Zc(){return Jc=Jc||new Ic}function th(t){rc.call(this,Qc.Ma,t)}function eh(t){const e=Zc();Cc(e,new th(e))}function nh(t,e){rc.call(this,Qc.STAT_EVENT,t),this.stat=e}function ih(t){const e=Zc();Cc(e,new nh(e,t))}function sh(t,e){rc.call(this,Qc.Na,t),this.size=e}function rh(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return fa.setTimeout((function(){t()}),e)}Qc.Ma="serverreachability",Sa(th,rc),Qc.STAT_EVENT="statevent",Sa(nh,rc),Qc.Na="timingevent",Sa(sh,rc);var oh={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},ah={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function ch(){}function hh(t){return t.h||(t.h=t.i())}function lh(){}ch.prototype.h=null;var uh,dh={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function fh(){rc.call(this,"d")}function ph(){rc.call(this,"c")}function gh(){}function mh(t,e,n,i){this.l=t,this.j=e,this.m=n,this.X=i||1,this.V=new $c(this),this.P=vh,t=qa?125:void 0,this.W=new jc(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new yh}function yh(){this.i=null,this.g="",this.h=!1}Sa(fh,rc),Sa(ph,rc),Sa(gh,ch),gh.prototype.g=function(){return new XMLHttpRequest},gh.prototype.i=function(){return{}},uh=new gh;var vh=45e3,bh={},_h={};function wh(t,e,n){t.K=1,t.v=Wh(Fh(e)),t.s=n,t.U=!0,xh(t,null)}function xh(t,e){t.F=Date.now(),kh(t),t.A=Fh(t.v);var n=t.A,i=t.X;Array.isArray(i)||(i=[String(i)]),il(n.h,"t",i),t.C=0,n=t.l.H,t.h=new yh,t.g=iu(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Wc(wa(t.Ia,t,t.g),t.O)),Kc(t.V,t.g,"readystatechange",t.gb),e=t.H?Va(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),eh(),function(t,e,n,i,s,r){t.info((function(){if(t.g)if(r)for(var o="",a=r.split("&"),c=0;c<a.length;c++){var h=a[c].split("=");if(1<h.length){var l=h[0];h=h[1];var u=l.split("_");o=2<=u.length&&"type"==u[1]?o+(l+"=")+h+"&":o+(l+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Sh(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Eh(t,e,n){let i,s=!0;for(;!t.I&&t.C<n.length;){if(i=Th(t,n),i==_h){4==e&&(t.o=4,ih(14),s=!1),Xc(t.j,t.m,null,"[Incomplete Response]");break}if(i==bh){t.o=4,ih(15),Xc(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}Xc(t.j,t.m,i,null),Dh(t,i)}Sh(t)&&i!=_h&&i!=bh&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,ih(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Yl(e),e.L=!0,ih(11))):(Xc(t.j,t.m,n,"[Invalid Chunked Response]"),Mh(t),Ah(t))}function Th(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?_h:(n=Number(e.substring(n,i)),isNaN(n)?bh:(i+=1)+n>e.length?_h:(e=e.substr(i,n),t.C=i+n,e))}function kh(t){t.Y=Date.now()+t.P,Ih(t,t.P)}function Ih(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=rh(wa(t.eb,t),e)}function Ch(t){t.B&&(fa.clearTimeout(t.B),t.B=null)}function Ah(t){0==t.l.G||t.I||Jl(t.l,t)}function Mh(t){Ch(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Bc(t.W),Gc(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Dh(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||hl(n.i,t)))if(n.I=t.N,!t.J&&hl(n.i,t)&&3==n.G){try{var i=n.Ca.g.parse(e)}catch(h){i=null}if(Array.isArray(i)&&3==i.length){var s=i;if(0==s[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Ql(n),jl(n)}Gl(n),ih(18)}}else n.ta=s[1],0<n.ta-n.U&&37500>s[2]&&n.N&&0==n.A&&!n.v&&(n.v=rh(wa(n.ab,n),6e3));if(1>=cl(n.i)&&n.ka){try{n.ka()}catch(h){}n.ka=void 0}}else tu(n,11)}else if((t.J||n.g==t)&&Ql(n),!Aa(e))for(s=n.Ca.g.parse(e),e=0;e<s.length;e++){let h=s[e];if(n.U=h[0],h=h[1],2==n.G)if("c"==h[0]){n.J=h[1],n.la=h[2];const e=h[3];null!=e&&(n.ma=e,n.h.info("VER="+n.ma));const s=h[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));const l=h[5];null!=l&&"number"==typeof l&&0<l&&(i=1.5*l,n.K=i,n.h.info("backChannelRequestTimeoutMs_="+i)),i=n;const u=t.g;if(u){const t=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=i.i;!r.g&&(Oa(t,"spdy")||Oa(t,"quic")||Oa(t,"h2"))&&(r.j=r.l,r.g=new Set,r.h&&(ll(r,r.h),r.h=null))}if(i.D){const t=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.sa=t,Hh(i.F,i.D,t))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=t;if((i=n).oa=nu(i,i.H?i.la:null,i.W),o.J){ul(i.i,o);var a=o,c=i.K;c&&a.setTimeout(c),a.B&&(Ch(a),kh(a)),i.g=o}else Kl(i);0<n.l.length&&Hl(n)}else"stop"!=h[0]&&"close"!=h[0]||tu(n,7);else 3==n.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?tu(n,7):Ul(n):"noop"!=h[0]&&n.j&&n.j.wa(h),n.A=0)}eh()}catch(h){}}function Oh(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(ga(t)||"string"==typeof t)ka(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(ga(t)||"string"==typeof t){n=[];for(var i=t.length,s=0;s<i;s++)n.push(s)}else for(s in n=[],i=0,t)n[i++]=s;s=(i=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(ga(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var r=0;r<s;r++)e.call(void 0,i[r],n&&n[r],t)}}function Ph(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Ph)for(n=t.T(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Rh(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var i=t.g[e];Nh(t.h,i)&&(t.g[n++]=i),e++}t.g.length=n}if(t.i!=t.g.length){var s={};for(n=e=0;e<t.g.length;)Nh(s,i=t.g[e])||(t.g[n++]=i,s[i]=1),e++;t.g.length=n}}function Nh(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(la=mh.prototype).setTimeout=function(t){this.P=t},la.gb=function(t){t=t.target;const e=this.L;e&&3==Rl(t)?e.l():this.Ia(t)},la.Ia=function(t){try{if(t==this.g)t:{const l=Rl(this.g);var e=this.g.Da();this.g.ba();if(!(3>l)&&(3!=l||qa||this.g&&(this.h.h||this.g.ga()||Nl(this.g)))){this.I||4!=l||7==e||eh(),Ch(this);var n=this.g.ba();this.N=n;e:if(Sh(this)){var i=Nl(this.g);t="";var s=i.length,r=4==Rl(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Mh(this),Ah(this);var o="";break e}this.h.i=new fa.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:r&&e==s-1});i.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(t,e,n,i,s,r,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+e+"\n"+n+"\n"+r+" "+o}))}(this.j,this.u,this.A,this.m,this.X,l,n),this.i){if(this.$&&!this.J){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Aa(a)){var h=a;break e}}h=null}if(!(n=h)){this.i=!1,this.o=3,ih(12),Mh(this),Ah(this);break t}Xc(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Dh(this,n)}this.U?(Eh(this,l,o),qa&&this.i&&3==l&&(Kc(this.V,this.W,"tick",this.fb),this.W.start())):(Xc(this.j,this.m,o,null),Dh(this,o)),4==l&&Mh(this),this.i&&!this.I&&(4==l?Jl(this.l,this):(this.i=!1,kh(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,ih(12)):(this.o=0,ih(13)),Mh(this),Ah(this)}}}catch(l){}},la.fb=function(){if(this.g){var t=Rl(this.g),e=this.g.ga();this.C<e.length&&(Ch(this),Eh(this,t,e),this.i&&4!=t&&kh(this))}},la.cancel=function(){this.I=!0,Mh(this)},la.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(eh(),ih(17)),Mh(this),this.o=2,Ah(this)):Ih(this,this.Y-t)},(la=Ph.prototype).R=function(){Rh(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},la.T=function(){return Rh(this),this.g.concat()},la.get=function(t,e){return Nh(this.h,t)?this.h[t]:e},la.set=function(t,e){Nh(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},la.forEach=function(t,e){for(var n=this.T(),i=0;i<n.length;i++){var s=n[i],r=this.get(s);t.call(e,r,s,this)}};var Lh=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Vh(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Vh){this.g=void 0!==e?e:t.g,Uh(this,t.j),this.s=t.s,jh(this,t.i),Bh(this,t.m),this.l=t.l,e=t.h;var n=new Zh;n.i=e.i,e.g&&(n.g=new Ph(e.g),n.h=e.h),zh(this,n),this.o=t.o}else t&&(n=String(t).match(Lh))?(this.g=!!e,Uh(this,n[1]||"",!0),this.s=$h(n[2]||""),jh(this,n[3]||"",!0),Bh(this,n[4]),this.l=$h(n[5]||"",!0),zh(this,n[6]||"",!0),this.o=$h(n[7]||"")):(this.g=!!e,this.h=new Zh(null,this.g))}function Fh(t){return new Vh(t)}function Uh(t,e,n){t.j=n?$h(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function jh(t,e,n){t.i=n?$h(e,!0):e}function Bh(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function zh(t,e,n){e instanceof Zh?(t.h=e,function(t,e){e&&!t.j&&(tl(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(el(this,e),il(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=qh(e,Qh)),t.h=new Zh(e,t.g))}function Hh(t,e,n){t.h.set(e,n)}function Wh(t){return Hh(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function $h(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function qh(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Kh),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Kh(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Vh.prototype.toString=function(){var t=[],e=this.j;e&&t.push(qh(e,Gh,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(qh(e,Gh,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(qh(n,"/"==n.charAt(0)?Xh:Yh,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",qh(n,Jh)),t.join("")};var Gh=/[#\/\?@]/g,Yh=/[#\?:]/g,Xh=/[#\?]/g,Qh=/[#\?@]/g,Jh=/#/g;function Zh(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function tl(t){t.g||(t.g=new Ph,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),s=null;if(0<=i){var r=t[n].substring(0,i);s=t[n].substring(i+1)}else r=t[n];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function el(t,e){tl(t),e=sl(t,e),Nh(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Nh((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Rh(t)))}function nl(t,e){return tl(t),e=sl(t,e),Nh(t.g.h,e)}function il(t,e,n){el(t,e),0<n.length&&(t.i=null,t.g.set(sl(t,e),Ca(n)),t.h+=n.length)}function sl(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(la=Zh.prototype).add=function(t,e){tl(this),this.i=null,t=sl(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},la.forEach=function(t,e){tl(this),this.g.forEach((function(n,i){ka(n,(function(n){t.call(e,n,i,this)}),this)}),this)},la.T=function(){tl(this);for(var t=this.g.R(),e=this.g.T(),n=[],i=0;i<e.length;i++)for(var s=t[i],r=0;r<s.length;r++)n.push(e[i]);return n},la.R=function(t){tl(this);var e=[];if("string"==typeof t)nl(this,t)&&(e=Ia(e,this.g.get(sl(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=Ia(e,t[n])}return e},la.set=function(t,e){return tl(this),this.i=null,nl(this,t=sl(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},la.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},la.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var i=e[n],s=encodeURIComponent(String(i));i=this.R(i);for(var r=0;r<i.length;r++){var o=s;""!==i[r]&&(o+="="+encodeURIComponent(String(i[r]))),t.push(o)}}return this.i=t.join("&")};function rl(t){this.l=t||ol,fa.PerformanceNavigationTiming?t=0<(t=fa.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(fa.g&&fa.g.Ea&&fa.g.Ea()&&fa.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var ol=10;function al(t){return!!t.h||!!t.g&&t.g.size>=t.j}function cl(t){return t.h?1:t.g?t.g.size:0}function hl(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function ll(t,e){t.g?t.g.add(e):t.h=e}function ul(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function dl(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return Ca(t.i)}function fl(){}function pl(){this.g=new fl}function gl(t,e,n){const i=n||"";try{Oh(t,(function(t,n){let s=t;ma(t)&&(s=Mc(t)),e.push(i+n+"="+encodeURIComponent(s))}))}catch(s){throw e.push(i+"type="+encodeURIComponent("_badmap")),s}}function ml(t,e,n,i,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(i)}catch(r){}}function yl(t){this.l=t.$b||null,this.j=t.ib||!1}function vl(t,e){Ic.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=bl,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}rl.prototype.cancel=function(){if(this.i=dl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},fl.prototype.stringify=function(t){return fa.JSON.stringify(t,void 0)},fl.prototype.parse=function(t){return fa.JSON.parse(t,void 0)},Sa(yl,ch),yl.prototype.g=function(){return new vl(this.l,this.j)},yl.prototype.i=function(t){return function(){return t}}({}),Sa(vl,Ic);var bl=0;function _l(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function wl(t){t.readyState=4,t.l=null,t.j=null,t.A=null,xl(t)}function xl(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(la=vl.prototype).open=function(t,e){if(this.readyState!=bl)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,xl(this)},la.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||fa).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},la.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,wl(this)),this.readyState=bl},la.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,xl(this)),this.g&&(this.readyState=3,xl(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==fa.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;_l(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},la.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?wl(this):xl(this),3==this.readyState&&_l(this)}},la.Ua=function(t){this.g&&(this.response=this.responseText=t,wl(this))},la.Ta=function(t){this.g&&(this.response=t,wl(this))},la.ha=function(){this.g&&wl(this)},la.setRequestHeader=function(t,e){this.v.append(t,e)},la.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},la.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(vl.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Sl=fa.JSON.parse;function El(t){Ic.call(this),this.headers=new Ph,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Tl,this.K=this.L=!1}Sa(El,Ic);var Tl="",kl=/^https?$/i,Il=["POST","PUT"];function Cl(t){return"content-type"==t.toLowerCase()}function Al(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ml(t),Ol(t)}function Ml(t){t.D||(t.D=!0,Cc(t,"complete"),Cc(t,"error"))}function Dl(t){if(t.h&&void 0!==da&&(!t.C[1]||4!=Rl(t)||2!=t.ba()))if(t.v&&4==Rl(t))zc(t.Fa,0,t);else if(Cc(t,"readystatechange"),4==Rl(t)){t.h=!1;try{const c=t.ba();t:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===c){var s=String(t.H).match(Lh)[1]||null;if(!s&&fa.self&&fa.self.location){var r=fa.self.location.protocol;s=r.substr(0,r.length-1)}i=!kl.test(s?s.toLowerCase():"")}n=i}if(n)Cc(t,"complete"),Cc(t,"success");else{t.m=6;try{var o=2<Rl(t)?t.g.statusText:""}catch(a){o=""}t.j=o+" ["+t.ba()+"]",Ml(t)}}finally{Ol(t)}}}function Ol(t,e){if(t.g){Pl(t);const i=t.g,s=t.C[0]?pa:null;t.g=null,t.C=null,e||Cc(t,"ready");try{i.onreadystatechange=s}catch(n){}}}function Pl(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(fa.clearTimeout(t.A),t.A=null)}function Rl(t){return t.g?t.g.readyState:0}function Nl(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Tl:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Ll(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=function(t){let e="";return La(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Hh(t,e,n))}function Vl(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Fl(t){this.za=0,this.l=[],this.h=new Yc,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Vl("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Vl("baseRetryDelayMs",5e3,t),this.$a=Vl("retryDelaySeedMs",1e4,t),this.Ya=Vl("forwardChannelMaxRetries",2,t),this.ra=Vl("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new rl(t&&t.concurrentRequestLimit),this.Ca=new pl,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Ul(t){if(Bl(t),3==t.G){var e=t.V++,n=Fh(t.F);Hh(n,"SID",t.J),Hh(n,"RID",e),Hh(n,"TYPE","terminate"),$l(t,n),(e=new mh(t,t.h,e,void 0)).K=2,e.v=Wh(Fh(n)),n=!1,fa.navigator&&fa.navigator.sendBeacon&&(n=fa.navigator.sendBeacon(e.v.toString(),"")),!n&&fa.Image&&((new Image).src=e.v,n=!0),n||(e.g=iu(e.l,null),e.g.ea(e.v)),e.F=Date.now(),kh(e)}eu(t)}function jl(t){t.g&&(Yl(t),t.g.cancel(),t.g=null)}function Bl(t){jl(t),t.u&&(fa.clearTimeout(t.u),t.u=null),Ql(t),t.i.cancel(),t.m&&("number"==typeof t.m&&fa.clearTimeout(t.m),t.m=null)}function zl(t,e){t.l.push(new class{constructor(t,e){this.h=t,this.g=e}}(t.Za++,e)),3==t.G&&Hl(t)}function Hl(t){al(t.i)||t.m||(t.m=!0,Lc(t.Ha,t),t.C=0)}function Wl(t,e){var n;n=e?e.m:t.V++;const i=Fh(t.F);Hh(i,"SID",t.J),Hh(i,"RID",n),Hh(i,"AID",t.U),$l(t,i),t.o&&t.s&&Ll(i,t.o,t.s),n=new mh(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=ql(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),ll(t.i,n),wh(n,i,e)}function $l(t,e){t.j&&Oh({},(function(t,n){Hh(e,n,t)}))}function ql(t,e,n){n=Math.min(t.l.length,n);var i=t.j?wa(t.j.Oa,t.j,t):null;t:{var s=t.l;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=s[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let o=!0;for(let a=0;a<n;a++){let n=s[a].h;const c=s[a].g;if(n-=e,0>n)e=Math.max(0,s[a].h-100),o=!1;else try{gl(c,t,"req"+n+"_")}catch(r){i&&i(c)}}if(o){i=t.join("&");break t}}}return t=t.l.splice(0,n),e.D=t,i}function Kl(t){t.g||t.u||(t.Y=1,Lc(t.Ga,t),t.A=0)}function Gl(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=rh(wa(t.Ga,t),Zl(t,t.A)),t.A++,!0)}function Yl(t){null!=t.B&&(fa.clearTimeout(t.B),t.B=null)}function Xl(t){t.g=new mh(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Fh(t.oa);Hh(e,"RID","rpc"),Hh(e,"SID",t.J),Hh(e,"CI",t.N?"0":"1"),Hh(e,"AID",t.U),$l(t,e),Hh(e,"TYPE","xmlhttp"),t.o&&t.s&&Ll(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Wh(Fh(e)),n.s=null,n.U=!0,xh(n,t)}function Ql(t){null!=t.v&&(fa.clearTimeout(t.v),t.v=null)}function Jl(t,e){var n=null;if(t.g==e){Ql(t),Yl(t),t.g=null;var i=2}else{if(!hl(t.i,e))return;n=e.D,ul(t.i,e),i=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;Cc(i=Zc(),new sh(i,n)),Hl(t)}else Kl(t);else if(3==(s=e.o)||0==s&&0<t.I||!(1==i&&function(t,e){return!(cl(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=rh(wa(t.Ha,t,e),Zl(t,t.C)),t.C++,0)))}(t,e)||2==i&&Gl(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:tu(t,5);break;case 4:tu(t,10);break;case 3:tu(t,6);break;default:tu(t,2)}}function Zl(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function tu(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var i=wa(t.jb,t);n||(n=new Vh("//www.google.com/images/cleardot.gif"),fa.location&&"http"==fa.location.protocol||Uh(n,"https"),Wh(n)),function(t,e){const n=new Yc;if(fa.Image){const i=new Image;i.onload=xa(ml,n,i,"TestLoadImage: loaded",!0,e),i.onerror=xa(ml,n,i,"TestLoadImage: error",!1,e),i.onabort=xa(ml,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=xa(ml,n,i,"TestLoadImage: timeout",!1,e),fa.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else ih(2);t.G=0,t.j&&t.j.va(e),eu(t),Bl(t)}function eu(t){t.G=0,t.I=-1,t.j&&(0==dl(t.i).length&&0==t.l.length||(t.i.i.length=0,Ca(t.l),t.l.length=0),t.j.ua())}function nu(t,e,n){let i=function(t){return t instanceof Vh?Fh(t):new Vh(t,void 0)}(n);if(""!=i.i)e&&jh(i,e+"."+i.i),Bh(i,i.m);else{const t=fa.location;i=function(t,e,n,i){var s=new Vh(null,void 0);return t&&Uh(s,t),e&&jh(s,e),n&&Bh(s,n),i&&(s.l=i),s}(t.protocol,e?e+"."+t.hostname:t.hostname,+t.port,n)}return t.aa&&La(t.aa,(function(t,e){Hh(i,e,t)})),e=t.D,n=t.sa,e&&n&&Hh(i,e,n),Hh(i,"VER",t.ma),$l(t,i),i}function iu(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new El(new yl({ib:!0})):new El(t.qa)).L=t.H,e}function su(){}function ru(){if(Wa&&!(10<=Number(ic)))throw Error("Environmental error: no available transport.")}function ou(t,e){Ic.call(this),this.g=new Fl(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Aa(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Aa(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new hu(this)}function au(t){fh.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function cu(){ph.call(this),this.status=1}function hu(t){this.g=t}(la=El.prototype).ea=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():uh.g(),this.C=this.u?hh(this.u):hh(uh),this.g.onreadystatechange=wa(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(r){return void Al(this,r)}t=n||"";const s=new Ph(this.headers);i&&Oh(i,(function(t,e){s.set(e,t)})),i=function(t){t:{var e=Cl;const n=t.length,i="string"==typeof t?t.split(""):t;for(let s=0;s<n;s++)if(s in i&&e.call(void 0,i[s],s,t)){e=s;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(s.T()),n=fa.FormData&&t instanceof fa.FormData,!(0<=Ta(Il,e))||i||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Pl(this),0<this.B&&((this.K=function(t){return Wa&&ec()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=wa(this.pa,this)):this.A=zc(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(r){Al(this,r)}},la.pa=function(){void 0!==da&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Cc(this,"timeout"),this.abort(8))},la.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Cc(this,"complete"),Cc(this,"abort"),Ol(this))},la.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ol(this,!0)),El.Z.M.call(this)},la.Fa=function(){this.s||(this.F||this.v||this.l?Dl(this):this.cb())},la.cb=function(){Dl(this)},la.ba=function(){try{return 2<Rl(this)?this.g.status:-1}catch(za){return-1}},la.ga=function(){try{return this.g?this.g.responseText:""}catch(za){return""}},la.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Sl(e)}},la.Da=function(){return this.m},la.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(la=Fl.prototype).ma=8,la.G=1,la.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(e){}},la.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new mh(this,this.h,t,void 0);let r=this.s;if(this.P&&(r?(r=Va(r),Ua(r,this.P)):r=this.P),null===this.o&&(s.H=r),this.ja)t:{for(var e=0,n=0;n<this.l.length;n++){var i=this.l[n];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.l.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=ql(this,s,e),Hh(n=Fh(this.F),"RID",t),Hh(n,"CVER",22),this.D&&Hh(n,"X-HTTP-Session-Id",this.D),$l(this,n),this.o&&r&&Ll(n,this.o,r),ll(this.i,s),this.Ra&&Hh(n,"TYPE","init"),this.ja?(Hh(n,"$req",e),Hh(n,"SID","null"),s.$=!0,wh(s,n,null)):wh(s,n,e),this.G=2}}else 3==this.G&&(t?Wl(this,t):0==this.l.length||al(this.i)||Wl(this))},la.Ga=function(){if(this.u=null,Xl(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=rh(wa(this.bb,this),t)}},la.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ih(10),jl(this),Xl(this))},la.ab=function(){null!=this.v&&(this.v=null,jl(this),Gl(this),ih(19))},la.jb=function(t){t?(this.h.info("Successfully pinged google.com"),ih(2)):(this.h.info("Failed to ping google.com"),ih(1))},(la=su.prototype).xa=function(){},la.wa=function(){},la.va=function(){},la.ua=function(){},la.Oa=function(){},ru.prototype.g=function(t,e){return new ou(t,e)},Sa(ou,Ic),ou.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Lc(wa(t.hb,t,e))),ih(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=nu(t,null,t.W),Hl(t)},ou.prototype.close=function(){Ul(this.g)},ou.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,zl(this.g,e)}else this.v?((e={}).__data__=Mc(t),zl(this.g,e)):zl(this.g,t)},ou.prototype.M=function(){this.g.j=null,delete this.j,Ul(this.g),delete this.g,ou.Z.M.call(this)},Sa(au,fh),Sa(cu,ph),Sa(hu,su),hu.prototype.xa=function(){Cc(this.g,"a")},hu.prototype.wa=function(t){Cc(this.g,new au(t))},hu.prototype.va=function(t){Cc(this.g,new cu)},hu.prototype.ua=function(){Cc(this.g,"b")},ru.prototype.createWebChannel=ru.prototype.g,ou.prototype.send=ou.prototype.u,ou.prototype.open=ou.prototype.m,ou.prototype.close=ou.prototype.close,oh.NO_ERROR=0,oh.TIMEOUT=8,oh.HTTP_ERROR=6,ah.COMPLETE="complete",lh.EventType=dh,dh.OPEN="a",dh.CLOSE="b",dh.ERROR="c",dh.MESSAGE="d",Ic.prototype.listen=Ic.prototype.N,El.prototype.listenOnce=El.prototype.O,El.prototype.getLastError=El.prototype.La,El.prototype.getLastErrorCode=El.prototype.Da,El.prototype.getStatus=El.prototype.ba,El.prototype.getResponseJson=El.prototype.Qa,El.prototype.getResponseText=El.prototype.ga,El.prototype.send=El.prototype.ea;var lu=oh,uu=ah,du=Qc,fu=10,pu=11,gu=yl,mu=lh,yu=El;const vu="@firebase/firestore";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}bu.UNAUTHENTICATED=new bu(null),bu.GOOGLE_CREDENTIALS=new bu("google-credentials-uid"),bu.FIRST_PARTY=new bu("first-party-uid"),bu.MOCK_USER=new bu("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let _u="9.9.4";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wu=new Zi("@firebase/firestore");function xu(){return wu.logLevel}function Su(t,...e){if(wu.logLevel<=Ki.DEBUG){const n=e.map(ku);wu.debug(`Firestore (${_u}): ${t}`,...n)}}function Eu(t,...e){if(wu.logLevel<=Ki.ERROR){const n=e.map(ku);wu.error(`Firestore (${_u}): ${t}`,...n)}}function Tu(t,...e){if(wu.logLevel<=Ki.WARN){const n=e.map(ku);wu.warn(`Firestore (${_u}): ${t}`,...n)}}function ku(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(n){return t}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(t="Unexpected state"){const e=`FIRESTORE (${_u}) INTERNAL ASSERTION FAILED: `+t;throw Eu(e),new Error(e)}function Cu(t,e){t||Iu()}function Au(t,e){return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mu={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Du extends Pi{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Ru{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(bu.UNAUTHENTICATED)))}shutdown(){}}class Nu{constructor(t){this.t=t,this.currentUser=bu.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let s=new Ou;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ou,t.enqueueRetryable((()=>i(this.currentUser)))};const r=()=>{const e=s;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{Su("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Su("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ou)}}),0),r()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Su("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Cu("string"==typeof e.accessToken),new Pu(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Cu(null===t||"string"==typeof t),new bu(t)}}class Lu{constructor(t,e,n,i){this.h=t,this.l=e,this.m=n,this.g=i,this.type="FirstParty",this.user=bu.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(Cu(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Vu{constructor(t,e,n,i){this.h=t,this.l=e,this.m=n,this.g=i}getToken(){return Promise.resolve(new Lu(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable((()=>e(bu.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Fu{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Uu{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const n=t=>{null!=t.error&&Su("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.A;return this.A=t.token,Su("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{Su("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.T.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.T.getImmediate({optional:!0});t?i(t):Su("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Cu("string"==typeof t.token),this.A=t.token,new Fu(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=ju(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<e&&(n+=t.charAt(i[s]%t.length))}return n}}function zu(t,e){return t<e?-1:t>e?1:0}function Hu(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Du(Mu.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Du(Mu.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Du(Mu.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Du(Mu.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Wu.fromMillis(Date.now())}static fromDate(t){return Wu.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Wu(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?zu(this.nanoseconds,t.nanoseconds):zu(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(t){this.timestamp=t}static fromTimestamp(t){return new $u(t)}static min(){return new $u(new Wu(0,0))}static max(){return new $u(new Wu(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(t,e,n){void 0===e?e=0:e>t.length&&Iu(),void 0===n?n=t.length-e:n>t.length-e&&Iu(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===qu.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof qu?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),s=e.get(i);if(n<s)return-1;if(n>s)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Ku extends qu{construct(t,e,n){return new Ku(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Du(Mu.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Ku(e)}static emptyPath(){return new Ku([])}}const Gu=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Yu extends qu{construct(t,e,n){return new Yu(t,e,n)}static isValidIdentifier(t){return Gu.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Yu.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Yu(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const s=()=>{if(0===n.length)throw new Du(Mu.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let r=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new Du(Mu.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Du(Mu.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(r=!r,i++):"."!==e||r?(n+=e,i++):(s(),i++)}if(s(),r)throw new Du(Mu.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Yu(e)}static emptyPath(){return new Yu([])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(t){this.path=t}static fromPath(t){return new Xu(Ku.fromString(t))}static fromName(t){return new Xu(Ku.fromString(t).popFirst(5))}static empty(){return new Xu(Ku.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Ku.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Ku.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Xu(new Ku(t.slice()))}}function Qu(t){return new Ju(t.readTime,t.key,-1)}class Ju{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Ju($u.min(),Xu.empty(),-1)}static max(){return new Ju($u.max(),Xu.empty(),-1)}}function Zu(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Xu.comparator(t.documentKey,e.documentKey),0!==n?n:zu(t.largestBatchId,e.largestBatchId))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function td(t){if(t.code!==Mu.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==t.message)throw t;Su("LocalStore","Unexpectedly lost primary lease")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Iu(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new ed(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof ed?e:ed.resolve(e)}catch(e){return ed.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):ed.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):ed.reject(e)}static resolve(t){return new ed(((e,n)=>{e(t)}))}static reject(t){return new ed(((e,n)=>{n(t)}))}static waitFor(t){return new ed(((e,n)=>{let i=0,s=0,r=!1;t.forEach((t=>{++i,t.next((()=>{++s,r&&s===i&&e()}),(t=>n(t)))})),r=!0,s===i&&e()}))}static or(t){let e=ed.resolve(!1);for(const n of t)e=e.next((t=>t?ed.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new ed(((n,i)=>{const s=t.length,r=new Array(s);let o=0;for(let a=0;a<s;a++){const c=a;e(t[c]).next((t=>{r[c]=t,++o,o===s&&n(r)}),(t=>i(t)))}}))}static doWhile(t,e){return new ed(((n,i)=>{const s=()=>{!0===t()?e().next((()=>{s()}),i):n()};s()}))}}function nd(t){return"IndexedDbTransactionError"===t.name}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.ut(t),this.ct=t=>e.writeSequenceNumber(t))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sd(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function rd(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function od(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */id.at=-1;class ad{constructor(t,e){this.comparator=t,this.root=e||hd.EMPTY}insert(t,e){return new ad(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,hd.BLACK,null,null))}remove(t){return new ad(this.comparator,this.root.remove(t,this.comparator).copy(null,null,hd.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new cd(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new cd(this.root,t,this.comparator,!1)}getReverseIterator(){return new cd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new cd(this.root,t,this.comparator,!0)}}class cd{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?n(t.key,e):1,e&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(0===s){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class hd{constructor(t,e,n,i,s){this.key=t,this.value=e,this.color=null!=n?n:hd.RED,this.left=null!=i?i:hd.EMPTY,this.right=null!=s?s:hd.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,s){return new hd(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===s?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return hd.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return hd.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,hd.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,hd.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Iu();if(this.right.isRed())throw Iu();const t=this.left.check();if(t!==this.right.check())throw Iu();return t+(this.isRed()?0:1)}}hd.EMPTY=null,hd.RED=!0,hd.BLACK=!1,hd.EMPTY=new class{constructor(){this.size=0}get key(){throw Iu()}get value(){throw Iu()}get color(){throw Iu()}get left(){throw Iu()}get right(){throw Iu()}copy(t,e,n,i,s){return this}insert(t,e,n){return new hd(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ld{constructor(t){this.comparator=t,this.data=new ad(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new ud(this.data.getIterator())}getIteratorFrom(t){return new ud(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof ld))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new ld(this.comparator);return e.data=t,e}}class ud{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(t){this.fields=t,t.sort(Yu.comparator)}static empty(){return new dd([])}unionWith(t){let e=new ld(Yu.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new dd(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Hu(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new fd(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new fd(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return zu(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}fd.EMPTY_BYTE_STRING=new fd("");const pd=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gd(t){if(Cu(!!t),"string"==typeof t){let e=0;const n=pd.exec(t);if(Cu(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:md(t.seconds),nanos:md(t.nanos)}}function md(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function yd(t){return"string"==typeof t?fd.fromBase64String(t):fd.fromUint8Array(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function bd(t){const e=t.mapValue.fields.__previous_value__;return vd(e)?bd(e):e}function _d(t){const e=gd(t.mapValue.fields.__local_write_time__.timestampValue);return new Wu(e.seconds,e.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(t,e,n,i,s,r,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=r,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class xd{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new xd("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof xd&&t.projectId===this.projectId&&t.database===this.database}}function Sd(t){return null==t}function Ed(t){return 0===t&&1/t==-1/0}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Td={fields:{__type__:{stringValue:"__max__"}}};function kd(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vd(t)?4:function(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t)?9007199254740991:10:Iu()}function Id(t,e){if(t===e)return!0;const n=kd(t);if(n!==kd(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return _d(t).isEqual(_d(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=gd(t.timestampValue),i=gd(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return i=e,yd(t.bytesValue).isEqual(yd(i.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return md(t.geoPointValue.latitude)===md(e.geoPointValue.latitude)&&md(t.geoPointValue.longitude)===md(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return md(t.integerValue)===md(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=md(t.doubleValue),i=md(e.doubleValue);return n===i?Ed(n)===Ed(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return Hu(t.arrayValue.values||[],e.arrayValue.values||[],Id);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(sd(n)!==sd(i))return!1;for(const s in n)if(n.hasOwnProperty(s)&&(void 0===i[s]||!Id(n[s],i[s])))return!1;return!0}(t,e);default:return Iu()}var i}function Cd(t,e){return void 0!==(t.values||[]).find((t=>Id(t,e)))}function Ad(t,e){if(t===e)return 0;const n=kd(t),i=kd(e);if(n!==i)return zu(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return zu(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=md(t.integerValue||t.doubleValue),i=md(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Md(t.timestampValue,e.timestampValue);case 4:return Md(_d(t),_d(e));case 5:return zu(t.stringValue,e.stringValue);case 6:return function(t,e){const n=yd(t),i=yd(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let s=0;s<n.length&&s<i.length;s++){const t=zu(n[s],i[s]);if(0!==t)return t}return zu(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=zu(md(t.latitude),md(e.latitude));return 0!==n?n:zu(md(t.longitude),md(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let s=0;s<n.length&&s<i.length;++s){const t=Ad(n[s],i[s]);if(t)return t}return zu(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===Td&&e===Td)return 0;if(t===Td)return 1;if(e===Td)return-1;const n=t.fields||{},i=Object.keys(n),s=e.fields||{},r=Object.keys(s);i.sort(),r.sort();for(let o=0;o<i.length&&o<r.length;++o){const t=zu(i[o],r[o]);if(0!==t)return t;const e=Ad(n[i[o]],s[r[o]]);if(0!==e)return e}return zu(i.length,r.length)}(t.mapValue,e.mapValue);default:throw Iu()}}function Md(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return zu(t,e);const n=gd(t),i=gd(e),s=zu(n.seconds,i.seconds);return 0!==s?s:zu(n.nanos,i.nanos)}function Dd(t){return Od(t)}function Od(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=gd(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?yd(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Xu.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=Od(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const s of e)i?i=!1:n+=",",n+=`${s}:${Od(t.fields[s])}`;return n+"}"}(t.mapValue):Iu();var e,n}function Pd(t){return!!t&&"integerValue"in t}function Rd(t){return!!t&&"arrayValue"in t}function Nd(t){return!!t&&"nullValue"in t}function Ld(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vd(t){return!!t&&"mapValue"in t}function Fd(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return rd(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Fd(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Fd(t.arrayValue.values[n]);return e}return Object.assign({},t)}class Ud{constructor(t){this.value=t}static empty(){return new Ud({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Vd(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Fd(e)}setAll(t){let e=Yu.emptyPath(),n={},i=[];t.forEach(((t,s)=>{if(!e.isImmediateParentOf(s)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=s.popLast()}t?n[s.lastSegment()]=Fd(t):i.push(s.lastSegment())}));const s=this.getFieldsMap(e);this.applyChanges(s,n,i)}delete(t){const e=this.field(t.popLast());Vd(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Id(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Vd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){rd(e,((e,n)=>t[e]=n));for(const i of n)delete t[i]}clone(){return new Ud(Fd(this.value))}}function jd(t){const e=[];return rd(t.fields,((t,n)=>{const i=new Yu([t]);if(Vd(n)){const t=jd(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new dd(e)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class Bd{constructor(t,e,n,i,s,r){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.data=s,this.documentState=r}static newInvalidDocument(t){return new Bd(t,0,$u.min(),$u.min(),Ud.empty(),0)}static newFoundDocument(t,e,n){return new Bd(t,1,e,$u.min(),n,0)}static newNoDocument(t,e){return new Bd(t,2,e,$u.min(),Ud.empty(),0)}static newUnknownDocument(t,e){return new Bd(t,3,e,$u.min(),Ud.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ud.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ud.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$u.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Bd&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Bd(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(t,e=null,n=[],i=[],s=null,r=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=r,this.endAt=o,this.ht=null}}function Hd(t,e=null,n=[],i=[],s=null,r=null,o=null){return new zd(t,e,n,i,s,r,o)}function Wd(t){const e=Au(t);if(null===e.ht){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>{return(e=t).field.canonicalString()+e.op.toString()+Dd(e.value);var e})).join(","),t+="|ob:",t+=e.orderBy.map((t=>{return(e=t).field.canonicalString()+e.dir;var e})).join(","),Sd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Dd(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Dd(t))).join(",")),e.ht=t}return e.ht}function $d(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<t.orderBy.length;s++)if(!rf(t.orderBy[s],e.orderBy[s]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let s=0;s<t.filters.length;s++)if(n=t.filters[s],i=e.filters[s],n.op!==i.op||!n.field.isEqual(i.field)||!Id(n.value,i.value))return!1;var n,i;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!af(t.startAt,e.startAt)&&af(t.endAt,e.endAt)}function qd(t){return Xu.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class Kd extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.lt(t,e,n):new Gd(t,e,n):"array-contains"===e?new Jd(t,n):"in"===e?new Zd(t,n):"not-in"===e?new tf(t,n):"array-contains-any"===e?new ef(t,n):new Kd(t,e,n)}static lt(t,e,n){return"in"===e?new Yd(t,n):new Xd(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.ft(Ad(e,this.value)):null!==e&&kd(this.value)===kd(e)&&this.ft(Ad(e,this.value))}ft(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Iu()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Gd extends Kd{constructor(t,e,n){super(t,e,n),this.key=Xu.fromName(n.referenceValue)}matches(t){const e=Xu.comparator(t.key,this.key);return this.ft(e)}}class Yd extends Kd{constructor(t,e){super(t,"in",e),this.keys=Qd("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Xd extends Kd{constructor(t,e){super(t,"not-in",e),this.keys=Qd("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Qd(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Xu.fromName(t.referenceValue)))}class Jd extends Kd{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Rd(e)&&Cd(e.arrayValue,this.value)}}class Zd extends Kd{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Cd(this.value.arrayValue,e)}}class tf extends Kd{constructor(t,e){super(t,"not-in",e)}matches(t){if(Cd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Cd(this.value.arrayValue,e)}}class ef extends Kd{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Rd(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Cd(this.value.arrayValue,t)))}}class nf{constructor(t,e){this.position=t,this.inclusive=e}}class sf{constructor(t,e="asc"){this.field=t,this.dir=e}}function rf(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function of(t,e,n){let i=0;for(let s=0;s<t.position.length;s++){const r=e[s],o=t.position[s];if(i=r.field.isKeyField()?Xu.comparator(Xu.fromName(o.referenceValue),n.key):Ad(o,n.data.field(r.field)),"desc"===r.dir&&(i*=-1),0!==i)break}return i}function af(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Id(t.position[n],e.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(t,e=null,n=[],i=[],s=null,r="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=r,this.startAt=o,this.endAt=a,this._t=null,this.wt=null,this.startAt,this.endAt}}function hf(t){return new cf(t)}function lf(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function uf(t){const e=Au(t);if(null===e._t){e._t=[];const t=function(t){for(const e of t.filters)if(e.dt())return e.field;return null}(e),n=function(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}(e);if(null!==t&&null===n)t.isKeyField()||e._t.push(new sf(t)),e._t.push(new sf(Yu.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e._t.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e._t.push(new sf(Yu.keyField(),t))}}}return e._t}function df(t){const e=Au(t);if(!e.wt)if("F"===e.limitType)e.wt=Hd(e.path,e.collectionGroup,uf(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of uf(e)){const e="desc"===s.dir?"asc":"desc";t.push(new sf(s.field,e))}const n=e.endAt?new nf(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new nf(e.startAt.position,e.startAt.inclusive):null;e.wt=Hd(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e.wt}function ff(t,e,n){return new cf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function pf(t,e){return $d(df(t),df(e))&&t.limitType===e.limitType}function gf(t){return`${Wd(df(t))}|lt:${t.limitType}`}function mf(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${Dd(e.value)}`;var e})).join(", ")}]`),Sd(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>{return`${(e=t).field.canonicalString()} (${e.dir})`;var e})).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Dd(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Dd(t))).join(",")),`Target(${e})`}(df(t))}; limitType=${t.limitType})`}function yf(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Xu.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&(i=e,!((n=t).startAt&&!function(t,e,n){const i=of(t,e,n);return t.inclusive?i<=0:i<0}(n.startAt,uf(n),i)||n.endAt&&!function(t,e,n){const i=of(t,e,n);return t.inclusive?i>=0:i>0}(n.endAt,uf(n),i)));var n,i}function vf(t){return(e,n)=>{let i=!1;for(const s of uf(t)){const t=bf(s,e,n);if(0!==t)return t;i=i||s.field.isKeyField()}return 0}}function bf(t,e,n){const i=t.field.isKeyField()?Xu.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),s=n.data.field(t);return null!==i&&null!==s?Ad(i,s):Iu()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Iu()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(t,e){if(t.gt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ed(e)?"-0":e}}function wf(t){return{integerValue:""+t}}function xf(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Ed(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?wf(e):_f(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(){this._=void 0}}function Ef(t,e,n){return t instanceof If?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Cf?Af(t,e):t instanceof Mf?Df(t,e):function(t,e){const n=kf(t,e),i=Pf(n)+Pf(t.yt);return Pd(n)&&Pd(t.yt)?wf(i):_f(t.It,i)}(t,e)}function Tf(t,e,n){return t instanceof Cf?Af(t,e):t instanceof Mf?Df(t,e):n}function kf(t,e){return t instanceof Of?Pd(i=e)||(n=i)&&"doubleValue"in n?e:{integerValue:0}:null;var n,i}class If extends Sf{}class Cf extends Sf{constructor(t){super(),this.elements=t}}function Af(t,e){const n=Rf(e);for(const i of t.elements)n.some((t=>Id(t,i)))||n.push(i);return{arrayValue:{values:n}}}class Mf extends Sf{constructor(t){super(),this.elements=t}}function Df(t,e){let n=Rf(e);for(const i of t.elements)n=n.filter((t=>!Id(t,i)));return{arrayValue:{values:n}}}class Of extends Sf{constructor(t,e){super(),this.It=t,this.yt=e}}function Pf(t){return md(t.integerValue||t.doubleValue)}function Rf(t){return Rd(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Nf{constructor(t,e){this.version=t,this.transformResults=e}}class Lf{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Lf}static exists(t){return new Lf(void 0,t)}static updateTime(t){return new Lf(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Vf(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Ff{}function Uf(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Yf(t.key,Lf.none()):new Wf(t.key,t.data,Lf.none());{const n=t.data,i=Ud.empty();let s=new ld(Yu.comparator);for(let t of e.fields)if(!s.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),s=s.add(t)}return new $f(t.key,i,new dd(s.toArray()),Lf.none())}}function jf(t,e,n){var i;t instanceof Wf?function(t,e,n){const i=t.value.clone(),s=Kf(t.fieldTransforms,e,n.transformResults);i.setAll(s),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof $f?function(t,e,n){if(!Vf(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=Kf(t.fieldTransforms,e,n.transformResults),s=e.data;s.setAll(qf(t)),s.setAll(i),e.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(t,e,n):(i=n,e.convertToNoDocument(i.version).setHasCommittedMutations())}function Bf(t,e,n,i){return t instanceof Wf?function(t,e,n,i){if(!Vf(t.precondition,e))return n;const s=t.value.clone(),r=Gf(t.fieldTransforms,i,e);return s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null}(t,e,n,i):t instanceof $f?function(t,e,n,i){if(!Vf(t.precondition,e))return n;const s=Gf(t.fieldTransforms,i,e),r=e.data;return r.setAll(qf(t)),r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):(s=e,r=n,Vf(t.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):r);var s,r}function zf(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),s=kf(i.transform,t||null);null!=s&&(null===n&&(n=Ud.empty()),n.set(i.field,s))}return n||null}function Hf(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(n=t.fieldTransforms,i=e.fieldTransforms,!!(void 0===n&&void 0===i||n&&i&&Hu(n,i,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&(n=t.transform,i=e.transform,n instanceof Cf&&i instanceof Cf||n instanceof Mf&&i instanceof Mf?Hu(n.elements,i.elements,Id):n instanceof Of&&i instanceof Of?Id(n.yt,i.yt):n instanceof If&&i instanceof If);var n,i}(t,e))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask)));var n,i}class Wf extends Ff{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class $f extends Ff{constructor(t,e,n,i,s=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function qf(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Kf(t,e,n){const i=new Map;Cu(t.length===n.length);for(let s=0;s<n.length;s++){const r=t[s],o=r.transform,a=e.data.field(r.field);i.set(r.field,Tf(o,a,n[s]))}return i}function Gf(t,e,n){const i=new Map;for(const s of t){const t=s.transform,r=n.data.field(s.field);i.set(s.field,Ef(t,r,e))}return i}class Yf extends Ff{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Xf extends Ff{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(t){this.count=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jf,Zf;function tp(t){if(void 0===t)return Eu("GRPC error has no .code"),Mu.UNKNOWN;switch(t){case Jf.OK:return Mu.OK;case Jf.CANCELLED:return Mu.CANCELLED;case Jf.UNKNOWN:return Mu.UNKNOWN;case Jf.DEADLINE_EXCEEDED:return Mu.DEADLINE_EXCEEDED;case Jf.RESOURCE_EXHAUSTED:return Mu.RESOURCE_EXHAUSTED;case Jf.INTERNAL:return Mu.INTERNAL;case Jf.UNAVAILABLE:return Mu.UNAVAILABLE;case Jf.UNAUTHENTICATED:return Mu.UNAUTHENTICATED;case Jf.INVALID_ARGUMENT:return Mu.INVALID_ARGUMENT;case Jf.NOT_FOUND:return Mu.NOT_FOUND;case Jf.ALREADY_EXISTS:return Mu.ALREADY_EXISTS;case Jf.PERMISSION_DENIED:return Mu.PERMISSION_DENIED;case Jf.FAILED_PRECONDITION:return Mu.FAILED_PRECONDITION;case Jf.ABORTED:return Mu.ABORTED;case Jf.OUT_OF_RANGE:return Mu.OUT_OF_RANGE;case Jf.UNIMPLEMENTED:return Mu.UNIMPLEMENTED;case Jf.DATA_LOSS:return Mu.DATA_LOSS;default:return Iu()}}(Zf=Jf||(Jf={}))[Zf.OK=0]="OK",Zf[Zf.CANCELLED=1]="CANCELLED",Zf[Zf.UNKNOWN=2]="UNKNOWN",Zf[Zf.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Zf[Zf.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Zf[Zf.NOT_FOUND=5]="NOT_FOUND",Zf[Zf.ALREADY_EXISTS=6]="ALREADY_EXISTS",Zf[Zf.PERMISSION_DENIED=7]="PERMISSION_DENIED",Zf[Zf.UNAUTHENTICATED=16]="UNAUTHENTICATED",Zf[Zf.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Zf[Zf.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Zf[Zf.ABORTED=10]="ABORTED",Zf[Zf.OUT_OF_RANGE=11]="OUT_OF_RANGE",Zf[Zf.UNIMPLEMENTED=12]="UNIMPLEMENTED",Zf[Zf.INTERNAL=13]="INTERNAL",Zf[Zf.UNAVAILABLE=14]="UNAVAILABLE",Zf[Zf.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ep{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[i,s]of n)if(this.equalsFn(i,t))return s}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){rd(this.inner,((e,n)=>{for(const[i,s]of n)t(i,s)}))}isEmpty(){return od(this.inner)}size(){return this.innerSize}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const np=new ad(Xu.comparator);function ip(){return np}const sp=new ad(Xu.comparator);function rp(...t){let e=sp;for(const n of t)e=e.insert(n.key,n);return e}function op(t){let e=sp;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function ap(){return hp()}function cp(){return hp()}function hp(){return new ep((t=>t.toString()),((t,e)=>t.isEqual(e)))}const lp=new ad(Xu.comparator),up=new ld(Xu.comparator);function dp(...t){let e=up;for(const n of t)e=e.add(n);return e}const fp=new ld(zu);function pp(){return fp}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(t,e,n,i,s){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,e){const n=new Map;return n.set(t,mp.createSynthesizedTargetChangeForCurrentChange(t,e)),new gp($u.min(),n,pp(),ip(),dp())}}class mp{constructor(t,e,n,i,s){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,e){return new mp(fd.EMPTY_BYTE_STRING,e,dp(),dp(),dp())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(t,e,n,i){this.Tt=t,this.removedTargetIds=e,this.key=n,this.Et=i}}class vp{constructor(t,e){this.targetId=t,this.At=e}}class bp{constructor(t,e,n=fd.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class _p{constructor(){this.Rt=0,this.bt=Sp(),this.Pt=fd.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(t){t.approximateByteSize()>0&&(this.Vt=!0,this.Pt=t)}xt(){let t=dp(),e=dp(),n=dp();return this.bt.forEach(((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:Iu()}})),new mp(this.Pt,this.vt,t,e,n)}Nt(){this.Vt=!1,this.bt=Sp()}kt(t,e){this.Vt=!0,this.bt=this.bt.insert(t,e)}Mt(t){this.Vt=!0,this.bt=this.bt.remove(t)}Ot(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class wp{constructor(t){this.Bt=t,this.Lt=new Map,this.Ut=ip(),this.qt=xp(),this.Kt=new ld(zu)}Gt(t){for(const e of t.Tt)t.Et&&t.Et.isFoundDocument()?this.Qt(e,t.Et):this.jt(e,t.key,t.Et);for(const e of t.removedTargetIds)this.jt(e,t.key,t.Et)}Wt(t){this.forEachTarget(t,(e=>{const n=this.zt(e);switch(t.state){case 0:this.Ht(e)&&n.Ct(t.resumeToken);break;case 1:n.Ft(),n.St||n.Nt(),n.Ct(t.resumeToken);break;case 2:n.Ft(),n.St||this.removeTarget(e);break;case 3:this.Ht(e)&&(n.$t(),n.Ct(t.resumeToken));break;case 4:this.Ht(e)&&(this.Jt(e),n.Ct(t.resumeToken));break;default:Iu()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Lt.forEach(((t,n)=>{this.Ht(n)&&e(n)}))}Yt(t){const e=t.targetId,n=t.At.count,i=this.Xt(e);if(i){const t=i.target;if(qd(t))if(0===n){const n=new Xu(t.path);this.jt(e,n,Bd.newNoDocument(n,$u.min()))}else Cu(1===n);else this.Zt(e)!==n&&(this.Jt(e),this.Kt=this.Kt.add(e))}}te(t){const e=new Map;this.Lt.forEach(((n,i)=>{const s=this.Xt(i);if(s){if(n.current&&qd(s.target)){const e=new Xu(s.target.path);null!==this.Ut.get(e)||this.ee(i,e)||this.jt(i,e,Bd.newNoDocument(e,t))}n.Dt&&(e.set(i,n.xt()),n.Nt())}}));let n=dp();this.qt.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.Xt(t);return!e||2===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.Ut.forEach(((e,n)=>n.setReadTime(t)));const i=new gp(t,e,this.Kt,this.Ut,n);return this.Ut=ip(),this.qt=xp(),this.Kt=new ld(zu),i}Qt(t,e){if(!this.Ht(t))return;const n=this.ee(t,e.key)?2:0;this.zt(t).kt(e.key,n),this.Ut=this.Ut.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ne(e.key).add(t))}jt(t,e,n){if(!this.Ht(t))return;const i=this.zt(t);this.ee(t,e)?i.kt(e,1):i.Mt(e),this.qt=this.qt.insert(e,this.ne(e).delete(t)),n&&(this.Ut=this.Ut.insert(e,n))}removeTarget(t){this.Lt.delete(t)}Zt(t){const e=this.zt(t).xt();return this.Bt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ot(t){this.zt(t).Ot()}zt(t){let e=this.Lt.get(t);return e||(e=new _p,this.Lt.set(t,e)),e}ne(t){let e=this.qt.get(t);return e||(e=new ld(zu),this.qt=this.qt.insert(t,e)),e}Ht(t){const e=null!==this.Xt(t);return e||Su("WatchChangeAggregator","Detected inactive target",t),e}Xt(t){const e=this.Lt.get(t);return e&&e.St?null:this.Bt.se(t)}Jt(t){this.Lt.set(t,new _p),this.Bt.getRemoteKeysForTarget(t).forEach((e=>{this.jt(t,e,null)}))}ee(t,e){return this.Bt.getRemoteKeysForTarget(t).has(e)}}function xp(){return new ad(Xu.comparator)}function Sp(){return new ad(Xu.comparator)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ep={asc:"ASCENDING",desc:"DESCENDING"},Tp={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class kp{constructor(t,e){this.databaseId=t,this.gt=e}}function Ip(t,e){return t.gt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Cp(t,e){return t.gt?e.toBase64():e.toUint8Array()}function Ap(t,e){return Ip(t,e.toTimestamp())}function Mp(t){return Cu(!!t),$u.fromTimestamp(function(t){const e=gd(t);return new Wu(e.seconds,e.nanos)}(t))}function Dp(t,e){return(n=t,new Ku(["projects",n.projectId,"databases",n.database])).child("documents").child(e).canonicalString();var n}function Op(t){const e=Ku.fromString(t);return Cu(Xp(e)),e}function Pp(t,e){return Dp(t.databaseId,e.path)}function Rp(t,e){const n=Op(e);if(n.get(1)!==t.databaseId.projectId)throw new Du(Mu.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Du(Mu.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Xu(Vp(n))}function Np(t,e){return Dp(t.databaseId,e)}function Lp(t){return new Ku(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Vp(t){return Cu(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Fp(t,e,n){return{name:Pp(t,e),fields:n.value.mapValue.fields}}function Up(t,e){return{documents:[Np(t,e.path)]}}function jp(t,e){const n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Np(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Np(t,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const s=function(t){if(0===t.length)return;const e=t.map((t=>function(t){if("=="===t.op){if(Ld(t.value))return{unaryFilter:{field:$p(t.field),op:"IS_NAN"}};if(Nd(t.value))return{unaryFilter:{field:$p(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ld(t.value))return{unaryFilter:{field:$p(t.field),op:"IS_NOT_NAN"}};if(Nd(t.value))return{unaryFilter:{field:$p(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$p(t.field),op:Wp(t.op),value:t.value}}}(t)));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);s&&(n.structuredQuery.where=s);const r=function(t){if(0!==t.length)return t.map((t=>{return{field:$p((e=t).field),direction:Hp(e.dir)};var e}))}(e.orderBy);r&&(n.structuredQuery.orderBy=r);const o=(a=t,c=e.limit,a.gt||Sd(c)?c:{value:c});var a,c,h;return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),n}function Bp(t){let e=function(t){const e=Op(t);return 4===e.length?Ku.emptyPath():Vp(e)}(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let s=null;if(i>0){Cu(1===i);const t=n.from[0];t.allDescendants?s=t.collectionId:e=e.child(t.collectionId)}let r=[];n.where&&(r=zp(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>{return new sf(qp((e=t).field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction));var e})));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Sd(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new nf(n,e)}(n.startAt));let h=null;return n.endAt&&(h=function(t){const e=!t.before,n=t.values||[];return new nf(n,e)}(n.endAt)),function(t,e,n,i,s,r,o,a){return new cf(t,e,n,i,s,r,o,a)}(e,s,o,r,a,"F",c,h)}function zp(t){return t?void 0!==t.unaryFilter?[Gp(t)]:void 0!==t.fieldFilter?[Kp(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>zp(t))).reduce(((t,e)=>t.concat(e))):Iu():[]}function Hp(t){return Ep[t]}function Wp(t){return Tp[t]}function $p(t){return{fieldPath:t.canonicalString()}}function qp(t){return Yu.fromServerFormat(t.fieldPath)}function Kp(t){return Kd.create(qp(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Iu()}}(t.fieldFilter.op),t.fieldFilter.value)}function Gp(t){switch(t.unaryFilter.op){case"IS_NAN":const e=qp(t.unaryFilter.field);return Kd.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=qp(t.unaryFilter.field);return Kd.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=qp(t.unaryFilter.field);return Kd.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=qp(t.unaryFilter.field);return Kd.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Iu()}}function Yp(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Xp(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const e=this.mutations[i];e.key.isEqual(t.key)&&jf(e,t,n[i])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Bf(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Bf(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=cp();return this.mutations.forEach((i=>{const s=t.get(i.key),r=s.overlayedDocument;let o=this.applyToLocalView(r,s.mutatedFields);o=e.has(i.key)?null:o;const a=Uf(r,o);null!==a&&n.set(i.key,a),r.isValidDocument()||r.convertToNoDocument($u.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),dp())}isEqual(t){return this.batchId===t.batchId&&Hu(this.mutations,t.mutations,((t,e)=>Hf(t,e)))&&Hu(this.baseMutations,t.baseMutations,((t,e)=>Hf(t,e)))}}class Jp{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){Cu(t.mutations.length===n.length);let i=lp;const s=t.mutations;for(let r=0;r<s.length;r++)i=i.insert(s[r].key,n[r].version);return new Jp(t,e,n,i)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tg{constructor(t,e,n,i,s=$u.min(),r=$u.min(),o=fd.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=r,this.resumeToken=o}withSequenceNumber(t){return new tg(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new tg(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new tg(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(t){this.re=t}}function ng(t){const e=Bp({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ff(e,e.limit,"L"):e}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(){this.Ye=new sg}addToCollectionParentIndex(t,e){return this.Ye.add(e),ed.resolve()}getCollectionParents(t,e){return ed.resolve(this.Ye.getEntries(e))}addFieldIndex(t,e){return ed.resolve()}deleteFieldIndex(t,e){return ed.resolve()}getDocumentsMatchingTarget(t,e){return ed.resolve(null)}getIndexType(t,e){return ed.resolve(0)}getFieldIndexes(t,e){return ed.resolve([])}getNextCollectionGroupToUpdate(t){return ed.resolve(null)}getMinOffset(t,e){return ed.resolve(Ju.min())}getMinOffsetFromCollectionGroup(t,e){return ed.resolve(Ju.min())}updateCollectionGroup(t,e,n){return ed.resolve()}updateIndexEntries(t,e){return ed.resolve()}}class sg{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new ld(Ku.comparator),s=!i.has(n);return this.index[e]=i.add(n),s}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new ld(Ku.comparator)).toArray()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new rg(0)}static vn(){return new rg(-1)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class og{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.getBaseDocument(t,e,n)))).next((t=>(null!==n&&Bf(n.mutation,t,dd.empty(),Wu.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,dp()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=dp()){const i=ap();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=rp();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=ap();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,dp())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let s=ip();const r=hp(),o=hp();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof $f)?s=s.insert(e.key,e):void 0!==o&&(r.set(e.key,o.mutation.getFieldMask()),Bf(o.mutation,e,o.mutation.getFieldMask(),Wu.now()))})),this.recalculateAndSaveOverlays(t,s).next((t=>(t.forEach(((t,e)=>r.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new og(e,null!==(n=r.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=hp();let i=new ad(((t,e)=>t-e)),s=dp();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const s of t)s.keys().forEach((t=>{const r=e.get(t);if(null===r)return;let o=n.get(t)||dd.empty();o=s.applyToLocalView(r,o),n.set(t,o);const a=(i.get(s.batchId)||dp()).add(t);i=i.insert(s.batchId,a)}))})).next((()=>{const r=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,h=cp();c.forEach((t=>{if(!s.has(t)){const i=Uf(e.get(t),n.get(t));null!==i&&h.set(t,i),s=s.add(t)}})),r.push(this.documentOverlayCache.saveOverlays(t,a,h))}return ed.waitFor(r)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n){return i=e,Xu.isDocumentKey(i.path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n);var i}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((s=>{const r=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-s.size):ed.resolve(ap());let o=-1,a=s;return r.next((e=>ed.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),s.get(e)?ed.resolve():this.getBaseDocument(t,e,n).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,s))).next((()=>this.computeViews(t,a,e,dp()))).next((t=>({batchId:o,changes:op(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Xu(e)).next((t=>{let e=rp();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n){const i=e.collectionGroup;let s=rp();return this.indexManager.getCollectionParents(t,i).next((r=>ed.forEach(r,(r=>{const o=(a=e,c=r.child(i),new cf(c,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt));var a,c;return this.getDocumentsMatchingCollectionQuery(t,o,n).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n){let i;return this.remoteDocumentCache.getAllFromCollection(t,e.path,n).next((s=>(i=s,this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId)))).next((t=>{t.forEach(((t,e)=>{const n=e.getKey();null===i.get(n)&&(i=i.insert(n,Bd.newInvalidDocument(n)))}));let n=rp();return i.forEach(((i,s)=>{const r=t.get(i);void 0!==r&&Bf(r.mutation,s,dd.empty(),Wu.now()),yf(e,s)&&(n=n.insert(i,s))})),n}))}getBaseDocument(t,e,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(t,e):ed.resolve(Bd.newInvalidDocument(e))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(t){this.It=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return ed.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var n;return this.Zn.set(e.id,{id:(n=e).id,version:n.version,createTime:Mp(n.createTime)}),ed.resolve()}getNamedQuery(t,e){return ed.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,{name:(n=e).name,query:ng(n.bundledQuery),readTime:Mp(n.readTime)}),ed.resolve();var n}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(){this.overlays=new ad(Xu.comparator),this.es=new Map}getOverlay(t,e){return ed.resolve(this.overlays.get(e))}getOverlays(t,e){const n=ap();return ed.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.ue(t,e,i)})),ed.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.es.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.es.delete(n)),ed.resolve()}getOverlaysForCollection(t,e,n){const i=ap(),s=e.length+1,r=new Xu(e.child("")),o=this.overlays.getIteratorFrom(r);for(;o.hasNext();){const t=o.getNext().value,r=t.getKey();if(!e.isPrefixOf(r.path))break;r.path.length===s&&t.largestBatchId>n&&i.set(t.getKey(),t)}return ed.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let s=new ad(((t,e)=>t-e));const r=this.overlays.getIterator();for(;r.hasNext();){const t=r.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=s.get(t.largestBatchId);null===e&&(e=ap(),s=s.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=ap(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return ed.resolve(o)}ue(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.es.get(i.largestBatchId).delete(n.key);this.es.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Zp(e,n));let s=this.es.get(e);void 0===s&&(s=dp(),this.es.set(e,s)),this.es.set(e,s.add(n.key))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(){this.ns=new ld(ug.ss),this.rs=new ld(ug.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const n=new ug(t,e);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}us(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.cs(new ug(t,e))}hs(t,e){t.forEach((t=>this.removeReference(t,e)))}ls(t){const e=new Xu(new Ku([])),n=new ug(e,t),i=new ug(e,t+1),s=[];return this.rs.forEachInRange([n,i],(t=>{this.cs(t),s.push(t.key)})),s}fs(){this.ns.forEach((t=>this.cs(t)))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new Xu(new Ku([])),n=new ug(e,t),i=new ug(e,t+1);let s=dp();return this.rs.forEachInRange([n,i],(t=>{s=s.add(t.key)})),s}containsKey(t){const e=new ug(t,0),n=this.ns.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class ug{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return Xu.comparator(t.key,e.key)||zu(t._s,e._s)}static os(t,e){return zu(t._s,e._s)||Xu.comparator(t.key,e.key)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new ld(ug.ss)}checkEmpty(t){return ed.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const s=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new Qp(s,e,n,i);this.mutationQueue.push(r);for(const o of i)this.gs=this.gs.add(new ug(o.key,s)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return ed.resolve(r)}lookupMutationBatch(t,e){return ed.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.ps(n),s=i<0?0:i;return ed.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ed.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return ed.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new ug(e,0),i=new ug(e,Number.POSITIVE_INFINITY),s=[];return this.gs.forEachInRange([n,i],(t=>{const e=this.ys(t._s);s.push(e)})),ed.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new ld(zu);return e.forEach((t=>{const e=new ug(t,0),i=new ug(t,Number.POSITIVE_INFINITY);this.gs.forEachInRange([e,i],(t=>{n=n.add(t._s)}))})),ed.resolve(this.Is(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let s=n;Xu.isDocumentKey(s)||(s=s.child(""));const r=new ug(new Xu(s),0);let o=new ld(zu);return this.gs.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t._s)),!0)}),r),ed.resolve(this.Is(o))}Is(t){const e=[];return t.forEach((t=>{const n=this.ys(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Cu(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let n=this.gs;return ed.forEach(e.mutations,(i=>{const s=new ug(i.key,e.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.gs=n}))}An(t){}containsKey(t,e){const n=new ug(e,0),i=this.gs.firstAfterOrEqual(n);return ed.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,ed.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fg{constructor(t){this.Es=t,this.docs=new ad(Xu.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),s=i?i.size:0,r=this.Es(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:r}),this.size+=r-s,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return ed.resolve(n?n.document.mutableCopy():Bd.newInvalidDocument(e))}getEntries(t,e){let n=ip();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Bd.newInvalidDocument(t))})),ed.resolve(n)}getAllFromCollection(t,e,n){let i=ip();const s=new Xu(e.child("")),r=this.docs.getIteratorFrom(s);for(;r.hasNext();){const{key:t,value:{document:s}}=r.getNext();if(!e.isPrefixOf(t.path))break;t.path.length>e.length+1||Zu(Qu(s),n)<=0||(i=i.insert(s.key,s.mutableCopy()))}return ed.resolve(i)}getAllFromCollectionGroup(t,e,n,i){Iu()}As(t,e){return ed.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new pg(this)}getSize(t){return ed.resolve(this.size)}}class pg extends class{constructor(){this.changes=new ep((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Bd.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?ed.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.Yn.addEntry(t,i)):this.Yn.removeEntry(n)})),ed.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gg{constructor(t){this.persistence=t,this.Rs=new ep((t=>Wd(t)),$d),this.lastRemoteSnapshotVersion=$u.min(),this.highestTargetId=0,this.bs=0,this.Ps=new lg,this.targetCount=0,this.vs=rg.Pn()}forEachTarget(t,e){return this.Rs.forEach(((t,n)=>e(n))),ed.resolve()}getLastRemoteSnapshotVersion(t){return ed.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ed.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),ed.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.bs&&(this.bs=e),ed.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new rg(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,ed.resolve()}updateTargetData(t,e){return this.Dn(e),ed.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,ed.resolve()}removeTargets(t,e,n){let i=0;const s=[];return this.Rs.forEach(((r,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Rs.delete(r),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),ed.waitFor(s).next((()=>i))}getTargetCount(t){return ed.resolve(this.targetCount)}getTargetData(t,e){const n=this.Rs.get(e)||null;return ed.resolve(n)}addMatchingKeys(t,e,n){return this.Ps.us(e,n),ed.resolve()}removeMatchingKeys(t,e,n){this.Ps.hs(e,n);const i=this.persistence.referenceDelegate,s=[];return i&&e.forEach((e=>{s.push(i.markPotentiallyOrphaned(t,e))})),ed.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),ed.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Ps.ds(e);return ed.resolve(n)}containsKey(t,e){return ed.resolve(this.Ps.containsKey(e))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new id(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new gg(this),this.indexManager=new ig,this.remoteDocumentCache=new fg((t=>this.referenceDelegate.xs(t))),this.It=new eg(e),this.Ns=new cg(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new hg,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Vs[t.toKey()];return n||(n=new dg(e,this.referenceDelegate),this.Vs[t.toKey()]=n),n}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,n){Su("MemoryPersistence","Starting transaction:",t);const i=new yg(this.Ss.next());return this.referenceDelegate.ks(),n(i).next((t=>this.referenceDelegate.Ms(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Os(t,e){return ed.or(Object.values(this.Vs).map((n=>()=>n.containsKey(t,e))))}}class yg extends class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}{constructor(t){super(),this.currentSequenceNumber=t}}class vg{constructor(t){this.persistence=t,this.Fs=new lg,this.$s=null}static Bs(t){return new vg(t)}get Ls(){if(this.$s)return this.$s;throw Iu()}addReference(t,e,n){return this.Fs.addReference(n,e),this.Ls.delete(n.toString()),ed.resolve()}removeReference(t,e,n){return this.Fs.removeReference(n,e),this.Ls.add(n.toString()),ed.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),ed.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach((t=>this.Ls.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Ls.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}ks(){this.$s=new Set}Ms(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ed.forEach(this.Ls,(n=>{const i=Xu.fromPath(n);return this.Us(t,i).next((t=>{t||e.removeEntry(i,$u.min())}))})).next((()=>(this.$s=null,e.apply(t))))}updateLimboDocument(t,e){return this.Us(t,e).next((t=>{t?this.Ls.delete(e.toString()):this.Ls.add(e.toString())}))}xs(t){return 0}Us(t,e){return ed.or([()=>ed.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Os(t,e)])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Si=n,this.Di=i}static Ci(t,e){let n=dp(),i=dp();for(const s of e.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new bg(t,e.fromCache,n,i)}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _g{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,n,i){return this.ki(t,e).next((s=>s||this.Mi(t,e,i,n))).next((n=>n||this.Oi(t,e)))}ki(t,e){if(lf(e))return ed.resolve(null);let n=df(e);return this.indexManager.getIndexType(t,n).next((i=>0===i?null:(null!==e.limit&&1===i&&(e=ff(e,null,"F"),n=df(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((i=>{const s=dp(...i);return this.Ni.getDocuments(t,s).next((i=>this.indexManager.getMinOffset(t,n).next((n=>{const r=this.Fi(e,i);return this.$i(e,r,s,n.readTime)?this.ki(t,ff(e,null,"F")):this.Bi(t,r,e,n)}))))})))))}Mi(t,e,n,i){return lf(e)||i.isEqual($u.min())?this.Oi(t,e):this.Ni.getDocuments(t,n).next((s=>{const r=this.Fi(e,s);return this.$i(e,r,n,i)?this.Oi(t,e):(xu()<=Ki.DEBUG&&Su("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),mf(e)),this.Bi(t,r,e,function(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,s=$u.fromTimestamp(1e9===i?new Wu(n+1,0):new Wu(n,i));return new Ju(s,Xu.empty(),e)}(i,-1)))}))}Fi(t,e){let n=new ld(vf(t));return e.forEach(((e,i)=>{yf(t,i)&&(n=n.add(i))})),n}$i(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const s="F"===t.limitType?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Oi(t,e){return xu()<=Ki.DEBUG&&Su("QueryEngine","Using full collection scan to execute query:",mf(e)),this.Ni.getDocumentsMatchingQuery(t,e,Ju.min())}Bi(t,e,n,i){return this.Ni.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(t,e,n,i){this.persistence=t,this.Li=e,this.It=i,this.Ui=new ad(zu),this.qi=new ep((t=>Wd(t)),$d),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(n)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new ag(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ui)))}}async function xg(t,e){const n=Au(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((s=>(i=s,n.Qi(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const s=[],r=[];let o=dp();for(const t of i){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({ji:t,removedBatchIds:s,addedBatchIds:r})))}))}))}function Sg(t){const e=Au(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Cs.getLastRemoteSnapshotVersion(t)))}function Eg(t,e){const n=Au(t),i=e.snapshotVersion;let s=n.Ui;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const r=n.Gi.newChangeBuffer({trackRemovals:!0});s=n.Ui;const o=[];e.targetChanges.forEach(((r,a)=>{const c=s.get(a);if(!c)return;o.push(n.Cs.removeMatchingKeys(t,r.removedDocuments,a).next((()=>n.Cs.addMatchingKeys(t,r.addedDocuments,a))));let h=c.withSequenceNumber(t.currentSequenceNumber);var l,u,d;e.targetMismatches.has(a)?h=h.withResumeToken(fd.EMPTY_BYTE_STRING,$u.min()).withLastLimboFreeSnapshotVersion($u.min()):r.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(r.resumeToken,i)),s=s.insert(a,h),u=h,d=r,(0===(l=c).resumeToken.approximateByteSize()||u.snapshotVersion.toMicroseconds()-l.snapshotVersion.toMicroseconds()>=3e8||d.addedDocuments.size+d.modifiedDocuments.size+d.removedDocuments.size>0)&&o.push(n.Cs.updateTargetData(t,h))}));let a=ip(),c=dp();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),o.push(function(t,e,n){let i=dp(),s=dp();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=ip();return n.forEach(((n,r)=>{const o=t.get(n);r.isFoundDocument()!==o.isFoundDocument()&&(s=s.add(n)),r.isNoDocument()&&r.version.isEqual($u.min())?(e.removeEntry(n,r.readTime),i=i.insert(n,r)):!o.isValidDocument()||r.version.compareTo(o.version)>0||0===r.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(r),i=i.insert(n,r)):Su("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",r.version)})),{Wi:i,zi:s}}))}(t,r,e.documentUpdates).next((t=>{a=t.Wi,c=t.zi}))),!i.isEqual($u.min())){const e=n.Cs.getLastRemoteSnapshotVersion(t).next((e=>n.Cs.setTargetsMetadata(t,t.currentSequenceNumber,i)));o.push(e)}return ed.waitFor(o).next((()=>r.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,c))).next((()=>a))})).then((t=>(n.Ui=s,t)))}function Tg(t,e){const n=Au(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}async function kg(t,e,n){const i=Au(t),s=i.Ui.get(e),r=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",r,(t=>i.persistence.referenceDelegate.removeTarget(t,s)))}catch(o){if(!nd(o))throw o;Su("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.Ui=i.Ui.remove(e),i.qi.delete(s.target)}function Ig(t,e,n){const i=Au(t);let s=$u.min(),r=dp();return i.persistence.runTransaction("Execute query","readonly",(t=>function(t,e,n){const i=Au(t),s=i.qi.get(n);return void 0!==s?ed.resolve(i.Ui.get(s)):i.Cs.getTargetData(e,n)}(i,t,df(e)).next((e=>{if(e)return s=e.lastLimboFreeSnapshotVersion,i.Cs.getMatchingKeysForTargetId(t,e.targetId).next((t=>{r=t}))})).next((()=>i.Li.getDocumentsMatchingQuery(t,e,n?s:$u.min(),n?r:dp()))).next((t=>(function(t,e,n){let i=$u.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.Ki.set(e,i)}(i,function(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),t),{documents:t,Hi:r})))))}class Cg{constructor(){this.activeTargetIds=pp()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Ag{constructor(){this.Lr=new Cg,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Lr.er(t),this.Ur[t]||"not-current"}updateQueryState(t,e,n){this.Ur[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.Ur[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new Cg,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{qr(t){}shutdown(){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){Su("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){Su("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Og={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.oo=e+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}co(t,e,n,i,s){const r=this.ao(t,e);Su("RestConnection","Sending: ",r,n);const o={};return this.ho(o,i,s),this.lo(t,r,o,n).then((t=>(Su("RestConnection","Received: ",t),t)),(e=>{throw Tu("RestConnection",`${t} failed with error: `,e,"url: ",r,"request:",n),e}))}fo(t,e,n,i,s,r){return this.co(t,e,n,i,s)}ho(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+_u,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}ao(t,e){const n=Og[t];return`${this.oo}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}lo(t,e,n,i){return new Promise(((s,r)=>{const o=new yu;o.listenOnce(uu.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case lu.NO_ERROR:const e=o.getResponseJson();Su("Connection","XHR received:",JSON.stringify(e)),s(e);break;case lu.TIMEOUT:Su("Connection",'RPC "'+t+'" timed out'),r(new Du(Mu.DEADLINE_EXCEEDED,"Request time out"));break;case lu.HTTP_ERROR:const n=o.getStatus();if(Su("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const t=o.getResponseJson().error;if(t&&t.status&&t.message){const e=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Mu).indexOf(e)>=0?e:Mu.UNKNOWN}(t.status);r(new Du(e,t.message))}else r(new Du(Mu.UNKNOWN,"Server responded with status "+o.getStatus()))}else r(new Du(Mu.UNAVAILABLE,"Connection failed."));break;default:Iu()}}finally{Su("Connection",'RPC "'+t+'" completed.')}}));const a=JSON.stringify(i);o.send(e,"POST",a,n,15)}))}_o(t,e,n){const i=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=new ru,r=Zc(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new gu({})),this.ho(o.initMessageHeaders,e,n),Ai()||Di()||Ci().indexOf("Electron/")>=0||Oi()||Ci().indexOf("MSAppHost/")>=0||Mi()||(o.httpHeadersOverwriteParam="$httpHeaders");const a=i.join("");Su("Connection","Creating WebChannel: "+a,o);const c=s.createWebChannel(a,o);let h=!1,l=!1;const u=new Pg({Hr:t=>{l?Su("Connection","Not sending because WebChannel is closed:",t):(h||(Su("Connection","Opening WebChannel transport."),c.open(),h=!0),Su("Connection","WebChannel sending:",t),c.send(t))},Jr:()=>c.close()}),d=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(e){setTimeout((()=>{throw e}),0)}}))};return d(c,mu.EventType.OPEN,(()=>{l||Su("Connection","WebChannel transport opened.")})),d(c,mu.EventType.CLOSE,(()=>{l||(l=!0,Su("Connection","WebChannel transport closed"),u.io())})),d(c,mu.EventType.ERROR,(t=>{l||(l=!0,Tu("Connection","WebChannel transport errored:",t),u.io(new Du(Mu.UNAVAILABLE,"The operation could not be completed")))})),d(c,mu.EventType.MESSAGE,(t=>{var e;if(!l){const n=t.data[0];Cu(!!n);const i=n,s=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(s){Su("Connection","WebChannel received error:",s);const t=s.status;let e=function(t){const e=Jf[t];if(void 0!==e)return tp(e)}(t),n=s.message;void 0===e&&(e=Mu.INTERNAL,n="Unknown error status: "+t+" with message "+s.message),l=!0,u.io(new Du(e,n)),c.close()}else Su("Connection","WebChannel received:",n),u.ro(n)}})),d(r,du.STAT_EVENT,(t=>{t.stat===fu?Su("Connection","Detected buffering proxy"):t.stat===pu&&Su("Connection","Detected no buffering proxy")})),setTimeout((()=>{u.so()}),0),u}}function Ng(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lg(t){return new kp(t,!0)}class Vg{constructor(t,e,n=1e3,i=1.5,s=6e4){this.Hs=t,this.timerId=e,this.wo=n,this.mo=i,this.yo=s,this.po=0,this.Io=null,this.To=Date.now(),this.reset()}reset(){this.po=0}Eo(){this.po=this.yo}Ao(t){this.cancel();const e=Math.floor(this.po+this.Ro()),n=Math.max(0,Date.now()-this.To),i=Math.max(0,e-n);i>0&&Su("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.po} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Io=this.Hs.enqueueAfterDelay(this.timerId,i,(()=>(this.To=Date.now(),t()))),this.po*=this.mo,this.po<this.wo&&(this.po=this.wo),this.po>this.yo&&(this.po=this.yo)}bo(){null!==this.Io&&(this.Io.skipDelay(),this.Io=null)}cancel(){null!==this.Io&&(this.Io.cancel(),this.Io=null)}Ro(){return(Math.random()-.5)*this.po}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(t,e,n,i,s,r,o,a){this.Hs=t,this.Po=n,this.vo=i,this.Vo=s,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Vg(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Mo()}async stop(){this.No()&&await this.close(0)}Oo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.Po,6e4,(()=>this.$o())))}Bo(t){this.Lo(),this.stream.send(t)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(t,e){this.Lo(),this.Uo(),this.xo.cancel(),this.So++,4!==t?this.xo.reset():e&&e.code===Mu.RESOURCE_EXHAUSTED?(Eu(e.toString()),Eu("Using maximum backoff delay to prevent overloading the backend."),this.xo.Eo()):e&&e.code===Mu.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.qo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Zr(e)}qo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.So===e&&this.Go(t,n)}),(e=>{t((()=>{const t=new Du(Mu.UNKNOWN,"Fetching auth token failed: "+e.message);return this.Qo(t)}))}))}Go(t,e){const n=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr((()=>{n((()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.vo,1e4,(()=>(this.ko()&&(this.state=3),Promise.resolve()))),this.listener.Yr())))})),this.stream.Zr((t=>{n((()=>this.Qo(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Mo(){this.state=5,this.xo.Ao((async()=>{this.state=0,this.start()}))}Qo(t){return Su("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget((()=>this.So===t?e():(Su("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ug extends Fg{constructor(t,e,n,i,s,r){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,r),this.It=s}jo(t,e){return this.Vo._o("Listen",t,e)}onMessage(t){this.xo.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const s="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Iu(),r=e.targetChange.targetIds||[],o=function(t,e){return t.gt?(Cu(void 0===e||"string"==typeof e),fd.fromBase64String(e||"")):(Cu(void 0===e||e instanceof Uint8Array),fd.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(t){const e=void 0===t.code?Mu.UNKNOWN:tp(t.code);return new Du(e,t.message||"")}(a);n=new bp(s,r,o,c||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=Rp(t,i.document.name),r=Mp(i.document.updateTime),o=new Ud({mapValue:{fields:i.document.fields}}),a=Bd.newFoundDocument(s,r,o),c=i.targetIds||[],h=i.removedTargetIds||[];n=new yp(c,h,a.key,a)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=Rp(t,i.document),r=i.readTime?Mp(i.readTime):$u.min(),o=Bd.newNoDocument(s,r),a=i.removedTargetIds||[];n=new yp([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=Rp(t,i.document),r=i.removedTargetIds||[];n=new yp([],r,s,null)}else{if(!("filter"in e))return Iu();{e.filter;const t=e.filter;t.targetId;const i=t.count||0,s=new Qf(i),r=t.targetId;n=new vp(r,s)}}var i;return n}(this.It,t),n=function(t){if(!("targetChange"in t))return $u.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?$u.min():e.readTime?Mp(e.readTime):$u.min()}(t);return this.listener.Wo(e,n)}zo(t){const e={};e.database=Lp(this.It),e.addTarget=function(t,e){let n;const i=e.target;return n=qd(i)?{documents:Up(t,i)}:{query:jp(t,i)},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Cp(t,e.resumeToken):e.snapshotVersion.compareTo($u.min())>0&&(n.readTime=Ip(t,e.snapshotVersion.toTimestamp())),n}(this.It,t);const n=function(t,e){const n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Iu()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.It,t);n&&(e.labels=n),this.Bo(e)}Ho(t){const e={};e.database=Lp(this.It),e.removeTarget=t,this.Bo(e)}}class jg extends Fg{constructor(t,e,n,i,s,r){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,i,r),this.It=s,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(t,e){return this.Vo._o("Write",t,e)}onMessage(t){if(Cu(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function(t,e){return t&&t.length>0?(Cu(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Mp(t.updateTime):Mp(e);return n.isEqual($u.min())&&(n=Mp(e)),new Nf(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Mp(t.commitTime);return this.listener.Zo(n,e)}return Cu(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=Lp(this.It),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof Wf)n={update:Fp(t,e.key,e.value)};else if(e instanceof Yf)n={delete:Pp(t,e.key)};else if(e instanceof $f)n={update:Fp(t,e.key,e.data),updateMask:Yp(e.fieldMask)};else{if(!(e instanceof Xf))return Iu();n={verify:Pp(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof If)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Cf)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Mf)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Of)return{fieldPath:e.field.canonicalString(),increment:n.yt};throw Iu()}(0,t)))),e.precondition.isNone||(n.currentDocument=(i=t,void 0!==(s=e.precondition).updateTime?{updateTime:Ap(i,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:Iu())),n;var i,s}(this.It,t)))};this.Bo(e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.Vo=n,this.It=i,this.nu=!1}su(){if(this.nu)throw new Du(Mu.FAILED_PRECONDITION,"The client has already been terminated.")}co(t,e,n){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.Vo.co(t,e,n,i,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Mu.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Du(Mu.UNKNOWN,t.toString())}))}fo(t,e,n,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,r])=>this.Vo.fo(t,e,n,s,r,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Mu.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Du(Mu.UNKNOWN,t.toString())}))}terminate(){this.nu=!0}}class zg{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve()))))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Eu(e),this.ou=!1):Su("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(t,e,n,i,s){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=s,this.mu.qr((t=>{n.enqueueAndForget((async()=>{Jg(this)&&(Su("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=Au(t);e._u.add(4),await $g(e),e.gu.set("Unknown"),e._u.delete(4),await Wg(e)}(this))}))})),this.gu=new zg(n,i)}}async function Wg(t){if(Jg(t))for(const e of t.wu)await e(!0)}async function $g(t){for(const e of t.wu)await e(!1)}function qg(t,e){const n=Au(t);n.du.has(e.targetId)||(n.du.set(e.targetId,e),Qg(n)?Xg(n):gm(n).ko()&&Gg(n,e))}function Kg(t,e){const n=Au(t),i=gm(n);n.du.delete(e),i.ko()&&Yg(n,e),0===n.du.size&&(i.ko()?i.Fo():Jg(n)&&n.gu.set("Unknown"))}function Gg(t,e){t.yu.Ot(e.targetId),gm(t).zo(e)}function Yg(t,e){t.yu.Ot(e),gm(t).Ho(e)}function Xg(t){t.yu=new wp({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),se:e=>t.du.get(e)||null}),gm(t).start(),t.gu.uu()}function Qg(t){return Jg(t)&&!gm(t).No()&&t.du.size>0}function Jg(t){return 0===Au(t)._u.size}function Zg(t){t.yu=void 0}async function tm(t){t.du.forEach(((e,n)=>{Gg(t,e)}))}async function em(t,e){Zg(t),Qg(t)?(t.gu.hu(e),Xg(t)):t.gu.set("Unknown")}async function nm(t,e,n){if(t.gu.set("Online"),e instanceof bp&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.du.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.du.delete(i),t.yu.removeTarget(i))}(t,e)}catch(i){Su("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await im(t,i)}else if(e instanceof yp?t.yu.Gt(e):e instanceof vp?t.yu.Yt(e):t.yu.Wt(e),!n.isEqual($u.min()))try{const e=await Sg(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.yu.te(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const s=t.du.get(i);s&&t.du.set(i,s.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((e=>{const n=t.du.get(e);if(!n)return;t.du.set(e,n.withResumeToken(fd.EMPTY_BYTE_STRING,n.snapshotVersion)),Yg(t,e);const i=new tg(n.target,e,1,n.sequenceNumber);Gg(t,i)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(s){Su("RemoteStore","Failed to raise snapshot:",s),await im(t,s)}}async function im(t,e,n){if(!nd(e))throw e;t._u.add(1),await $g(t),t.gu.set("Offline"),n||(n=()=>Sg(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Su("RemoteStore","Retrying IndexedDB access"),await n(),t._u.delete(1),await Wg(t)}))}function sm(t,e){return e().catch((n=>im(t,n,e)))}async function rm(t){const e=Au(t),n=mm(e);let i=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;om(e);)try{const t=await Tg(e.localStore,i);if(null===t){0===e.fu.length&&n.Fo();break}i=t.batchId,am(e,t)}catch(s){await im(e,s)}cm(e)&&hm(e)}function om(t){return Jg(t)&&t.fu.length<10}function am(t,e){t.fu.push(e);const n=mm(t);n.ko()&&n.Yo&&n.Xo(e.mutations)}function cm(t){return Jg(t)&&!mm(t).No()&&t.fu.length>0}function hm(t){mm(t).start()}async function lm(t){mm(t).eu()}async function um(t){const e=mm(t);for(const n of t.fu)e.Xo(n.mutations)}async function dm(t,e,n){const i=t.fu.shift(),s=Jp.from(i,e,n);await sm(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await rm(t)}async function fm(t,e){e&&mm(t).Yo&&await async function(t,e){if(function(t){switch(t){default:return Iu();case Mu.CANCELLED:case Mu.UNKNOWN:case Mu.DEADLINE_EXCEEDED:case Mu.RESOURCE_EXHAUSTED:case Mu.INTERNAL:case Mu.UNAVAILABLE:case Mu.UNAUTHENTICATED:return!1;case Mu.INVALID_ARGUMENT:case Mu.NOT_FOUND:case Mu.ALREADY_EXISTS:case Mu.PERMISSION_DENIED:case Mu.FAILED_PRECONDITION:case Mu.ABORTED:case Mu.OUT_OF_RANGE:case Mu.UNIMPLEMENTED:case Mu.DATA_LOSS:return!0}}(n=e.code)&&n!==Mu.ABORTED){const n=t.fu.shift();mm(t).Oo(),await sm(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await rm(t)}var n}(t,e),cm(t)&&hm(t)}async function pm(t,e){const n=Au(t);n.asyncQueue.verifyOperationInProgress(),Su("RemoteStore","RemoteStore received new credentials");const i=Jg(n);n._u.add(3),await $g(n),i&&n.gu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n._u.delete(3),await Wg(n)}function gm(t){return t.pu||(t.pu=function(t,e,n){const i=Au(t);return i.su(),new Ug(e,i.Vo,i.authCredentials,i.appCheckCredentials,i.It,n)}(t.datastore,t.asyncQueue,{Yr:tm.bind(null,t),Zr:em.bind(null,t),Wo:nm.bind(null,t)}),t.wu.push((async e=>{e?(t.pu.Oo(),Qg(t)?Xg(t):t.gu.set("Unknown")):(await t.pu.stop(),Zg(t))}))),t.pu}function mm(t){return t.Iu||(t.Iu=function(t,e,n){const i=Au(t);return i.su(),new jg(e,i.Vo,i.authCredentials,i.appCheckCredentials,i.It,n)}(t.datastore,t.asyncQueue,{Yr:lm.bind(null,t),Zr:fm.bind(null,t),tu:um.bind(null,t),Zo:dm.bind(null,t)}),t.wu.push((async e=>{e?(t.Iu.Oo(),await rm(t)):(await t.Iu.stop(),t.fu.length>0&&(Su("RemoteStore",`Stopping write stream with ${t.fu.length} pending writes`),t.fu=[]))}))),t.Iu
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class ym{constructor(t,e,n,i,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Ou,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,s){const r=Date.now()+n,o=new ym(t,e,r,i,s);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Du(Mu.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vm(t,e){if(Eu("AsyncQueue",`${e}: ${t}`),nd(t))return new Du(Mu.UNAVAILABLE,`${e}: ${t}`);throw t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Xu.comparator(e.key,n.key):(t,e)=>Xu.comparator(t.key,e.key),this.keyedMap=rp(),this.sortedSet=new ad(this.comparator)}static emptySet(t){return new bm(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof bm))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new bm;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(){this.Tu=new ad(Xu.comparator)}track(t){const e=t.doc.key,n=this.Tu.get(e);n?0!==t.type&&3===n.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==n.type?this.Tu=this.Tu.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Tu=this.Tu.remove(e):1===t.type&&2===n.type?this.Tu=this.Tu.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):Iu():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal(((e,n)=>{t.push(n)})),t}}class wm{constructor(t,e,n,i,s,r,o,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=r,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(t,e,n,i){const s=[];return e.forEach((t=>{s.push({type:0,doc:t})})),new wm(t,e,bm.emptySet(e),s,n,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&pf(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(){this.Au=void 0,this.listeners=[]}}class Sm{constructor(){this.queries=new ep((t=>gf(t)),pf),this.onlineState="Unknown",this.Ru=new Set}}function Em(t,e){const n=Au(t);let i=!1;for(const s of e){const t=s.query,e=n.queries.get(t);if(e){for(const t of e.listeners)t.Pu(s)&&(i=!0);e.Au=s}}i&&km(n)}function Tm(t,e,n){const i=Au(t),s=i.queries.get(e);if(s)for(const r of s.listeners)r.onError(n);i.queries.delete(e)}function km(t){t.Ru.forEach((t=>{t.next()}))}class Im{constructor(t,e,n){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=n||{}}Pu(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new wm(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return!(this.options.Nu&&n||t.docs.isEmpty()&&"Offline"!==e)}Du(t){if(t.docChanges.length>0)return!0;const e=this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}xu(t){t=wm.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Vu=!0,this.vu.next(t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(t){this.key=t}}class Am{constructor(t){this.key=t}}class Mm{constructor(t,e){this.query=t,this.Lu=e,this.Uu=null,this.current=!1,this.qu=dp(),this.mutatedKeys=dp(),this.Ku=vf(t),this.Gu=new bm(this.Ku)}get Qu(){return this.Lu}ju(t,e){const n=e?e.Wu:new _m,i=e?e.Gu:this.Gu;let s=e?e.mutatedKeys:this.mutatedKeys,r=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const h=i.get(t),l=yf(this.query,e)?e:null,u=!!h&&this.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;h&&l?h.data.isEqual(l.data)?u!==d&&(n.track({type:3,doc:l}),f=!0):this.zu(h,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.Ku(l,a)>0||c&&this.Ku(l,c)<0)&&(o=!0)):!h&&l?(n.track({type:0,doc:l}),f=!0):h&&!l&&(n.track({type:1,doc:h}),f=!0,(a||c)&&(o=!0)),f&&(l?(r=r.add(l),s=d?s.add(t):s.delete(t)):(r=r.delete(t),s=s.delete(t)))})),null!==this.query.limit)for(;r.size>this.query.limit;){const t="F"===this.query.limitType?r.last():r.first();r=r.delete(t.key),s=s.delete(t.key),n.track({type:1,doc:t})}return{Gu:r,Wu:n,$i:o,mutatedKeys:s}}zu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n){const i=this.Gu;this.Gu=t.Gu,this.mutatedKeys=t.mutatedKeys;const s=t.Wu.Eu();s.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Iu()}};return n(t)-n(e)}(t.type,e.type)||this.Ku(t.doc,e.doc))),this.Hu(n);const r=e?this.Ju():[],o=0===this.qu.size&&this.current?1:0,a=o!==this.Uu;return this.Uu=o,0!==s.length||a?{snapshot:new wm(this.query,t.Gu,i,s,t.mutatedKeys,0===o,a,!1),Yu:r}:{Yu:r}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Gu:this.Gu,Wu:new _m,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Yu:[]}}Xu(t){return!this.Lu.has(t)&&!!this.Gu.has(t)&&!this.Gu.get(t).hasLocalMutations}Hu(t){t&&(t.addedDocuments.forEach((t=>this.Lu=this.Lu.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.Lu=this.Lu.delete(t))),this.current=t.current)}Ju(){if(!this.current)return[];const t=this.qu;this.qu=dp(),this.Gu.forEach((t=>{this.Xu(t.key)&&(this.qu=this.qu.add(t.key))}));const e=[];return t.forEach((t=>{this.qu.has(t)||e.push(new Am(t))})),this.qu.forEach((n=>{t.has(n)||e.push(new Cm(n))})),e}Zu(t){this.Lu=t.Hi,this.qu=dp();const e=this.ju(t.documents);return this.applyChanges(e,!0)}tc(){return wm.fromInitialDocuments(this.query,this.Gu,this.mutatedKeys,0===this.Uu)}}class Dm{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Om{constructor(t){this.key=t,this.ec=!1}}class Pm{constructor(t,e,n,i,s,r){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=r,this.nc={},this.sc=new ep((t=>gf(t)),pf),this.ic=new Map,this.rc=new Set,this.oc=new ad(Xu.comparator),this.uc=new Map,this.cc=new lg,this.ac={},this.hc=new Map,this.lc=rg.vn(),this.onlineState="Unknown",this.fc=void 0}get isPrimaryClient(){return!0===this.fc}}async function Rm(t,e){const n=function(t){const e=Au(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Vm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Qm.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Um.bind(null,e),e.nc.Wo=Em.bind(null,e.eventManager),e.nc._c=Tm.bind(null,e.eventManager),e}(t);let i,s;const r=n.sc.get(e);if(r)i=r.targetId,n.sharedClientState.addLocalQueryTarget(i),s=r.view.tc();else{const t=await function(t,e){const n=Au(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.Cs.getTargetData(t,e).next((s=>s?(i=s,ed.resolve(i)):n.Cs.allocateTargetId(t).next((s=>(i=new tg(e,s,0,t.currentSequenceNumber),n.Cs.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.Ui.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ui=n.Ui.insert(t.targetId,t),n.qi.set(e,t.targetId)),t}))}(n.localStore,df(e));n.isPrimaryClient&&qg(n.remoteStore,t);const r=n.sharedClientState.addLocalQueryTarget(t.targetId);i=t.targetId,s=await async function(t,e,n,i){t.dc=(e,n,i)=>async function(t,e,n,i){let s=e.view.ju(n);s.$i&&(s=await Ig(t.localStore,e.query,!1).then((({documents:t})=>e.view.ju(t,s))));const r=i&&i.targetChanges.get(e.targetId),o=e.view.applyChanges(s,t.isPrimaryClient,r);return qm(t,e.targetId,o.Yu),o.snapshot}(t,e,n,i);const s=await Ig(t.localStore,e,!0),r=new Mm(e,s.Hi),o=r.ju(s.documents),a=mp.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState),c=r.applyChanges(o,t.isPrimaryClient,a);qm(t,n,c.Yu);const h=new Dm(e,n,r);return t.sc.set(e,h),t.ic.has(n)?t.ic.get(n).push(e):t.ic.set(n,[e]),c.snapshot}(n,e,i,"current"===r)}return s}async function Nm(t,e){const n=Au(t),i=n.sc.get(e),s=n.ic.get(i.targetId);if(s.length>1)return n.ic.set(i.targetId,s.filter((t=>!pf(t,e)))),void n.sc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await kg(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),Kg(n.remoteStore,i.targetId),Wm(n,i.targetId)})).catch(td)):(Wm(n,i.targetId),await kg(n.localStore,i.targetId,!0))}async function Lm(t,e,n){const i=function(t){const e=Au(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jm.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Bm.bind(null,e),e}(t);try{const t=await function(t,e){const n=Au(t),i=Wu.now(),s=e.reduce(((t,e)=>t.add(e.key)),dp());let r,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=ip(),c=dp();return n.Gi.getEntries(t,s).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(c=c.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((s=>{r=s;const o=[];for(const t of e){const e=zf(t,r.get(t.key).overlayedDocument);null!=e&&o.push(new $f(t.key,e,jd(e.value.mapValue),Lf.exists(!0)))}return n.mutationQueue.addMutationBatch(t,i,o,e)})).next((e=>{o=e;const i=e.applyToLocalDocumentSet(r,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,i)}))})).then((()=>({batchId:o.batchId,changes:op(r)})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.ac[t.currentUser.toKey()];i||(i=new ad(zu)),i=i.insert(e,n),t.ac[t.currentUser.toKey()]=i}(i,t.batchId,n),await Ym(i,t.changes),await rm(i.remoteStore)}catch(s){const t=vm(s,"Failed to persist write");n.reject(t)}}async function Vm(t,e){const n=Au(t);try{const t=await Eg(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.uc.get(e);i&&(Cu(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.ec=!0:t.modifiedDocuments.size>0?Cu(i.ec):t.removedDocuments.size>0&&(Cu(i.ec),i.ec=!1))})),await Ym(n,t,e)}catch(i){await td(i)}}function Fm(t,e,n){const i=Au(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.sc.forEach(((n,i)=>{const s=i.view.bu(e);s.snapshot&&t.push(s.snapshot)})),function(t,e){const n=Au(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const s of n.listeners)s.bu(e)&&(i=!0)})),i&&km(n)}(i.eventManager,e),t.length&&i.nc.Wo(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Um(t,e,n){const i=Au(t);i.sharedClientState.updateQueryState(e,"rejected",n);const s=i.uc.get(e),r=s&&s.key;if(r){let t=new ad(Xu.comparator);t=t.insert(r,Bd.newNoDocument(r,$u.min()));const n=dp().add(r),s=new gp($u.min(),new Map,new ld(zu),t,n);await Vm(i,s),i.oc=i.oc.remove(r),i.uc.delete(e),Gm(i)}else await kg(i.localStore,e,!1).then((()=>Wm(i,e,n))).catch(td)}async function jm(t,e){const n=Au(t),i=e.batch.batchId;try{const t=await function(t,e){const n=Au(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),s=n.Gi.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const s=n.batch,r=s.keys();let o=ed.resolve();return r.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const r=n.docVersions.get(t);Cu(null!==r),e.version.compareTo(r)<0&&(s.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),i.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,s)))}(n,t,e,s).next((()=>s.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=dp();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(n.localStore,e);Hm(n,i,null),zm(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Ym(n,t)}catch(s){await td(s)}}async function Bm(t,e,n){const i=Au(t);try{const t=await function(t,e){const n=Au(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(Cu(null!==e),i=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,i,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,i))).next((()=>n.localDocuments.getDocuments(t,i)))}))}(i.localStore,e);Hm(i,e,n),zm(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Ym(i,t)}catch(s){await td(s)}}function zm(t,e){(t.hc.get(e)||[]).forEach((t=>{t.resolve()})),t.hc.delete(e)}function Hm(t,e,n){const i=Au(t);let s=i.ac[i.currentUser.toKey()];if(s){const t=s.get(e);t&&(n?t.reject(n):t.resolve(),s=s.remove(e)),i.ac[i.currentUser.toKey()]=s}}function Wm(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.ic.get(e))t.sc.delete(i),n&&t.nc._c(i,n);t.ic.delete(e),t.isPrimaryClient&&t.cc.ls(e).forEach((e=>{t.cc.containsKey(e)||$m(t,e)}))}function $m(t,e){t.rc.delete(e.path.canonicalString());const n=t.oc.get(e);null!==n&&(Kg(t.remoteStore,n),t.oc=t.oc.remove(e),t.uc.delete(n),Gm(t))}function qm(t,e,n){for(const i of n)i instanceof Cm?(t.cc.addReference(i.key,e),Km(t,i)):i instanceof Am?(Su("SyncEngine","Document no longer in limbo: "+i.key),t.cc.removeReference(i.key,e),t.cc.containsKey(i.key)||$m(t,i.key)):Iu()}function Km(t,e){const n=e.key,i=n.path.canonicalString();t.oc.get(n)||t.rc.has(i)||(Su("SyncEngine","New document in limbo: "+n),t.rc.add(i),Gm(t))}function Gm(t){for(;t.rc.size>0&&t.oc.size<t.maxConcurrentLimboResolutions;){const e=t.rc.values().next().value;t.rc.delete(e);const n=new Xu(Ku.fromString(e)),i=t.lc.next();t.uc.set(i,new Om(n)),t.oc=t.oc.insert(n,i),qg(t.remoteStore,new tg(df(hf(n.path)),i,2,id.at))}}async function Ym(t,e,n){const i=Au(t),s=[],r=[],o=[];i.sc.isEmpty()||(i.sc.forEach(((t,a)=>{o.push(i.dc(a,e,n).then((t=>{if(t){i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),s.push(t);const e=bg.Ci(a.targetId,t);r.push(e)}})))})),await Promise.all(o),i.nc.Wo(s),await async function(t,e){const n=Au(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>ed.forEach(e,(e=>ed.forEach(e.Si,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>ed.forEach(e.Di,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(i){if(!nd(i))throw i;Su("LocalStore","Failed to update sequence numbers: "+i)}for(const s of e){const t=s.targetId;if(!s.fromCache){const e=n.Ui.get(t),i=e.snapshotVersion,s=e.withLastLimboFreeSnapshotVersion(i);n.Ui=n.Ui.insert(t,s)}}}(i.localStore,r))}async function Xm(t,e){const n=Au(t);if(!n.currentUser.isEqual(e)){Su("SyncEngine","User change. New user:",e.toKey());const t=await xg(n.localStore,e);n.currentUser=e,(i=n).hc.forEach((t=>{t.forEach((t=>{t.reject(new Du(Mu.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),i.hc.clear(),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Ym(n,t.ji)}var i}function Qm(t,e){const n=Au(t),i=n.uc.get(e);if(i&&i.ec)return dp().add(i.key);{let t=dp();const i=n.ic.get(e);if(!i)return t;for(const e of i){const i=n.sc.get(e);t=t.unionWith(i.view.Qu)}return t}}class Jm{constructor(){this.synchronizeTabs=!1}async initialize(t){this.It=Lg(t.databaseInfo.databaseId),this.sharedClientState=this.mc(t),this.persistence=this.gc(t),await this.persistence.start(),this.localStore=this.yc(t),this.gcScheduler=this.Ic(t,this.localStore),this.indexBackfillerScheduler=this.Tc(t,this.localStore)}Ic(t,e){return null}Tc(t,e){return null}yc(t){return function(t,e,n,i){return new wg(t,e,n,i)}(this.persistence,new _g,t.initialUser,this.It)}gc(t){return new mg(vg.Bs,this.It)}mc(t){return new Ag}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Zm{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Fm(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Xm.bind(null,this.syncEngine),await async function(t,e){const n=Au(t);e?(n._u.delete(2),await Wg(n)):e||(n._u.add(2),await $g(n),n.gu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Sm}createDatastore(t){const e=Lg(t.databaseInfo.databaseId),n=(i=t.databaseInfo,new Rg(i));var i,s,r;return s=t.authCredentials,r=t.appCheckCredentials,new Bg(s,r,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,s=t=>Fm(this.syncEngine,t,0),r=Dg.C()?new Dg:new Mg,new Hg(e,n,i,s,r);var e,n,i,s,r}createSyncEngine(t,e){return function(t,e,n,i,s,r,o){const a=new Pm(t,e,n,i,s,r);return o&&(a.fc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=Au(t);Su("RemoteStore","RemoteStore shutting down."),e._u.add(5),await $g(e),e.mu.shutdown(),e.gu.set("Unknown")}(this.remoteStore)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ac(this.observer.next,t)}error(t){this.observer.error?this.Ac(this.observer.error,t):Eu("Uncaught Error in snapshot listener:",t)}Rc(){this.muted=!0}Ac(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=bu.UNAUTHENTICATED,this.clientId=Bu.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Su("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Su("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Du(Mu.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ou;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=vm(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function ny(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||(Su("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),Su("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await xg(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new Jm)),t.offlineComponents}(t);Su("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>pm(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>pm(e.remoteStore,n))),t.onlineComponents=e}async function iy(t){return t.onlineComponents||(Su("FirestoreClient","Using default OnlineComponentProvider"),await ny(t,new Zm)),t.onlineComponents}async function sy(t){const e=await iy(t),n=e.eventManager;return n.onListen=Rm.bind(null,e.syncEngine),n.onUnlisten=Nm.bind(null,e.syncEngine),n}function ry(t,e,n={}){const i=new Ou;return t.asyncQueue.enqueueAndForget((async()=>function(t,e,n,i,s){const r=new ty({next:n=>{e.enqueueAndForget((()=>async function(t,e){const n=Au(t),i=e.query;let s=!1;const r=n.queries.get(i);if(r){const t=r.listeners.indexOf(e);t>=0&&(r.listeners.splice(t,1),s=0===r.listeners.length)}if(s)return n.queries.delete(i),n.onUnlisten(i)}(t,o))),n.fromCache&&"server"===i.source?s.reject(new Du(Mu.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):s.resolve(n)},error:t=>s.reject(t)}),o=new Im(n,r,{includeMetadataChanges:!0,Nu:!0});return async function(e,n){const i=Au(e),s=n.query;let r=!1,o=i.queries.get(s);if(o||(r=!0,o=new xm),r)try{o.Au=await i.onListen(s)}catch(t){const i=vm(t,`Initialization of query '${mf(n.query)}' failed`);return void n.onError(i)}i.queries.set(s,o),o.listeners.push(n),n.bu(i.onlineState),o.Au&&n.Pu(o.Au)&&km(i)}(t,o)}(await sy(t),t.asyncQueue,e,n,i))),i.promise}const oy=new Map;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ay(t,e,n){if(!n)throw new Du(Mu.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function cy(t){if(!Xu.isDocumentKey(t))throw new Du(Mu.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function hy(t){if(Xu.isDocumentKey(t))throw new Du(Mu.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ly(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const n=(e=t).constructor?e.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var e;return"function"==typeof t?"a function":Iu()}function uy(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Du(Mu.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ly(t);throw new Du(Mu.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Du(Mu.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Du(Mu.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,i){if(!0===e&&!0===i)throw new Du(Mu.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(t,e,n,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dy({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Du(Mu.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Du(Mu.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dy(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Ru;switch(t.type){case"gapi":const e=t.client;return new Vu(e,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Du(Mu.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=oy.get(t);e&&(Su("ComponentProvider","Removing Datastore"),oy.delete(t),e.terminate())}(this),Promise.resolve()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new my(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new py(this.firestore,t,this._key)}}class gy{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new gy(this.firestore,t,this._query)}}class my extends gy{constructor(t,e,n){super(t,e,hf(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new py(this.firestore,null,new Xu(t))}withConverter(t){return new my(this.firestore,t,this._path)}}function yy(t,e,...n){if(t=Hi(t),ay("collection","path",e),t instanceof fy){const i=Ku.fromString(e,...n);return hy(i),new my(t,null,i)}{if(!(t instanceof py||t instanceof my))throw new Du(Mu.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Ku.fromString(e,...n));return hy(i),new my(t.firestore,null,i)}}function vy(t,e,...n){if(t=Hi(t),1===arguments.length&&(e=Bu.R()),ay("doc","path",e),t instanceof fy){const i=Ku.fromString(e,...n);return cy(i),new py(t,null,new Xu(i))}{if(!(t instanceof py||t instanceof my))throw new Du(Mu.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Ku.fromString(e,...n));return cy(i),new py(t.firestore,t instanceof my?t.converter:null,new Xu(i))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{constructor(){this.$c=Promise.resolve(),this.Bc=[],this.Lc=!1,this.Uc=[],this.qc=null,this.Kc=!1,this.Gc=!1,this.Qc=[],this.xo=new Vg(this,"async_queue_retry"),this.jc=()=>{const t=Ng();t&&Su("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.bo()};const t=Ng();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.jc)}get isShuttingDown(){return this.Lc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Wc(),this.zc(t)}enterRestrictedMode(t){if(!this.Lc){this.Lc=!0,this.Gc=t||!1;const e=Ng();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.jc)}}enqueue(t){if(this.Wc(),this.Lc)return new Promise((()=>{}));const e=new Ou;return this.zc((()=>this.Lc&&this.Gc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Bc.push(t),this.Hc())))}async Hc(){if(0!==this.Bc.length){try{await this.Bc[0](),this.Bc.shift(),this.xo.reset()}catch(t){if(!nd(t))throw t;Su("AsyncQueue","Operation failed with retryable error: "+t)}this.Bc.length>0&&this.xo.Ao((()=>this.Hc()))}}zc(t){const e=this.$c.then((()=>(this.Kc=!0,t().catch((t=>{this.qc=t,this.Kc=!1;throw Eu("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((t=>(this.Kc=!1,t))))));return this.$c=e,e}enqueueAfterDelay(t,e,n){this.Wc(),this.Qc.indexOf(t)>-1&&(e=0);const i=ym.createAndSchedule(this,t,e,n,(t=>this.Jc(t)));return this.Uc.push(i),i}Wc(){this.qc&&Iu()}verifyOperationInProgress(){}async Yc(){let t;do{t=this.$c,await t}while(t!==this.$c)}Xc(t){for(const e of this.Uc)if(e.timerId===t)return!0;return!1}Zc(t){return this.Yc().then((()=>{this.Uc.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.Uc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Yc()}))}ta(t){this.Qc.push(t)}Jc(t){const e=this.Uc.indexOf(t);this.Uc.splice(e,1)}}class _y extends fy{constructor(t,e,n,i){super(t,e,n,i),this.type="firestore",this._queue=new by,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Sy(this),this._firestoreClient.terminate()}}function wy(t,e){const n="string"==typeof t?t:e||"(default)";return Es("object"==typeof t?t:Cs(),"firestore").getImmediate({identifier:n})}function xy(t){return t._firestoreClient||Sy(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Sy(t){var e;const n=t._freezeSettings(),i=(s=t._databaseId,r=(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",o=t._persistenceKey,new wd(s,r,o,(a=n).host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams));var s,r,o,a;t._firestoreClient=new ey(t._authCredentials,t._appCheckCredentials,t._queue,i)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Du(Mu.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Yu(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ty(fd.fromBase64String(t))}catch(e){throw new Du(Mu.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Ty(fd.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(t){this._methodName=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Du(Mu.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Du(Mu.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return zu(this._lat,t._lat)||zu(this._long,t._long)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cy=/^__.*__$/;class Ay{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new $f(t,this.data,this.fieldMask,e,this.fieldTransforms):new Wf(t,this.data,e,this.fieldTransforms)}}function My(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Iu()}}class Dy{constructor(t,e,n,i,s,r){this.settings=t,this.databaseId=e,this.It=n,this.ignoreUndefinedProperties=i,void 0===s&&this.ea(),this.fieldTransforms=s||[],this.fieldMask=r||[]}get path(){return this.settings.path}get na(){return this.settings.na}sa(t){return new Dy(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ia(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.sa({path:n,ra:!1});return i.oa(t),i}ua(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.sa({path:n,ra:!1});return i.ea(),i}ca(t){return this.sa({path:void 0,ra:!0})}aa(t){return zy(t,this.settings.methodName,this.settings.ha||!1,this.path,this.settings.la)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}ea(){if(this.path)for(let t=0;t<this.path.length;t++)this.oa(this.path.get(t))}oa(t){if(0===t.length)throw this.aa("Document fields must not be empty");if(My(this.na)&&Cy.test(t))throw this.aa('Document fields cannot begin and end with "__"')}}class Oy{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.It=n||Lg(t)}fa(t,e,n,i=!1){return new Dy({na:t,methodName:e,la:n,path:Yu.emptyPath(),ra:!1,ha:i},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Py(t){const e=t._freezeSettings(),n=Lg(t._databaseId);return new Oy(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ry(t,e,n,i,s,r={}){const o=t.fa(r.merge||r.mergeFields?2:0,e,n,s);Fy("Data must be an object, but it was:",o,i);const a=Ly(i,o);let c,h;if(r.merge)c=new dd(o.fieldMask),h=o.fieldTransforms;else if(r.mergeFields){const t=[];for(const i of r.mergeFields){const s=Uy(e,i,n);if(!o.contains(s))throw new Du(Mu.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);Hy(t,s)||t.push(s)}c=new dd(t),h=o.fieldTransforms.filter((t=>c.covers(t.field)))}else c=null,h=o.fieldTransforms;return new Ay(new Ud(a),c,h)}function Ny(t,e){if(Vy(t=Hi(t)))return Fy("Unsupported field value:",e,t),Ly(t,e);if(t instanceof ky)return function(t,e){if(!My(e.na))throw e.aa(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.aa(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.ra&&4!==e.na)throw e.aa("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const s of t){let t=Ny(s,e.ca(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=Hi(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return xf(e.It,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Wu.fromDate(t);return{timestampValue:Ip(e.It,n)}}if(t instanceof Wu){const n=new Wu(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ip(e.It,n)}}if(t instanceof Iy)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ty)return{bytesValue:Cp(e.It,t._byteString)};if(t instanceof py){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.aa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Dp(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.aa(`Unsupported field value: ${ly(t)}`)}(t,e)}function Ly(t,e){const n={};return od(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):rd(t,((t,i)=>{const s=Ny(i,e.ia(t));null!=s&&(n[t]=s)})),{mapValue:{fields:n}}}function Vy(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Wu||t instanceof Iy||t instanceof Ty||t instanceof py||t instanceof ky)}function Fy(t,e,n){if(!Vy(n)||("object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))){const i=ly(n);throw"an object"===i?e.aa(t+" a custom object"):e.aa(t+" "+i)}var i}function Uy(t,e,n){if((e=Hi(e))instanceof Ey)return e._internalPath;if("string"==typeof e)return By(t,e);throw zy("Field path arguments must be of type string or ",t,!1,void 0,n)}const jy=new RegExp("[~\\*/\\[\\]]");function By(t,e,n){if(e.search(jy)>=0)throw zy(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ey(...e.split("."))._internalPath}catch(i){throw zy(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function zy(t,e,n,i,s){const r=i&&!i.isEmpty(),o=void 0!==s;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${i}`),o&&(c+=` in document ${s}`),c+=")"),new Du(Mu.INVALID_ARGUMENT,a+t+c)}function Hy(t,e){return t.some((t=>t.isEqual(e)))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(t,e,n,i,s){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new py(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new $y(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(qy("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class $y extends Wy{data(){return super.data()}}function qy(t,e){return"string"==typeof e?By(t,e):e instanceof Ey?e._internalPath:e._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Gy extends Wy{constructor(t,e,n,i,s,r){super(t,e,n,i,r),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Yy(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(qy("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class Yy extends Gy{data(t={}){return super.data(t)}}class Xy{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Ky(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new Yy(this._firestore,this._userDataWriter,n.key,n,new Ky(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Du(Mu.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>({type:"added",doc:new Yy(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Ky(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:e++})))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new Yy(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Ky(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let s=-1,r=-1;return 0!==e.type&&(s=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),r=n.indexOf(e.doc.key)),{type:Qy(e.type),doc:i,oldIndex:s,newIndex:r}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Qy(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Iu()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy extends
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class{convertValue(t,e="none"){switch(kd(t)){case 0:return null;case 1:return t.booleanValue;case 2:return md(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(yd(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Iu()}}convertObject(t,e){const n={};return rd(t.fields,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new Iy(md(t.latitude),md(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=bd(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(_d(t));default:return null}}convertTimestamp(t){const e=gd(t);return new Wu(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Ku.fromString(t);Cu(Xp(n));const i=new xd(n.get(1),n.get(3)),s=new Xu(n.popFirst(5));return i.isEqual(e)||Eu(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),s}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ty(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new py(this.firestore,null,e)}}function Zy(t){t=uy(t,gy);const e=uy(t.firestore,_y),n=xy(e),i=new Jy(e);return function(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new Du(Mu.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(t._query),ry(n,t._query).then((n=>new Xy(e,i,t,n)))}function tv(t){return nv(uy(t.firestore,_y),[new Yf(t._key,Lf.none())])}function ev(t,e){const n=uy(t.firestore,_y),i=vy(t),s=function(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}(t.converter,e);return nv(n,[Ry(Py(t.firestore),"addDoc",i._key,s,null!==t.converter,{}).toMutation(i._key,Lf.exists(!1))]).then((()=>i))}function nv(t,e){return function(t,e){const n=new Ou;return t.asyncQueue.enqueueAndForget((async()=>Lm(await function(t){return iy(t).then((t=>t.syncEngine))}(t),e,n))),n.promise}(xy(t),e)}function iv(t){var e={exports:{}};return t(e,e.exports),e.exports}!function(t,e=!0){_u="9.9.4",Ss(new Wi("firestore",((t,{instanceIdentifier:n,options:i})=>{const s=t.getProvider("app").getImmediate(),r=new _y(new Nu(t.getProvider("auth-internal")),new Uu(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Du(Mu.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xd(t.options.projectId,e)}(s,n),s);return i=Object.assign({useFetchStreams:e},i),r._setSettings(i),r}),"PUBLIC").setMultipleInstances(!0)),As(vu,"3.4.15",t),As(vu,"3.4.15","esm2017")}();var sv=iv((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
e.__assign=function(){return e.__assign=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},e.__assign.apply(this,arguments)},e.__read=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,s,r=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o},e.__rest=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]])}return n},e.__spreadArray=function(t,e,n){if(n||2===arguments.length)for(var i,s=0,r=e.length;s<r;s++)!i&&s in e||(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))},e.__values=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}})),rv=Object.defineProperty({IS_PRODUCTION:true},"__esModule",{value:!0}),ov={},av=sv,cv=Object.defineProperty({DEFAULT_GUARD_TYPE:"xstate.guard",EMPTY_ACTIVITY_MAP:ov,STATE_DELIMITER:".",TARGETLESS_KEY:""},"__esModule",{value:!0}),hv=rv,lv=iv((function(t,e){function n(t){return Object.keys(t)}function i(t,e){try{return d(t)?t:t.toString().split(e)}catch(n){throw new Error("'".concat(t,"' is not a valid state path."))}}function s(t){return"object"==typeof t&&"value"in t&&"context"in t&&"event"in t&&"_event"in t}function r(t,e){return s(t)?t.value:d(t)?o(t):"string"!=typeof t?t:o(i(t,e))}function o(t){if(1===t.length)return t[0];for(var e={},n=e,i=0;i<t.length-1;i++)i===t.length-2?n[t[i]]=t[i+1]:(n[t[i]]={},n=n[t[i]]);return e}function a(t,e){for(var i={},s=n(t),r=0;r<s.length;r++){var o=s[r];i[o]=e(t[o],o,t,r)}return i}Object.defineProperty(e,"__esModule",{value:!0});function c(t){var e;return(e=[]).concat.apply(e,av.__spreadArray([],av.__read(t),!1))}function h(t){return d(t)?t:[t]}function l(t){return void 0===t?[]:h(t)}function u(t,e){return a(t.states,(function(t,n){if(t){var i=(p(e)?void 0:e[n])||(t?t.current:void 0);if(i)return{current:i,states:u(t,i)}}}))}function d(t){return Array.isArray(t)}function f(t){return"function"==typeof t}function p(t){return"string"==typeof t}e.warn=function(){},hv.IS_PRODUCTION||(e.warn=function(t,e){var n=t instanceof Error?t:void 0;if((n||!t)&&void 0!==console){var i=["Warning: ".concat(e)];n&&i.push(n),console.warn.apply(console,i)}});var g=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function m(t){try{return"__xstatenode"in t}catch(e){return!1}}var y=function(){var t=0;return function(){return(++t).toString(16)}}();function v(t,e){return p(t)||"number"==typeof t?av.__assign({type:t},e):t}e.evaluateGuard=function(t,e,n,i,s){var r=t.options.guards,o={state:s,cond:e,_event:i};if(e.type===cv.DEFAULT_GUARD_TYPE)return((null==r?void 0:r[e.name])||e.predicate)(n,i.data,o);var a=r[e.type];if(!a)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return a(n,i.data,o)},e.flatten=c,e.getEventType=function(t){try{return p(t)||"number"==typeof t?"".concat(t):t.type}catch(e){throw new Error("Events must be strings or objects with a string event.type property.")}},e.isActor=function(t){return!!t&&"function"==typeof t.send},e.isArray=d,e.isBehavior=function(t){return null!==t&&"object"==typeof t&&"transition"in t&&"function"==typeof t.transition},e.isBuiltInEvent=function(t){return/^(done|error)\./.test(t)},e.isFunction=f,e.isMachine=m,e.isObservable=function(t){try{return"subscribe"in t&&f(t.subscribe)}catch(e){return!1}},e.isPromiseLike=function(t){return t instanceof Promise||!(null===t||!f(t)&&"object"!=typeof t||!f(t.then))},e.isStateLike=s,e.isString=p,e.keys=n,e.mapContext=function(t,e,n){var i,s;if(f(t))return t(e,n.data);var r={};try{for(var o=av.__values(Object.keys(t)),a=o.next();!a.done;a=o.next()){var c=a.value,h=t[c];f(h)?r[c]=h(e,n.data):r[c]=h}}catch(l){i={error:l}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}return r},e.mapFilterValues=function(t,e,i){var s,r,o={};try{for(var a=av.__values(n(t)),c=a.next();!c.done;c=a.next()){var h=c.value,l=t[h];i(l)&&(o[h]=e(l,h,t))}}catch(u){s={error:u}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(s)throw s.error}}return o},e.mapValues=a,e.matchesState=function t(e,i,s){void 0===s&&(s=cv.STATE_DELIMITER);var o=r(e,s),a=r(i,s);return p(a)?!!p(o)&&a===o:p(o)?o in a:n(o).every((function(e){return e in a&&t(o[e],a[e])}))},e.nestedPath=function(t,e){return function(n){var i,s,r=n;try{for(var o=av.__values(t),a=o.next();!a.done;a=o.next()){var c=a.value;r=r[e][c]}}catch(h){i={error:h}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}return r}},e.normalizeTarget=function(t){if(void 0!==t&&t!==cv.TARGETLESS_KEY)return l(t)},e.partition=function(t,e){var n,i,s=av.__read([[],[]],2),r=s[0],o=s[1];try{for(var a=av.__values(t),c=a.next();!c.done;c=a.next()){var h=c.value;e(h)?r.push(h):o.push(h)}}catch(l){n={error:l}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return[r,o]},e.path=function(t){return function(e){var n,i,s=e;try{for(var r=av.__values(t),o=r.next();!o.done;o=r.next()){s=s[o.value]}}catch(a){n={error:a}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return s}},e.pathToStateValue=o,e.reportUnhandledExceptionOnInvocation=function(t,e,n){if(!hv.IS_PRODUCTION){var i=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";if(t===e)console.error("Missing onError handler for invocation '".concat(n,"', error was '").concat(t,"'.").concat(i));else{var s=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(n,"'. ")+"Original error: '".concat(t,"'. ").concat(i," Current error is '").concat(e,"'.").concat(s))}}},e.symbolObservable=g,e.toArray=l,e.toArrayStrict=h,e.toEventObject=v,e.toGuard=function(t,e){if(t)return p(t)?{type:cv.DEFAULT_GUARD_TYPE,name:t,predicate:e?e[t]:void 0}:f(t)?{type:cv.DEFAULT_GUARD_TYPE,name:t.name,predicate:t}:t},e.toInvokeSource=function(t){return"string"==typeof t?{type:t}:t},e.toObserver=function(t,e,n){if("object"==typeof t)return t;var i=function(){};return{next:t,error:e||i,complete:n||i}},e.toSCXMLEvent=function(t,e){if(!p(t)&&"$$type"in t&&"scxml"===t.$$type)return t;var n=v(t);return av.__assign({name:n.type,data:n,$$type:"scxml",type:"external"},e)},e.toStatePath=i,e.toStatePaths=function t(e){return e?p(e)?[[e]]:c(n(e).map((function(n){var i=e[n];return"string"==typeof i||i&&Object.keys(i).length?t(e[n]).map((function(t){return[n].concat(t)})):[[n]]}))):[[]]},e.toStateValue=r,e.toTransitionConfigArray=function(t,e){return h(e).map((function(e){return void 0===e||"string"==typeof e||m(e)?{target:e,event:t}:av.__assign(av.__assign({},e),{event:t})}))},e.uniqueId=y,e.updateContext=function(t,i,s,r){return hv.IS_PRODUCTION||e.warn(!!t,"Attempting to update undefined context"),t?s.reduce((function(t,e){var s,o,a=e.assignment,c={state:r,action:e,_event:i},h={};if(f(a))h=a(t,i.data,c);else try{for(var l=av.__values(n(a)),u=l.next();!u.done;u=l.next()){var d=u.value,p=a[d];h[d]=f(p)?p(t,i.data,c):p}}catch(g){s={error:g}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}return Object.assign({},t,h)}),t):t},e.updateHistoryStates=u,e.updateHistoryValue=function(t,e){return{current:e,states:u(t,e)}}})),uv=iv((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"}(e.ActionTypes||(e.ActionTypes={})),function(t){t.Parent="#_parent",t.Internal="#_internal"}(e.SpecialTargets||(e.SpecialTargets={}))})),dv=uv.ActionTypes.Start,fv=uv.ActionTypes.Stop,pv=uv.ActionTypes.Raise,gv=uv.ActionTypes.Send,mv=uv.ActionTypes.Cancel,yv=uv.ActionTypes.NullEvent,vv=uv.ActionTypes.Assign,bv=uv.ActionTypes.After,_v=uv.ActionTypes.DoneState,wv=uv.ActionTypes.Log,xv=uv.ActionTypes.Init,Sv=uv.ActionTypes.Invoke,Ev=uv.ActionTypes.ErrorExecution,Tv=uv.ActionTypes.ErrorPlatform,kv=uv.ActionTypes.ErrorCustom,Iv=uv.ActionTypes.Update,Cv=bv,Av=vv,Mv=mv,Dv=uv.ActionTypes.Choose,Ov=_v,Pv=kv,Rv=Ev,Nv=Tv,Lv=xv,Vv=Sv,Fv=wv,Uv=yv,jv=uv.ActionTypes.Pure,Bv=pv,zv=gv,Hv=dv,Wv=fv,$v=Iv,qv=lv,Kv=Object.defineProperty({after:Cv,assign:Av,cancel:Mv,choose:Dv,doneState:Ov,error:Pv,errorExecution:Rv,errorPlatform:Nv,init:Lv,invoke:Vv,log:Fv,nullEvent:Uv,pure:jv,raise:Bv,send:zv,start:Hv,stop:Wv,update:$v},"__esModule",{value:!0});Kv.init;var Gv=function(t,e){return{context:t,event:e}};var Yv=function(t){return{type:Kv.assign,assignment:t}},Xv=function(t,e){return void 0===t&&(t=Gv),{type:Kv.log,label:e,expr:t}},Qv=function(t,e){return{to:e?e.to:void 0,type:Kv.send,event:qv.isFunction(t)?t:qv.toEventObject(t),delay:e?e.delay:void 0,id:e&&void 0!==e.id?e.id:qv.isFunction(t)?t.name:qv.getEventType(t)}};
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const Jv=new WeakMap,Zv=window.navigator.userAgent.indexOf("Trident/")>0,tb=_((t=>e=>{if(!(e instanceof O))throw new Error("unsafeSVG can only be used in text bindings");const n=Jv.get(e);if(void 0!==n&&C(t)&&t===n.value&&e.value===n.fragment)return;const i=document.createElement("template"),s=i.content;let r;Zv?(i.innerHTML=`<svg>${t}</svg>`,r=s.firstChild):(r=document.createElementNS("http://www.w3.org/2000/svg","svg"),s.appendChild(r),r.innerHTML=t),s.removeChild(r),((t,e,n=null,i=null)=>{for(;e!==n;){const n=e.nextSibling;t.insertBefore(e,i),e=n}})(s,r.firstChild);const o=document.importNode(s,!0);e.setValue(o),Jv.set(e,{value:t,fragment:o})}));
/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */
function eb(){}const nb=function(){let t=0;return function(){return t++}}();function ib(t){return null==t}function sb(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.slice(0,7)&&"Array]"===e.slice(-6)}function rb(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}const ob=t=>("number"==typeof t||t instanceof Number)&&isFinite(+t);function ab(t,e){return ob(t)?t:e}function cb(t,e){return void 0===t?e:t}const hb=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function lb(t,e,n){if(t&&"function"==typeof t.call)return t.apply(n,e)}function ub(t,e,n,i){let s,r,o;if(sb(t))if(r=t.length,i)for(s=r-1;s>=0;s--)e.call(n,t[s],s);else for(s=0;s<r;s++)e.call(n,t[s],s);else if(rb(t))for(o=Object.keys(t),r=o.length,s=0;s<r;s++)e.call(n,t[o[s]],o[s])}function db(t,e){let n,i,s,r;if(!t||!e||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;++n)if(s=t[n],r=e[n],s.datasetIndex!==r.datasetIndex||s.index!==r.index)return!1;return!0}function fb(t){if(sb(t))return t.map(fb);if(rb(t)){const e=Object.create(null),n=Object.keys(t),i=n.length;let s=0;for(;s<i;++s)e[n[s]]=fb(t[n[s]]);return e}return t}function pb(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function gb(t,e,n,i){if(!pb(t))return;const s=e[t],r=n[t];rb(s)&&rb(r)?mb(s,r,i):e[t]=fb(r)}function mb(t,e,n){const i=sb(e)?e:[e],s=i.length;if(!rb(t))return t;const r=(n=n||{}).merger||gb;for(let o=0;o<s;++o){if(!rb(e=i[o]))continue;const s=Object.keys(e);for(let i=0,o=s.length;i<o;++i)r(s[i],t,e,n)}return t}function yb(t,e){return mb(t,e,{merger:vb})}function vb(t,e,n){if(!pb(t))return;const i=e[t],s=n[t];rb(i)&&rb(s)?yb(i,s):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=fb(s))}const bb={"":t=>t,x:t=>t.x,y:t=>t.y};function _b(t,e){return(bb[e]||(bb[e]=function(t){const e=function(t){const e=t.split("."),n=[];let i="";for(const s of e)i+=s,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}(t);return t=>{for(const n of e){if(""===n)break;t=t&&t[n]}return t}}(e)))(t)}function wb(t){return t.charAt(0).toUpperCase()+t.slice(1)}const xb=t=>void 0!==t,Sb=t=>"function"==typeof t,Eb=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};const Tb=Math.PI,kb=2*Tb,Ib=kb+Tb,Cb=Number.POSITIVE_INFINITY,Ab=Tb/180,Mb=Tb/2,Db=Tb/4,Ob=2*Tb/3,Pb=Math.log10,Rb=Math.sign;function Nb(t){const e=Math.round(t);t=Vb(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(Pb(t))),i=t/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function Lb(t){return!isNaN(parseFloat(t))&&isFinite(t)}function Vb(t,e,n){return Math.abs(t-e)<n}function Fb(t,e,n){let i,s,r;for(i=0,s=t.length;i<s;i++)r=t[i][n],isNaN(r)||(e.min=Math.min(e.min,r),e.max=Math.max(e.max,r))}function Ub(t){return t*(Tb/180)}function jb(t){return t*(180/Tb)}function Bb(t){if(!ob(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function zb(t,e){const n=e.x-t.x,i=e.y-t.y,s=Math.sqrt(n*n+i*i);let r=Math.atan2(i,n);return r<-.5*Tb&&(r+=kb),{angle:r,distance:s}}function Hb(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Wb(t,e){return(t-e+Ib)%kb-Tb}function $b(t){return(t%kb+kb)%kb}function qb(t,e,n,i){const s=$b(t),r=$b(e),o=$b(n),a=$b(r-s),c=$b(o-s),h=$b(s-r),l=$b(s-o);return s===r||s===o||i&&r===o||a>c&&h<l}function Kb(t,e,n){return Math.max(e,Math.min(n,t))}function Gb(t,e,n,i=1e-6){return t>=Math.min(e,n)-i&&t<=Math.max(e,n)+i}function Yb(t,e,n){n=n||(n=>t[n]<e);let i,s=t.length-1,r=0;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const Xb=(t,e,n,i)=>Yb(t,n,i?i=>t[i][e]<=n:i=>t[i][e]<n),Qb=(t,e,n)=>Yb(t,n,(i=>t[i][e]>=n));const Jb=["push","pop","shift","splice","unshift"];function Zb(t,e){const n=t._chartjs;if(!n)return;const i=n.listeners,s=i.indexOf(e);-1!==s&&i.splice(s,1),i.length>0||(Jb.forEach((e=>{delete t[e]})),delete t._chartjs)}function t_(t){const e=new Set;let n,i;for(n=0,i=t.length;n<i;++n)e.add(t[n]);return e.size===i?t:Array.from(e)}const e_="undefined"==typeof window?function(t){return t()}:window.requestAnimationFrame;function n_(t,e,n){const i=n||(t=>Array.prototype.slice.call(t));let s=!1,r=[];return function(...n){r=i(n),s||(s=!0,e_.call(window,(()=>{s=!1,t.apply(e,r)})))}}const i_=t=>"start"===t?"left":"end"===t?"right":"center",s_=(t,e,n)=>"start"===t?e:"end"===t?n:(e+n)/2;function r_(t,e,n){const i=e.length;let s=0,r=i;if(t._sorted){const{iScale:o,_parsed:a}=t,c=o.axis,{min:h,max:l,minDefined:u,maxDefined:d}=o.getUserBounds();u&&(s=Kb(Math.min(Xb(a,o.axis,h).lo,n?i:Xb(e,c,o.getPixelForValue(h)).lo),0,i-1)),r=d?Kb(Math.max(Xb(a,o.axis,l,!0).hi+1,n?0:Xb(e,c,o.getPixelForValue(l),!0).hi+1),s,i)-s:i-s}return{start:s,count:r}}function o_(t){const{xScale:e,yScale:n,_scaleRanges:i}=t,s={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!i)return t._scaleRanges=s,!0;const r=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,s),r}const a_=t=>0===t||1===t,c_=(t,e,n)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*kb/n),h_=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*kb/n)+1,l_={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*Mb),easeOutSine:t=>Math.sin(t*Mb),easeInOutSine:t=>-.5*(Math.cos(Tb*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>a_(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>a_(t)?t:c_(t,.075,.3),easeOutElastic:t=>a_(t)?t:h_(t,.075,.3),easeInOutElastic(t){const e=.1125;return a_(t)?t:t<.5?.5*c_(2*t,e,.45):.5+.5*h_(2*t-1,e,.45)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-l_.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,n=2.75;return t<1/n?e*t*t:t<2/n?e*(t-=1.5/n)*t+.75:t<2.5/n?e*(t-=2.25/n)*t+.9375:e*(t-=2.625/n)*t+.984375},easeInOutBounce:t=>t<.5?.5*l_.easeInBounce(2*t):.5*l_.easeOutBounce(2*t-1)+.5};
/*!
 * @kurkle/color v0.2.1
 * https://github.com/kurkle/color#readme
 * (c) 2022 Jukka Kurkela
 * Released under the MIT License
 */
function u_(t){return t+.5|0}const d_=(t,e,n)=>Math.max(Math.min(t,n),e);function f_(t){return d_(u_(2.55*t),0,255)}function p_(t){return d_(u_(255*t),0,255)}function g_(t){return d_(u_(t/2.55)/100,0,1)}function m_(t){return d_(u_(100*t),0,100)}const y_={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},v_=[..."0123456789ABCDEF"],b_=t=>v_[15&t],__=t=>v_[(240&t)>>4]+v_[15&t],w_=t=>(240&t)>>4==(15&t);function x_(t){var e=(t=>w_(t.r)&&w_(t.g)&&w_(t.b)&&w_(t.a))(t)?b_:__;return t?"#"+e(t.r)+e(t.g)+e(t.b)+((t,e)=>t<255?e(t):"")(t.a,e):void 0}const S_=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function E_(t,e,n){const i=e*Math.min(n,1-n),s=(e,s=(e+t/30)%12)=>n-i*Math.max(Math.min(s-3,9-s,1),-1);return[s(0),s(8),s(4)]}function T_(t,e,n){const i=(i,s=(i+t/60)%6)=>n-n*e*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function k_(t,e,n){const i=E_(t,1,.5);let s;for(e+n>1&&(s=1/(e+n),e*=s,n*=s),s=0;s<3;s++)i[s]*=1-e-n,i[s]+=e;return i}function I_(t){const e=t.r/255,n=t.g/255,i=t.b/255,s=Math.max(e,n,i),r=Math.min(e,n,i),o=(s+r)/2;let a,c,h;return s!==r&&(h=s-r,c=o>.5?h/(2-s-r):h/(s+r),a=function(t,e,n,i,s){return t===s?(e-n)/i+(e<n?6:0):e===s?(n-t)/i+2:(t-e)/i+4}(e,n,i,h,s),a=60*a+.5),[0|a,c||0,o]}function C_(t,e,n,i){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,i)).map(p_)}function A_(t,e,n){return C_(E_,t,e,n)}function M_(t){return(t%360+360)%360}function D_(t){const e=S_.exec(t);let n,i=255;if(!e)return;e[5]!==n&&(i=e[6]?f_(+e[5]):p_(+e[5]));const s=M_(+e[2]),r=+e[3]/100,o=+e[4]/100;return n="hwb"===e[1]?function(t,e,n){return C_(k_,t,e,n)}(s,r,o):"hsv"===e[1]?function(t,e,n){return C_(T_,t,e,n)}(s,r,o):A_(s,r,o),{r:n[0],g:n[1],b:n[2],a:i}}const O_={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},P_={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let R_;function N_(t){R_||(R_=function(){const t={},e=Object.keys(P_),n=Object.keys(O_);let i,s,r,o,a;for(i=0;i<e.length;i++){for(o=a=e[i],s=0;s<n.length;s++)r=n[s],a=a.replace(r,O_[r]);r=parseInt(P_[o],16),t[a]=[r>>16&255,r>>8&255,255&r]}return t}(),R_.transparent=[0,0,0,0]);const e=R_[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}const L_=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const V_=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,F_=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function U_(t,e,n){if(t){let i=I_(t);i[e]=Math.max(0,Math.min(i[e]+i[e]*n,0===e?360:1)),i=A_(i),t.r=i[0],t.g=i[1],t.b=i[2]}}function j_(t,e){return t?Object.assign(e||{},t):t}function B_(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=p_(t[3]))):(e=j_(t,{r:0,g:0,b:0,a:1})).a=p_(e.a),e}function z_(t){return"r"===t.charAt(0)?function(t){const e=L_.exec(t);let n,i,s,r=255;if(e){if(e[7]!==n){const t=+e[7];r=e[8]?f_(t):d_(255*t,0,255)}return n=+e[1],i=+e[3],s=+e[5],n=255&(e[2]?f_(n):d_(n,0,255)),i=255&(e[4]?f_(i):d_(i,0,255)),s=255&(e[6]?f_(s):d_(s,0,255)),{r:n,g:i,b:s,a:r}}}(t):D_(t)}class H_{constructor(t){if(t instanceof H_)return t;const e=typeof t;let n;var i,s,r;"object"===e?n=B_(t):"string"===e&&(r=(i=t).length,"#"===i[0]&&(4===r||5===r?s={r:255&17*y_[i[1]],g:255&17*y_[i[2]],b:255&17*y_[i[3]],a:5===r?17*y_[i[4]]:255}:7!==r&&9!==r||(s={r:y_[i[1]]<<4|y_[i[2]],g:y_[i[3]]<<4|y_[i[4]],b:y_[i[5]]<<4|y_[i[6]],a:9===r?y_[i[7]]<<4|y_[i[8]]:255})),n=s||N_(t)||z_(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=j_(this._rgb);return t&&(t.a=g_(t.a)),t}set rgb(t){this._rgb=B_(t)}rgbString(){return this._valid?(t=this._rgb)&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${g_(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`):void 0;var t}hexString(){return this._valid?x_(this._rgb):void 0}hslString(){return this._valid?function(t){if(!t)return;const e=I_(t),n=e[0],i=m_(e[1]),s=m_(e[2]);return t.a<255?`hsla(${n}, ${i}%, ${s}%, ${g_(t.a)})`:`hsl(${n}, ${i}%, ${s}%)`}(this._rgb):void 0}mix(t,e){if(t){const n=this.rgb,i=t.rgb;let s;const r=e===s?.5:e,o=2*r-1,a=n.a-i.a,c=((o*a==-1?o:(o+a)/(1+o*a))+1)/2;s=1-c,n.r=255&c*n.r+s*i.r+.5,n.g=255&c*n.g+s*i.g+.5,n.b=255&c*n.b+s*i.b+.5,n.a=r*n.a+(1-r)*i.a,this.rgb=n}return this}interpolate(t,e){return t&&(this._rgb=function(t,e,n){const i=F_(g_(t.r)),s=F_(g_(t.g)),r=F_(g_(t.b));return{r:p_(V_(i+n*(F_(g_(e.r))-i))),g:p_(V_(s+n*(F_(g_(e.g))-s))),b:p_(V_(r+n*(F_(g_(e.b))-r))),a:t.a+n*(e.a-t.a)}}(this._rgb,t._rgb,e)),this}clone(){return new H_(this.rgb)}alpha(t){return this._rgb.a=p_(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=u_(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return U_(this._rgb,2,t),this}darken(t){return U_(this._rgb,2,-t),this}saturate(t){return U_(this._rgb,1,t),this}desaturate(t){return U_(this._rgb,1,-t),this}rotate(t){return function(t,e){var n=I_(t);n[0]=M_(n[0]+e),n=A_(n),t.r=n[0],t.g=n[1],t.b=n[2]}(this._rgb,t),this}}function W_(t){return new H_(t)}function $_(t){if(t&&"object"==typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function q_(t){return $_(t)?t:W_(t)}function K_(t){return $_(t)?t:W_(t).saturate(.5).darken(.1).hexString()}const G_=Object.create(null),Y_=Object.create(null);function X_(t,e){if(!e)return t;const n=e.split(".");for(let i=0,s=n.length;i<s;++i){const e=n[i];t=t[e]||(t[e]=Object.create(null))}return t}function Q_(t,e,n){return"string"==typeof e?mb(X_(t,e),n):mb(X_(t,""),e)}var J_=new class{constructor(t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>K_(e.backgroundColor),this.hoverBorderColor=(t,e)=>K_(e.borderColor),this.hoverColor=(t,e)=>K_(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t)}set(t,e){return Q_(this,t,e)}get(t){return X_(this,t)}describe(t,e){return Q_(Y_,t,e)}override(t,e){return Q_(G_,t,e)}route(t,e,n,i){const s=X_(this,t),r=X_(this,n),o="_"+e;Object.defineProperties(s,{[o]:{value:s[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[o],e=r[i];return rb(t)?Object.assign({},e,t):cb(t,e)},set(t){this[o]=t}}})}}({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function Z_(t,e,n,i,s){let r=e[s];return r||(r=e[s]=t.measureText(s).width,n.push(s)),r>i&&(i=r),i}function tw(t,e,n,i){let s=(i=i||{}).data=i.data||{},r=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(s=i.data={},r=i.garbageCollect=[],i.font=e),t.save(),t.font=e;let o=0;const a=n.length;let c,h,l,u,d;for(c=0;c<a;c++)if(u=n[c],null!=u&&!0!==sb(u))o=Z_(t,s,r,o,u);else if(sb(u))for(h=0,l=u.length;h<l;h++)d=u[h],null==d||sb(d)||(o=Z_(t,s,r,o,d));t.restore();const f=r.length/2;if(f>n.length){for(c=0;c<f;c++)delete s[r[c]];r.splice(0,f)}return o}function ew(t,e,n){const i=t.currentDevicePixelRatio,s=0!==n?Math.max(n/2,.5):0;return Math.round((e-s)*i)/i+s}function nw(t,e){(e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function iw(t,e,n,i){sw(t,e,n,i,null)}function sw(t,e,n,i,s){let r,o,a,c,h,l;const u=e.pointStyle,d=e.rotation,f=e.radius;let p=(d||0)*Ab;if(u&&"object"==typeof u&&(r=u.toString(),"[object HTMLImageElement]"===r||"[object HTMLCanvasElement]"===r))return t.save(),t.translate(n,i),t.rotate(p),t.drawImage(u,-u.width/2,-u.height/2,u.width,u.height),void t.restore();if(!(isNaN(f)||f<=0)){switch(t.beginPath(),u){default:s?t.ellipse(n,i,s/2,f,0,0,kb):t.arc(n,i,f,0,kb),t.closePath();break;case"triangle":t.moveTo(n+Math.sin(p)*f,i-Math.cos(p)*f),p+=Ob,t.lineTo(n+Math.sin(p)*f,i-Math.cos(p)*f),p+=Ob,t.lineTo(n+Math.sin(p)*f,i-Math.cos(p)*f),t.closePath();break;case"rectRounded":h=.516*f,c=f-h,o=Math.cos(p+Db)*c,a=Math.sin(p+Db)*c,t.arc(n-o,i-a,h,p-Tb,p-Mb),t.arc(n+a,i-o,h,p-Mb,p),t.arc(n+o,i+a,h,p,p+Mb),t.arc(n-a,i+o,h,p+Mb,p+Tb),t.closePath();break;case"rect":if(!d){c=Math.SQRT1_2*f,l=s?s/2:c,t.rect(n-l,i-c,2*l,2*c);break}p+=Db;case"rectRot":o=Math.cos(p)*f,a=Math.sin(p)*f,t.moveTo(n-o,i-a),t.lineTo(n+a,i-o),t.lineTo(n+o,i+a),t.lineTo(n-a,i+o),t.closePath();break;case"crossRot":p+=Db;case"cross":o=Math.cos(p)*f,a=Math.sin(p)*f,t.moveTo(n-o,i-a),t.lineTo(n+o,i+a),t.moveTo(n+a,i-o),t.lineTo(n-a,i+o);break;case"star":o=Math.cos(p)*f,a=Math.sin(p)*f,t.moveTo(n-o,i-a),t.lineTo(n+o,i+a),t.moveTo(n+a,i-o),t.lineTo(n-a,i+o),p+=Db,o=Math.cos(p)*f,a=Math.sin(p)*f,t.moveTo(n-o,i-a),t.lineTo(n+o,i+a),t.moveTo(n+a,i-o),t.lineTo(n-a,i+o);break;case"line":o=s?s/2:Math.cos(p)*f,a=Math.sin(p)*f,t.moveTo(n-o,i-a),t.lineTo(n+o,i+a);break;case"dash":t.moveTo(n,i),t.lineTo(n+Math.cos(p)*f,i+Math.sin(p)*f)}t.fill(),e.borderWidth>0&&t.stroke()}}function rw(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function ow(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function aw(t){t.restore()}function cw(t,e,n,i,s){if(!e)return t.lineTo(n.x,n.y);if("middle"===s){const i=(e.x+n.x)/2;t.lineTo(i,e.y),t.lineTo(i,n.y)}else"after"===s!=!!i?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function hw(t,e,n,i){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function lw(t,e,n,i,s,r={}){const o=sb(e)?e:[e],a=r.strokeWidth>0&&""!==r.strokeColor;let c,h;for(t.save(),t.font=s.string,function(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]);ib(e.rotation)||t.rotate(e.rotation);e.color&&(t.fillStyle=e.color);e.textAlign&&(t.textAlign=e.textAlign);e.textBaseline&&(t.textBaseline=e.textBaseline)}(t,r),c=0;c<o.length;++c)h=o[c],a&&(r.strokeColor&&(t.strokeStyle=r.strokeColor),ib(r.strokeWidth)||(t.lineWidth=r.strokeWidth),t.strokeText(h,n,i,r.maxWidth)),t.fillText(h,n,i,r.maxWidth),uw(t,n,i,h,r),i+=s.lineHeight;t.restore()}function uw(t,e,n,i,s){if(s.strikethrough||s.underline){const r=t.measureText(i),o=e-r.actualBoundingBoxLeft,a=e+r.actualBoundingBoxRight,c=n-r.actualBoundingBoxAscent,h=n+r.actualBoundingBoxDescent,l=s.strikethrough?(c+h)/2:h;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=s.decorationWidth||2,t.moveTo(o,l),t.lineTo(a,l),t.stroke()}}function dw(t,e){const{x:n,y:i,w:s,h:r,radius:o}=e;t.arc(n+o.topLeft,i+o.topLeft,o.topLeft,-Mb,Tb,!0),t.lineTo(n,i+r-o.bottomLeft),t.arc(n+o.bottomLeft,i+r-o.bottomLeft,o.bottomLeft,Tb,Mb,!0),t.lineTo(n+s-o.bottomRight,i+r),t.arc(n+s-o.bottomRight,i+r-o.bottomRight,o.bottomRight,Mb,0,!0),t.lineTo(n+s,i+o.topRight),t.arc(n+s-o.topRight,i+o.topRight,o.topRight,0,-Mb,!0),t.lineTo(n+o.topLeft,i)}const fw=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),pw=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function gw(t,e){const n=(""+t).match(fw);if(!n||"normal"===n[1])return 1.2*e;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100}return e*t}function mw(t,e){const n={},i=rb(e),s=i?Object.keys(e):e,r=rb(t)?i?n=>cb(t[n],t[e[n]]):e=>t[e]:()=>t;for(const o of s)n[o]=+r(o)||0;return n}function yw(t){return mw(t,{top:"y",right:"x",bottom:"y",left:"x"})}function vw(t){return mw(t,["topLeft","topRight","bottomLeft","bottomRight"])}function bw(t){const e=yw(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function _w(t,e){t=t||{},e=e||J_.font;let n=cb(t.size,e.size);"string"==typeof n&&(n=parseInt(n,10));let i=cb(t.style,e.style);i&&!(""+i).match(pw)&&(console.warn('Invalid font style specified: "'+i+'"'),i="");const s={family:cb(t.family,e.family),lineHeight:gw(cb(t.lineHeight,e.lineHeight),n),size:n,style:i,weight:cb(t.weight,e.weight),string:""};return s.string=function(t){return!t||ib(t.size)||ib(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(s),s}function ww(t,e,n,i){let s,r,o,a=!0;for(s=0,r=t.length;s<r;++s)if(o=t[s],void 0!==o&&(void 0!==e&&"function"==typeof o&&(o=o(e),a=!1),void 0!==n&&sb(o)&&(o=o[n%o.length],a=!1),void 0!==o))return i&&!a&&(i.cacheable=!1),o}function xw(t,e){return Object.assign(Object.create(t),e)}function Sw(t,e=[""],n=t,i,s=(()=>t[0])){xb(i)||(i=Rw("_fallback",t));const r={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:n,_fallback:i,_getTarget:s,override:s=>Sw([s,...t],e,n,i)};return new Proxy(r,{deleteProperty:(e,n)=>(delete e[n],delete e._keys,delete t[0][n],!0),get:(n,i)=>Cw(n,i,(()=>function(t,e,n,i){let s;for(const r of e)if(s=Rw(kw(r,t),n),xb(s))return Iw(t,s)?Ow(n,i,t,s):s}(i,e,t,n))),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t._scopes[0],e),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(t,e)=>Nw(t).includes(e),ownKeys:t=>Nw(t),set(t,e,n){const i=t._storage||(t._storage=s());return t[e]=i[e]=n,delete t._keys,!0}})}function Ew(t,e,n,i){const s={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:Tw(t,i),setContext:e=>Ew(t,e,n,i),override:s=>Ew(t.override(s),e,n,i)};return new Proxy(s,{deleteProperty:(e,n)=>(delete e[n],delete t[n],!0),get:(t,e,n)=>Cw(t,e,(()=>function(t,e,n){const{_proxy:i,_context:s,_subProxy:r,_descriptors:o}=t;let a=i[e];Sb(a)&&o.isScriptable(e)&&(a=function(t,e,n,i){const{_proxy:s,_context:r,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t),e=e(r,o||i),a.delete(t),Iw(t,e)&&(e=Ow(s._scopes,s,t,e));return e}(e,a,t,n));sb(a)&&a.length&&(a=function(t,e,n,i){const{_proxy:s,_context:r,_subProxy:o,_descriptors:a}=n;if(xb(r.index)&&i(t))e=e[r.index%e.length];else if(rb(e[0])){const n=e,i=s._scopes.filter((t=>t!==n));e=[];for(const c of n){const n=Ow(i,s,t,c);e.push(Ew(n,r,o&&o[t],a))}}return e}(e,a,t,o.isIndexable));Iw(e,a)&&(a=Ew(a,s,r&&r[e],o));return a}(t,e,n))),getOwnPropertyDescriptor:(e,n)=>e._descriptors.allKeys?Reflect.has(t,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,n),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(e,n)=>Reflect.has(t,n),ownKeys:()=>Reflect.ownKeys(t),set:(e,n,i)=>(t[n]=i,delete e[n],!0)})}function Tw(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:i=e.indexable,_allKeys:s=e.allKeys}=t;return{allKeys:s,scriptable:n,indexable:i,isScriptable:Sb(n)?n:()=>n,isIndexable:Sb(i)?i:()=>i}}const kw=(t,e)=>t?t+wb(e):e,Iw=(t,e)=>rb(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function Cw(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const i=n();return t[e]=i,i}function Aw(t,e,n){return Sb(t)?t(e,n):t}const Mw=(t,e)=>!0===t?e:"string"==typeof t?_b(e,t):void 0;function Dw(t,e,n,i,s){for(const r of e){const e=Mw(n,r);if(e){t.add(e);const r=Aw(e._fallback,n,s);if(xb(r)&&r!==n&&r!==i)return r}else if(!1===e&&xb(i)&&n!==i)return null}return!1}function Ow(t,e,n,i){const s=e._rootScopes,r=Aw(e._fallback,n,i),o=[...t,...s],a=new Set;a.add(i);let c=Pw(a,o,n,r||n,i);return null!==c&&((!xb(r)||r===n||(c=Pw(a,o,r,c,i),null!==c))&&Sw(Array.from(a),[""],s,r,(()=>function(t,e,n){const i=t._getTarget();e in i||(i[e]={});const s=i[e];if(sb(s)&&rb(n))return n;return s}(e,n,i))))}function Pw(t,e,n,i,s){for(;n;)n=Dw(t,e,n,i,s);return n}function Rw(t,e){for(const n of e){if(!n)continue;const e=n[t];if(xb(e))return e}}function Nw(t){let e=t._keys;return e||(e=t._keys=function(t){const e=new Set;for(const n of t)for(const t of Object.keys(n).filter((t=>!t.startsWith("_"))))e.add(t);return Array.from(e)}(t._scopes)),e}function Lw(t,e,n,i){const{iScale:s}=t,{key:r="r"}=this._parsing,o=new Array(i);let a,c,h,l;for(a=0,c=i;a<c;++a)h=a+n,l=e[h],o[a]={r:s.parse(_b(l,r),h)};return o}const Vw=Number.EPSILON||1e-14,Fw=(t,e)=>e<t.length&&!t[e].skip&&t[e],Uw=t=>"x"===t?"y":"x";function jw(t,e,n,i){const s=t.skip?e:t,r=e,o=n.skip?e:n,a=Hb(r,s),c=Hb(o,r);let h=a/(a+c),l=c/(a+c);h=isNaN(h)?0:h,l=isNaN(l)?0:l;const u=i*h,d=i*l;return{previous:{x:r.x-u*(o.x-s.x),y:r.y-u*(o.y-s.y)},next:{x:r.x+d*(o.x-s.x),y:r.y+d*(o.y-s.y)}}}function Bw(t,e="x"){const n=Uw(e),i=t.length,s=Array(i).fill(0),r=Array(i);let o,a,c,h=Fw(t,0);for(o=0;o<i;++o)if(a=c,c=h,h=Fw(t,o+1),c){if(h){const t=h[e]-c[e];s[o]=0!==t?(h[n]-c[n])/t:0}r[o]=a?h?Rb(s[o-1])!==Rb(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}!function(t,e,n){const i=t.length;let s,r,o,a,c,h=Fw(t,0);for(let l=0;l<i-1;++l)c=h,h=Fw(t,l+1),c&&h&&(Vb(e[l],0,Vw)?n[l]=n[l+1]=0:(s=n[l]/e[l],r=n[l+1]/e[l],a=Math.pow(s,2)+Math.pow(r,2),a<=9||(o=3/Math.sqrt(a),n[l]=s*o*e[l],n[l+1]=r*o*e[l])))}(t,s,r),function(t,e,n="x"){const i=Uw(n),s=t.length;let r,o,a,c=Fw(t,0);for(let h=0;h<s;++h){if(o=a,a=c,c=Fw(t,h+1),!a)continue;const s=a[n],l=a[i];o&&(r=(s-o[n])/3,a[`cp1${n}`]=s-r,a[`cp1${i}`]=l-r*e[h]),c&&(r=(c[n]-s)/3,a[`cp2${n}`]=s+r,a[`cp2${i}`]=l+r*e[h])}}(t,r,e)}function zw(t,e,n){return Math.max(Math.min(t,n),e)}function Hw(t,e,n,i,s){let r,o,a,c;if(e.spanGaps&&(t=t.filter((t=>!t.skip))),"monotone"===e.cubicInterpolationMode)Bw(t,s);else{let n=i?t[t.length-1]:t[0];for(r=0,o=t.length;r<o;++r)a=t[r],c=jw(n,a,t[Math.min(r+1,o-(i?0:1))%o],e.tension),a.cp1x=c.previous.x,a.cp1y=c.previous.y,a.cp2x=c.next.x,a.cp2y=c.next.y,n=a}e.capBezierPoints&&function(t,e){let n,i,s,r,o,a=rw(t[0],e);for(n=0,i=t.length;n<i;++n)o=r,r=a,a=n<i-1&&rw(t[n+1],e),r&&(s=t[n],o&&(s.cp1x=zw(s.cp1x,e.left,e.right),s.cp1y=zw(s.cp1y,e.top,e.bottom)),a&&(s.cp2x=zw(s.cp2x,e.left,e.right),s.cp2y=zw(s.cp2y,e.top,e.bottom)))}(t,n)}function Ww(){return"undefined"!=typeof window&&"undefined"!=typeof document}function $w(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function qw(t,e,n){let i;return"string"==typeof t?(i=parseInt(t,10),-1!==t.indexOf("%")&&(i=i/100*e.parentNode[n])):i=t,i}const Kw=t=>window.getComputedStyle(t,null);const Gw=["top","right","bottom","left"];function Yw(t,e,n){const i={};n=n?"-"+n:"";for(let s=0;s<4;s++){const r=Gw[s];i[r]=parseFloat(t[e+"-"+r+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}function Xw(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:i}=e,s=Kw(n),r="border-box"===s.boxSizing,o=Yw(s,"padding"),a=Yw(s,"border","width"),{x:c,y:h,box:l}=function(t,e){const n=t.touches,i=n&&n.length?n[0]:t,{offsetX:s,offsetY:r}=i;let o,a,c=!1;if(((t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot))(s,r,t.target))o=s,a=r;else{const t=e.getBoundingClientRect();o=i.clientX-t.left,a=i.clientY-t.top,c=!0}return{x:o,y:a,box:c}}(t,n),u=o.left+(l&&a.left),d=o.top+(l&&a.top);let{width:f,height:p}=e;return r&&(f-=o.width+a.width,p-=o.height+a.height),{x:Math.round((c-u)/f*n.width/i),y:Math.round((h-d)/p*n.height/i)}}const Qw=t=>Math.round(10*t)/10;function Jw(t,e,n,i){const s=Kw(t),r=Yw(s,"margin"),o=qw(s.maxWidth,t,"clientWidth")||Cb,a=qw(s.maxHeight,t,"clientHeight")||Cb,c=function(t,e,n){let i,s;if(void 0===e||void 0===n){const r=$w(t);if(r){const t=r.getBoundingClientRect(),o=Kw(r),a=Yw(o,"border","width"),c=Yw(o,"padding");e=t.width-c.width-a.width,n=t.height-c.height-a.height,i=qw(o.maxWidth,r,"clientWidth"),s=qw(o.maxHeight,r,"clientHeight")}else e=t.clientWidth,n=t.clientHeight}return{width:e,height:n,maxWidth:i||Cb,maxHeight:s||Cb}}(t,e,n);let{width:h,height:l}=c;if("content-box"===s.boxSizing){const t=Yw(s,"border","width"),e=Yw(s,"padding");h-=e.width+t.width,l-=e.height+t.height}return h=Math.max(0,h-r.width),l=Math.max(0,i?Math.floor(h/i):l-r.height),h=Qw(Math.min(h,o,c.maxWidth)),l=Qw(Math.min(l,a,c.maxHeight)),h&&!l&&(l=Qw(h/2)),{width:h,height:l}}function Zw(t,e,n){const i=e||1,s=Math.floor(t.height*i),r=Math.floor(t.width*i);t.height=s/i,t.width=r/i;const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==i||o.height!==s||o.width!==r)&&(t.currentDevicePixelRatio=i,o.height=s,o.width=r,t.ctx.setTransform(i,0,0,i,0,0),!0)}const tx=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){}return t}();function ex(t,e){const n=function(t,e){return Kw(t).getPropertyValue(e)}(t,e),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function nx(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function ix(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:"middle"===i?n<.5?t.y:e.y:"after"===i?n<1?t.y:e.y:n>0?e.y:t.y}}function sx(t,e,n,i){const s={x:t.cp2x,y:t.cp2y},r={x:e.cp1x,y:e.cp1y},o=nx(t,s,n),a=nx(s,r,n),c=nx(r,e,n),h=nx(o,a,n),l=nx(a,c,n);return nx(h,l,n)}const rx=new Map;function ox(t,e,n){return function(t,e){e=e||{};const n=t+JSON.stringify(e);let i=rx.get(n);return i||(i=new Intl.NumberFormat(t,e),rx.set(n,i)),i}(e,n).format(t)}function ax(t,e,n){return t?function(t,e){return{x:n=>t+t+e-n,setWidth(t){e=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,e)=>t-e,leftForLtr:(t,e)=>t-e}}(e,n):{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,e)=>t+e,leftForLtr:(t,e)=>t}}function cx(t,e){let n,i;"ltr"!==e&&"rtl"!==e||(n=t.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=i)}function hx(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function lx(t){return"angle"===t?{between:qb,compare:Wb,normalize:$b}:{between:Gb,compare:(t,e)=>t-e,normalize:t=>t}}function ux({start:t,end:e,count:n,loop:i,style:s}){return{start:t%n,end:e%n,loop:i&&(e-t+1)%n==0,style:s}}function dx(t,e,n){if(!n)return[t];const{property:i,start:s,end:r}=n,o=e.length,{compare:a,between:c,normalize:h}=lx(i),{start:l,end:u,loop:d,style:f}=function(t,e,n){const{property:i,start:s,end:r}=n,{between:o,normalize:a}=lx(i),c=e.length;let h,l,{start:u,end:d,loop:f}=t;if(f){for(u+=c,d+=c,h=0,l=c;h<l&&o(a(e[u%c][i]),s,r);++h)u--,d--;u%=c,d%=c}return d<u&&(d+=c),{start:u,end:d,loop:f,style:t.style}}(t,e,n),p=[];let g,m,y,v=!1,b=null;const _=()=>v||c(s,y,g)&&0!==a(s,y),w=()=>!v||0===a(r,g)||c(r,y,g);for(let x=l,S=l;x<=u;++x)m=e[x%o],m.skip||(g=h(m[i]),g!==y&&(v=c(g,s,r),null===b&&_()&&(b=0===a(g,s)?x:S),null!==b&&w()&&(p.push(ux({start:b,end:x,loop:d,count:o,style:f})),b=null),S=x,y=g));return null!==b&&p.push(ux({start:b,end:u,loop:d,count:o,style:f})),p}function fx(t,e){const n=[],i=t.segments;for(let s=0;s<i.length;s++){const r=dx(i[s],t.points,e);r.length&&n.push(...r)}return n}function px(t,e,n,i){return i&&i.setContext&&n?function(t,e,n,i){const s=t._chart.getContext(),r=gx(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,c=n.length,h=[];let l=r,u=e[0].start,d=u;function f(t,e,i,s){const r=a?-1:1;if(t!==e){for(t+=c;n[t%c].skip;)t-=r;for(;n[e%c].skip;)e+=r;t%c!=e%c&&(h.push({start:t%c,end:e%c,loop:i,style:s}),l=s,u=e%c)}}for(const p of e){u=a?u:p.start;let t,e=n[u%c];for(d=u+1;d<=p.end;d++){const r=n[d%c];t=gx(i.setContext(xw(s,{type:"segment",p0:e,p1:r,p0DataIndex:(d-1)%c,p1DataIndex:d%c,datasetIndex:o}))),mx(t,l)&&f(u,d-1,p.loop,l),e=r,l=t}u<d-1&&f(u,d-1,p.loop,l)}return h}(t,e,n,i):e}function gx(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function mx(t,e){return e&&JSON.stringify(t)!==JSON.stringify(e)}
/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */var yx=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,n,i){const s=e.listeners[i],r=e.duration;s.forEach((i=>i({chart:t,initial:e.initial,numSteps:r,currentStep:Math.min(n-e.start,r)})))}_refresh(){this._request||(this._running=!0,this._request=e_.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(t=Date.now()){let e=0;this._charts.forEach(((n,i)=>{if(!n.running||!n.items.length)return;const s=n.items;let r,o=s.length-1,a=!1;for(;o>=0;--o)r=s[o],r._active?(r._total>n.duration&&(n.duration=r._total),r.tick(t),a=!0):(s[o]=s[s.length-1],s.pop());a&&(i.draw(),this._notify(i,n,t,"progress")),s.length||(n.running=!1,this._notify(i,n,t,"complete"),n.initial=!1),e+=s.length})),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let n=e.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,n)),n}listen(t,e,n){this._getAnims(t).listeners[e].push(n)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce(((t,e)=>Math.max(t,e._duration)),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const n=e.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}};const vx={boolean:(t,e,n)=>n>.5?e:t,color(t,e,n){const i=q_(t||"transparent"),s=i.valid&&q_(e||"transparent");return s&&s.valid?s.mix(i,n).hexString():e},number:(t,e,n)=>t+(e-t)*n};class bx{constructor(t,e,n,i){const s=e[n];i=ww([t.to,i,s,t.from]);const r=ww([t.from,s,i]);this._active=!0,this._fn=t.fn||vx[t.type||typeof r],this._easing=l_[t.easing]||l_.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=n,this._from=r,this._to=i,this._promises=void 0}active(){return this._active}update(t,e,n){if(this._active){this._notify(!1);const i=this._target[this._prop],s=n-this._start,r=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(r,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=ww([t.to,e,i,t.from]),this._from=ww([t.from,i,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,n=this._duration,i=this._prop,s=this._from,r=this._loop,o=this._to;let a;if(this._active=s!==o&&(r||e<n),!this._active)return this._target[i]=o,void this._notify(!0);e<0?this._target[i]=s:(a=e/n%2,a=r&&a>1?2-a:a,a=this._easing(Math.min(1,Math.max(0,a))),this._target[i]=this._fn(s,o,a))}wait(){const t=this._promises||(this._promises=[]);return new Promise(((e,n)=>{t.push({res:e,rej:n})}))}_notify(t){const e=t?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][e]()}}J_.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const _x=Object.keys(J_.animation);J_.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),J_.set("animations",{colors:{type:"color",properties:["color","borderColor","backgroundColor"]},numbers:{type:"number",properties:["x","y","borderWidth","radius","tension"]}}),J_.describe("animations",{_fallback:"animation"}),J_.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}});class wx{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!rb(t))return;const e=this._properties;Object.getOwnPropertyNames(t).forEach((n=>{const i=t[n];if(!rb(i))return;const s={};for(const t of _x)s[t]=i[t];(sb(i.properties)&&i.properties||[n]).forEach((t=>{t!==n&&e.has(t)||e.set(t,s)}))}))}_animateOptions(t,e){const n=e.options,i=function(t,e){if(!e)return;let n=t.options;if(!n)return void(t.options=e);n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(t,n);if(!i)return[];const s=this._createAnimations(i,n);return n.$shared&&function(t,e){const n=[],i=Object.keys(e);for(let s=0;s<i.length;s++){const e=t[i[s]];e&&e.active()&&n.push(e.wait())}return Promise.all(n)}(t.options.$animations,n).then((()=>{t.options=n}),(()=>{})),s}_createAnimations(t,e){const n=this._properties,i=[],s=t.$animations||(t.$animations={}),r=Object.keys(e),o=Date.now();let a;for(a=r.length-1;a>=0;--a){const c=r[a];if("$"===c.charAt(0))continue;if("options"===c){i.push(...this._animateOptions(t,e));continue}const h=e[c];let l=s[c];const u=n.get(c);if(l){if(u&&l.active()){l.update(u,h,o);continue}l.cancel()}u&&u.duration?(s[c]=l=new bx(u,t,c,h),i.push(l)):t[c]=h}return i}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const n=this._createAnimations(t,e);return n.length?(yx.add(this._chart,n),!0):void 0}}function xx(t,e){const n=t&&t.options||{},i=n.reverse,s=void 0===n.min?e:0,r=void 0===n.max?e:0;return{start:i?r:s,end:i?s:r}}function Sx(t,e){const n=[],i=t._getSortedDatasetMetas(e);let s,r;for(s=0,r=i.length;s<r;++s)n.push(i[s].index);return n}function Ex(t,e,n,i={}){const s=t.keys,r="single"===i.mode;let o,a,c,h;if(null!==e){for(o=0,a=s.length;o<a;++o){if(c=+s[o],c===n){if(i.all)continue;break}h=t.values[c],ob(h)&&(r||0===e||Rb(e)===Rb(h))&&(e+=h)}return e}}function Tx(t,e){const n=t&&t.options.stacked;return n||void 0===n&&void 0!==e.stack}function kx(t,e,n){const i=t[e]||(t[e]={});return i[n]||(i[n]={})}function Ix(t,e,n,i){for(const s of e.getMatchingVisibleMetas(i).reverse()){const e=t[s.index];if(n&&e>0||!n&&e<0)return s.index}return null}function Cx(t,e){const{chart:n,_cachedMeta:i}=t,s=n._stacks||(n._stacks={}),{iScale:r,vScale:o,index:a}=i,c=r.axis,h=o.axis,l=function(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}(r,o,i),u=e.length;let d;for(let f=0;f<u;++f){const t=e[f],{[c]:n,[h]:r}=t;d=(t._stacks||(t._stacks={}))[h]=kx(s,l,n),d[a]=r,d._top=Ix(d,o,!0,i.type),d._bottom=Ix(d,o,!1,i.type)}}function Ax(t,e){const n=t.scales;return Object.keys(n).filter((t=>n[t].axis===e)).shift()}function Mx(t,e){const n=t.controller.index,i=t.vScale&&t.vScale.axis;if(i){e=e||t._parsed;for(const t of e){const e=t._stacks;if(!e||void 0===e[i]||void 0===e[i][n])return;delete e[i][n]}}}const Dx=t=>"reset"===t||"none"===t,Ox=(t,e)=>e?t:Object.assign({},t);class Px{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Tx(t.vScale,t),this.addElements()}updateIndex(t){this.index!==t&&Mx(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,n=this.getDataset(),i=(t,e,n,i)=>"x"===t?e:"r"===t?i:n,s=e.xAxisID=cb(n.xAxisID,Ax(t,"x")),r=e.yAxisID=cb(n.yAxisID,Ax(t,"y")),o=e.rAxisID=cb(n.rAxisID,Ax(t,"r")),a=e.indexAxis,c=e.iAxisID=i(a,s,r,o),h=e.vAxisID=i(a,r,s,o);e.xScale=this.getScaleForId(s),e.yScale=this.getScaleForId(r),e.rScale=this.getScaleForId(o),e.iScale=this.getScaleForId(c),e.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Zb(this._data,this),t._stacked&&Mx(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),n=this._data;if(rb(e))this._data=function(t){const e=Object.keys(t),n=new Array(e.length);let i,s,r;for(i=0,s=e.length;i<s;++i)r=e[i],n[i]={x:r,y:t[r]};return n}(e);else if(n!==e){if(n){Zb(n,this);const t=this._cachedMeta;Mx(t),t._parsed=[]}e&&Object.isExtensible(e)&&(s=this,(i=e)._chartjs?i._chartjs.listeners.push(s):(Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[s]}}),Jb.forEach((t=>{const e="_onData"+wb(t),n=i[t];Object.defineProperty(i,t,{configurable:!0,enumerable:!1,value(...t){const s=n.apply(this,t);return i._chartjs.listeners.forEach((n=>{"function"==typeof n[e]&&n[e](...t)})),s}})})))),this._syncList=[],this._data=e}var i,s}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const s=e._stacked;e._stacked=Tx(e.vScale,e),e.stack!==n.stack&&(i=!0,Mx(e),e.stack=n.stack),this._resyncElements(t),(i||s!==e._stacked)&&Cx(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:n,_data:i}=this,{iScale:s,_stacked:r}=n,o=s.axis;let a,c,h,l=0===t&&e===i.length||n._sorted,u=t>0&&n._parsed[t-1];if(!1===this._parsing)n._parsed=i,n._sorted=!0,h=i;else{h=sb(i[t])?this.parseArrayData(n,i,t,e):rb(i[t])?this.parseObjectData(n,i,t,e):this.parsePrimitiveData(n,i,t,e);const s=()=>null===c[o]||u&&c[o]<u[o];for(a=0;a<e;++a)n._parsed[a+t]=c=h[a],l&&(s()&&(l=!1),u=c);n._sorted=l}r&&Cx(this,h)}parsePrimitiveData(t,e,n,i){const{iScale:s,vScale:r}=t,o=s.axis,a=r.axis,c=s.getLabels(),h=s===r,l=new Array(i);let u,d,f;for(u=0,d=i;u<d;++u)f=u+n,l[u]={[o]:h||s.parse(c[f],f),[a]:r.parse(e[f],f)};return l}parseArrayData(t,e,n,i){const{xScale:s,yScale:r}=t,o=new Array(i);let a,c,h,l;for(a=0,c=i;a<c;++a)h=a+n,l=e[h],o[a]={x:s.parse(l[0],h),y:r.parse(l[1],h)};return o}parseObjectData(t,e,n,i){const{xScale:s,yScale:r}=t,{xAxisKey:o="x",yAxisKey:a="y"}=this._parsing,c=new Array(i);let h,l,u,d;for(h=0,l=i;h<l;++h)u=h+n,d=e[u],c[h]={x:s.parse(_b(d,o),u),y:r.parse(_b(d,a),u)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,n){const i=this.chart,s=this._cachedMeta,r=e[t.axis];return Ex({keys:Sx(i,!0),values:e._stacks[t.axis]},r,s.index,{mode:n})}updateRangeFromParsed(t,e,n,i){const s=n[e.axis];let r=null===s?NaN:s;const o=i&&n._stacks[e.axis];i&&o&&(i.values=o,r=Ex(i,s,this._cachedMeta.index)),t.min=Math.min(t.min,r),t.max=Math.max(t.max,r)}getMinMax(t,e){const n=this._cachedMeta,i=n._parsed,s=n._sorted&&t===n.iScale,r=i.length,o=this._getOtherScale(t),a=((t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Sx(n,!0),values:null})(e,n,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:l}=function(t){const{min:e,max:n,minDefined:i,maxDefined:s}=t.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:s?n:Number.POSITIVE_INFINITY}}(o);let u,d;function f(){d=i[u];const e=d[o.axis];return!ob(d[t.axis])||h>e||l<e}for(u=0;u<r&&(f()||(this.updateRangeFromParsed(c,t,d,a),!s));++u);if(s)for(u=r-1;u>=0;--u)if(!f()){this.updateRangeFromParsed(c,t,d,a);break}return c}getAllParsedValues(t){const e=this._cachedMeta._parsed,n=[];let i,s,r;for(i=0,s=e.length;i<s;++i)r=e[i][t.axis],ob(r)&&n.push(r);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,n=e.iScale,i=e.vScale,s=this.getParsed(t);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=function(t){let e,n,i,s;return rb(t)?(e=t.top,n=t.right,i=t.bottom,s=t.left):e=n=i=s=t,{top:e,right:n,bottom:i,left:s,disabled:!1===t}}(cb(this.options.clip,function(t,e,n){if(!1===n)return!1;const i=xx(t,n),s=xx(e,n);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,n=this._cachedMeta,i=n.data||[],s=e.chartArea,r=[],o=this._drawStart||0,a=this._drawCount||i.length-o,c=this.options.drawActiveElementsOnTop;let h;for(n.dataset&&n.dataset.draw(t,s,o,a),h=o;h<o+a;++h){const e=i[h];e.hidden||(e.active&&c?r.push(e):e.draw(t,s))}for(h=0;h<r.length;++h)r[h].draw(t,s)}getStyle(t,e){const n=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,e,n){const i=this.getDataset();let s;if(t>=0&&t<this._cachedMeta.data.length){const e=this._cachedMeta.data[t];s=e.$context||(e.$context=function(t,e,n){return xw(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}(this.getContext(),t,e)),s.parsed=this.getParsed(t),s.raw=i.data[t],s.index=s.dataIndex=t}else s=this.$context||(this.$context=function(t,e){return xw(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!e,s.mode=n,s}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",n){const i="active"===e,s=this._cachedDataOpts,r=t+"-"+e,o=s[r],a=this.enableOptionSharing&&xb(n);if(o)return Ox(o,a);const c=this.chart.config,h=c.datasetElementScopeKeys(this._type,t),l=i?[`${t}Hover`,"hover",t,""]:[t,""],u=c.getOptionScopes(this.getDataset(),h),d=Object.keys(J_.elements[t]),f=c.resolveNamedOptions(u,d,(()=>this.getContext(n,i)),l);return f.$shared&&(f.$shared=a,s[r]=Object.freeze(Ox(f,a))),f}_resolveAnimations(t,e,n){const i=this.chart,s=this._cachedDataOpts,r=`animation-${e}`,o=s[r];if(o)return o;let a;if(!1!==i.options.animation){const i=this.chart.config,s=i.datasetAnimationScopeKeys(this._type,e),r=i.getOptionScopes(this.getDataset(),s);a=i.createResolver(r,this.getContext(t,n,e))}const c=new wx(i,a&&a.animations);return a&&a._cacheable&&(s[r]=Object.freeze(c)),c}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||Dx(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const n=this.resolveDataElementOptions(t,e),i=this._sharedOptions,s=this.getSharedOptions(n),r=this.includeOptions(e,s)||s!==i;return this.updateSharedOptions(s,e,n),{sharedOptions:s,includeOptions:r}}updateElement(t,e,n,i){Dx(i)?Object.assign(t,n):this._resolveAnimations(e,i).update(t,n)}updateSharedOptions(t,e,n){t&&!Dx(e)&&this._resolveAnimations(void 0,e).update(t,n)}_setStyle(t,e,n,i){t.active=i;const s=this.getStyle(e,i);this._resolveAnimations(e,n,i).update(t,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(t,e,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,e,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,n=this._cachedMeta.data;for(const[o,a,c]of this._syncList)this[o](a,c);this._syncList=[];const i=n.length,s=e.length,r=Math.min(s,i);r&&this.parse(0,r),s>i?this._insertElements(i,s-i,t):s<i&&this._removeElements(s,i-s)}_insertElements(t,e,n=!0){const i=this._cachedMeta,s=i.data,r=t+e;let o;const a=t=>{for(t.length+=e,o=t.length-1;o>=r;o--)t[o]=t[o-e]};for(a(s),o=t;o<r;++o)s[o]=new this.dataElementType;this._parsing&&a(i._parsed),this.parse(t,e),n&&this.updateElements(s,t,e,"reset")}updateElements(t,e,n,i){}_removeElements(t,e){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(t,e);n._stacked&&Mx(n,i)}n.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,n,i]=t;this[e](n,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Rx(t){const e=t.iScale,n=function(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let i=[];for(let e=0,s=n.length;e<s;e++)i=i.concat(n[e].controller.getAllParsedValues(t));t._cache.$bar=t_(i.sort(((t,e)=>t-e)))}return t._cache.$bar}(e,t.type);let i,s,r,o,a=e._length;const c=()=>{32767!==r&&-32768!==r&&(xb(o)&&(a=Math.min(a,Math.abs(r-o)||a)),o=r)};for(i=0,s=n.length;i<s;++i)r=e.getPixelForValue(n[i]),c();for(o=void 0,i=0,s=e.ticks.length;i<s;++i)r=e.getPixelForTick(i),c();return a}function Nx(t,e,n,i){return sb(t)?function(t,e,n,i){const s=n.parse(t[0],i),r=n.parse(t[1],i),o=Math.min(s,r),a=Math.max(s,r);let c=o,h=a;Math.abs(o)>Math.abs(a)&&(c=a,h=o),e[n.axis]=h,e._custom={barStart:c,barEnd:h,start:s,end:r,min:o,max:a}}(t,e,n,i):e[n.axis]=n.parse(t,i),e}function Lx(t,e,n,i){const s=t.iScale,r=t.vScale,o=s.getLabels(),a=s===r,c=[];let h,l,u,d;for(h=n,l=n+i;h<l;++h)d=e[h],u={},u[s.axis]=a||s.parse(o[h],h),c.push(Nx(d,u,r,h));return c}function Vx(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function Fx(t,e,n,i){let s=e.borderSkipped;const r={};if(!s)return void(t.borderSkipped=r);if(!0===s)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:o,end:a,reverse:c,top:h,bottom:l}=function(t){let e,n,i,s,r;return t.horizontal?(e=t.base>t.x,n="left",i="right"):(e=t.base<t.y,n="bottom",i="top"),e?(s="end",r="start"):(s="start",r="end"),{start:n,end:i,reverse:e,top:s,bottom:r}}(t);"middle"===s&&n&&(t.enableBorderRadius=!0,(n._top||0)===i?s=h:(n._bottom||0)===i?s=l:(r[Ux(l,o,a,c)]=!0,s=h)),r[Ux(s,o,a,c)]=!0,t.borderSkipped=r}function Ux(t,e,n,i){var s,r,o;return i?(o=n,t=jx(t=(s=t)===(r=e)?o:s===o?r:s,n,e)):t=jx(t,e,n),t}function jx(t,e,n){return"start"===t?e:"end"===t?n:t}function Bx(t,{inflateAmount:e},n){t.inflateAmount="auto"===e?1===n?.33:0:e}Px.defaults={},Px.prototype.datasetElementType=null,Px.prototype.dataElementType=null;class zx extends Px{parsePrimitiveData(t,e,n,i){return Lx(t,e,n,i)}parseArrayData(t,e,n,i){return Lx(t,e,n,i)}parseObjectData(t,e,n,i){const{iScale:s,vScale:r}=t,{xAxisKey:o="x",yAxisKey:a="y"}=this._parsing,c="x"===s.axis?o:a,h="x"===r.axis?o:a,l=[];let u,d,f,p;for(u=n,d=n+i;u<d;++u)p=e[u],f={},f[s.axis]=s.parse(_b(p,c),u),l.push(Nx(_b(p,h),f,r,u));return l}updateRangeFromParsed(t,e,n,i){super.updateRangeFromParsed(t,e,n,i);const s=n._custom;s&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,s.min),t.max=Math.max(t.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:n,vScale:i}=e,s=this.getParsed(t),r=s._custom,o=Vx(r)?"["+r.start+", "+r.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,n,i){const s="reset"===i,{index:r,_cachedMeta:{vScale:o}}=this,a=o.getBasePixel(),c=o.isHorizontal(),h=this._getRuler(),{sharedOptions:l,includeOptions:u}=this._getSharedOptions(e,i);for(let d=e;d<e+n;d++){const e=this.getParsed(d),n=s||ib(e[o.axis])?{base:a,head:a}:this._calculateBarValuePixels(d),f=this._calculateBarIndexPixels(d,h),p=(e._stacks||{})[o.axis],g={horizontal:c,base:n.base,enableBorderRadius:!p||Vx(e._custom)||r===p._top||r===p._bottom,x:c?n.head:f.center,y:c?f.center:n.head,height:c?f.size:Math.abs(n.size),width:c?Math.abs(n.size):f.size};u&&(g.options=l||this.resolveDataElementOptions(d,t[d].active?"active":i));const m=g.options||t[d].options;Fx(g,m,p,r),Bx(g,m,h.ratio),this.updateElement(t[d],d,g,i)}}_getStacks(t,e){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter((t=>t.controller.options.grouped)),s=n.options.stacked,r=[],o=t=>{const n=t.controller.getParsed(e),i=n&&n[t.vScale.axis];if(ib(i)||isNaN(i))return!0};for(const a of i)if((void 0===e||!o(a))&&((!1===s||-1===r.indexOf(a.stack)||void 0===s&&void 0===a.stack)&&r.push(a.stack),a.index===t))break;return r.length||r.push(void 0),r}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,n){const i=this._getStacks(t,n),s=void 0!==e?i.indexOf(e):-1;return-1===s?i.length-1:s}_getRuler(){const t=this.options,e=this._cachedMeta,n=e.iScale,i=[];let s,r;for(s=0,r=e.data.length;s<r;++s)i.push(n.getPixelForValue(this.getParsed(s)[n.axis],s));const o=t.barThickness;return{min:o||Rx(e),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:o?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:n},options:{base:i,minBarLength:s}}=this,r=i||0,o=this.getParsed(t),a=o._custom,c=Vx(a);let h,l,u=o[e.axis],d=0,f=n?this.applyStack(e,o,n):u;f!==u&&(d=f-u,f=u),c&&(u=a.barStart,f=a.barEnd-a.barStart,0!==u&&Rb(u)!==Rb(a.barEnd)&&(d=0),d+=u);const p=ib(i)||c?d:i;let g=e.getPixelForValue(p);if(h=this.chart.getDataVisibility(t)?e.getPixelForValue(d+f):g,l=h-g,Math.abs(l)<s){l=function(t,e,n){return 0!==t?Rb(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}(l,e,r)*s,u===r&&(g-=l/2);const t=e.getPixelForDecimal(0),n=e.getPixelForDecimal(1),i=Math.min(t,n),o=Math.max(t,n);g=Math.max(Math.min(g,o),i),h=g+l}if(g===e.getPixelForValue(r)){const t=Rb(l)*e.getLineWidthForValue(r)/2;g+=t,l-=t}return{size:l,base:g,head:h,center:h+l/2}}_calculateBarIndexPixels(t,e){const n=e.scale,i=this.options,s=i.skipNull,r=cb(i.maxBarThickness,1/0);let o,a;if(e.grouped){const n=s?this._getStackCount(t):e.stackCount,c="flex"===i.barThickness?function(t,e,n,i){const s=e.pixels,r=s[t];let o=t>0?s[t-1]:null,a=t<s.length-1?s[t+1]:null;const c=n.categoryPercentage;null===o&&(o=r-(null===a?e.end-e.start:a-r)),null===a&&(a=r+r-o);const h=r-(r-Math.min(o,a))/2*c;return{chunk:Math.abs(a-o)/2*c/i,ratio:n.barPercentage,start:h}}(t,e,i,n):function(t,e,n,i){const s=n.barThickness;let r,o;return ib(s)?(r=e.min*n.categoryPercentage,o=n.barPercentage):(r=s*i,o=1),{chunk:r/i,ratio:o,start:e.pixels[t]-r/2}}(t,e,i,n),h=this._getStackIndex(this.index,this._cachedMeta.stack,s?t:void 0);o=c.start+c.chunk*h+c.chunk/2,a=Math.min(r,c.chunk*c.ratio)}else o=n.getPixelForValue(this.getParsed(t)[n.axis],t),a=Math.min(r,e.min*e.ratio);return{base:o-a/2,head:o+a/2,center:o,size:a}}draw(){const t=this._cachedMeta,e=t.vScale,n=t.data,i=n.length;let s=0;for(;s<i;++s)null!==this.getParsed(s)[e.axis]&&n[s].draw(this._ctx)}}zx.id="bar",zx.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}},zx.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class Hx extends Px{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,n,i){const s=super.parsePrimitiveData(t,e,n,i);for(let r=0;r<s.length;r++)s[r]._custom=this.resolveDataElementOptions(r+n).radius;return s}parseArrayData(t,e,n,i){const s=super.parseArrayData(t,e,n,i);for(let r=0;r<s.length;r++){const t=e[n+r];s[r]._custom=cb(t[2],this.resolveDataElementOptions(r+n).radius)}return s}parseObjectData(t,e,n,i){const s=super.parseObjectData(t,e,n,i);for(let r=0;r<s.length;r++){const t=e[n+r];s[r]._custom=cb(t&&t.r&&+t.r,this.resolveDataElementOptions(r+n).radius)}return s}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let n=t.length-1;n>=0;--n)e=Math.max(e,t[n].size(this.resolveDataElementOptions(n))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,{xScale:n,yScale:i}=e,s=this.getParsed(t),r=n.getLabelForValue(s.x),o=i.getLabelForValue(s.y),a=s._custom;return{label:e.label,value:"("+r+", "+o+(a?", "+a:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,n,i){const s="reset"===i,{iScale:r,vScale:o}=this._cachedMeta,{sharedOptions:a,includeOptions:c}=this._getSharedOptions(e,i),h=r.axis,l=o.axis;for(let u=e;u<e+n;u++){const e=t[u],n=!s&&this.getParsed(u),d={},f=d[h]=s?r.getPixelForDecimal(.5):r.getPixelForValue(n[h]),p=d[l]=s?o.getBasePixel():o.getPixelForValue(n[l]);d.skip=isNaN(f)||isNaN(p),c&&(d.options=a||this.resolveDataElementOptions(u,e.active?"active":i),s&&(d.options.radius=0)),this.updateElement(e,u,d,i)}}resolveDataElementOptions(t,e){const n=this.getParsed(t);let i=super.resolveDataElementOptions(t,e);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const s=i.radius;return"active"!==e&&(i.radius=0),i.radius+=cb(n&&n._custom,s),i}}Hx.id="bubble",Hx.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}},Hx.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title:()=>""}}}};class Wx extends Px{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const n=this.getDataset().data,i=this._cachedMeta;if(!1===this._parsing)i._parsed=n;else{let s,r,o=t=>+n[t];if(rb(n[t])){const{key:t="value"}=this._parsing;o=e=>+_b(n[e],t)}for(s=t,r=t+e;s<r;++s)i._parsed[s]=o(s)}}_getRotation(){return Ub(this.options.rotation-90)}_getCircumference(){return Ub(this.options.circumference)}_getRotationExtents(){let t=kb,e=-kb;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)){const i=this.chart.getDatasetMeta(n).controller,s=i._getRotation(),r=i._getCircumference();t=Math.min(t,s),e=Math.max(e,s+r)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:n}=e,i=this._cachedMeta,s=i.data,r=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,o=Math.max((Math.min(n.width,n.height)-r)/2,0),a=Math.min((c=this.options.cutout,h=o,"string"==typeof c&&c.endsWith("%")?parseFloat(c)/100:c/h),1);var c,h;const l=this._getRingWeight(this.index),{circumference:u,rotation:d}=this._getRotationExtents(),{ratioX:f,ratioY:p,offsetX:g,offsetY:m}=function(t,e,n){let i=1,s=1,r=0,o=0;if(e<kb){const a=t,c=a+e,h=Math.cos(a),l=Math.sin(a),u=Math.cos(c),d=Math.sin(c),f=(t,e,i)=>qb(t,a,c,!0)?1:Math.max(e,e*n,i,i*n),p=(t,e,i)=>qb(t,a,c,!0)?-1:Math.min(e,e*n,i,i*n),g=f(0,h,u),m=f(Mb,l,d),y=p(Tb,h,u),v=p(Tb+Mb,l,d);i=(g-y)/2,s=(m-v)/2,r=-(g+y)/2,o=-(m+v)/2}return{ratioX:i,ratioY:s,offsetX:r,offsetY:o}}(d,u,a),y=(n.width-r)/f,v=(n.height-r)/p,b=Math.max(Math.min(y,v)/2,0),_=hb(this.options.radius,b),w=(_-Math.max(_*a,0))/this._getVisibleDatasetWeightTotal();this.offsetX=g*_,this.offsetY=m*_,i.total=this.calculateTotal(),this.outerRadius=_-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*l,0),this.updateElements(s,0,s.length,t)}_circumference(t,e){const n=this.options,i=this._cachedMeta,s=this._getCircumference();return e&&n.animation.animateRotate||!this.chart.getDataVisibility(t)||null===i._parsed[t]||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*s/kb)}updateElements(t,e,n,i){const s="reset"===i,r=this.chart,o=r.chartArea,a=r.options.animation,c=(o.left+o.right)/2,h=(o.top+o.bottom)/2,l=s&&a.animateScale,u=l?0:this.innerRadius,d=l?0:this.outerRadius,{sharedOptions:f,includeOptions:p}=this._getSharedOptions(e,i);let g,m=this._getRotation();for(g=0;g<e;++g)m+=this._circumference(g,s);for(g=e;g<e+n;++g){const e=this._circumference(g,s),n=t[g],r={x:c+this.offsetX,y:h+this.offsetY,startAngle:m,endAngle:m+e,circumference:e,outerRadius:d,innerRadius:u};p&&(r.options=f||this.resolveDataElementOptions(g,n.active?"active":i)),m+=e,this.updateElement(n,g,r,i)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let n,i=0;for(n=0;n<e.length;n++){const s=t._parsed[n];null===s||isNaN(s)||!this.chart.getDataVisibility(n)||e[n].hidden||(i+=Math.abs(s))}return i}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?kb*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,i=n.data.labels||[],s=ox(e._parsed[t],n.options.locale);return{label:i[t]||"",value:s}}getMaxBorderWidth(t){let e=0;const n=this.chart;let i,s,r,o,a;if(!t)for(i=0,s=n.data.datasets.length;i<s;++i)if(n.isDatasetVisible(i)){r=n.getDatasetMeta(i),t=r.data,o=r.controller;break}if(!t)return 0;for(i=0,s=t.length;i<s;++i)a=o.resolveDataElementOptions(i),"inner"!==a.borderAlign&&(e=Math.max(e,a.borderWidth||0,a.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let n=0,i=t.length;n<i;++n){const t=this.resolveDataElementOptions(n);e=Math.max(e,t.offset||0,t.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(e+=this._getRingWeight(n));return e}_getRingWeight(t){return Math.max(cb(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Wx.id="doughnut",Wx.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"},Wx.descriptors={_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t},Wx.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n}}=t.legend.options;return e.labels.map(((e,i)=>{const s=t.getDatasetMeta(0).controller.getStyle(i);return{text:e,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,lineWidth:s.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(i),index:i}}))}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}},tooltip:{callbacks:{title:()=>"",label(t){let e=t.label;const n=": "+t.formattedValue;return sb(e)?(e=e.slice(),e[0]+=n):e+=n,e}}}}};class $x extends Px{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:n,data:i=[],_dataset:s}=e,r=this.chart._animationsDisabled;let{start:o,count:a}=r_(e,i,r);this._drawStart=o,this._drawCount=a,o_(e)&&(o=0,a=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!s._decimated,n.points=i;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(n,void 0,{animated:!r,options:c},t),this.updateElements(i,o,a,t)}updateElements(t,e,n,i){const s="reset"===i,{iScale:r,vScale:o,_stacked:a,_dataset:c}=this._cachedMeta,{sharedOptions:h,includeOptions:l}=this._getSharedOptions(e,i),u=r.axis,d=o.axis,{spanGaps:f,segment:p}=this.options,g=Lb(f)?f:Number.POSITIVE_INFINITY,m=this.chart._animationsDisabled||s||"none"===i;let y=e>0&&this.getParsed(e-1);for(let v=e;v<e+n;++v){const e=t[v],n=this.getParsed(v),f=m?e:{},b=ib(n[d]),_=f[u]=r.getPixelForValue(n[u],v),w=f[d]=s||b?o.getBasePixel():o.getPixelForValue(a?this.applyStack(o,n,a):n[d],v);f.skip=isNaN(_)||isNaN(w)||b,f.stop=v>0&&Math.abs(n[u]-y[u])>g,p&&(f.parsed=n,f.raw=c.data[v]),l&&(f.options=h||this.resolveDataElementOptions(v,e.active?"active":i)),m||this.updateElement(e,v,f,i),y=n}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,n=e.options&&e.options.borderWidth||0,i=t.data||[];if(!i.length)return n;const s=i[0].size(this.resolveDataElementOptions(0)),r=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,s,r)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}$x.id="line",$x.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1},$x.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};class qx extends Px{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,i=n.data.labels||[],s=ox(e._parsed[t].r,n.options.locale);return{label:i[t]||"",value:s}}parseObjectData(t,e,n,i){return Lw.bind(this)(t,e,n,i)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach(((t,n)=>{const i=this.getParsed(n).r;!isNaN(i)&&this.chart.getDataVisibility(n)&&(i<e.min&&(e.min=i),i>e.max&&(e.max=i))})),e}_updateRadius(){const t=this.chart,e=t.chartArea,n=t.options,i=Math.min(e.right-e.left,e.bottom-e.top),s=Math.max(i/2,0),r=(s-Math.max(n.cutoutPercentage?s/100*n.cutoutPercentage:1,0))/t.getVisibleDatasetCount();this.outerRadius=s-r*this.index,this.innerRadius=this.outerRadius-r}updateElements(t,e,n,i){const s="reset"===i,r=this.chart,o=r.options.animation,a=this._cachedMeta.rScale,c=a.xCenter,h=a.yCenter,l=a.getIndexAngle(0)-.5*Tb;let u,d=l;const f=360/this.countVisibleElements();for(u=0;u<e;++u)d+=this._computeAngle(u,i,f);for(u=e;u<e+n;u++){const e=t[u];let n=d,p=d+this._computeAngle(u,i,f),g=r.getDataVisibility(u)?a.getDistanceFromCenterForValue(this.getParsed(u).r):0;d=p,s&&(o.animateScale&&(g=0),o.animateRotate&&(n=p=l));const m={x:c,y:h,innerRadius:0,outerRadius:g,startAngle:n,endAngle:p,options:this.resolveDataElementOptions(u,e.active?"active":i)};this.updateElement(e,u,m,i)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach(((t,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&e++})),e}_computeAngle(t,e,n){return this.chart.getDataVisibility(t)?Ub(this.resolveDataElementOptions(t,e).angle||n):0}}qx.id="polarArea",qx.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0},qx.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n}}=t.legend.options;return e.labels.map(((e,i)=>{const s=t.getDatasetMeta(0).controller.getStyle(i);return{text:e,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,lineWidth:s.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(i),index:i}}))}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}},tooltip:{callbacks:{title:()=>"",label:t=>t.chart.data.labels[t.dataIndex]+": "+t.formattedValue}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class Kx extends Wx{}Kx.id="pie",Kx.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class Gx extends Px{getLabelAndValue(t){const e=this._cachedMeta.vScale,n=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(n[e.axis])}}parseObjectData(t,e,n,i){return Lw.bind(this)(t,e,n,i)}update(t){const e=this._cachedMeta,n=e.dataset,i=e.data||[],s=e.iScale.getLabels();if(n.points=i,"resize"!==t){const e=this.resolveDatasetElementOptions(t);this.options.showLine||(e.borderWidth=0);const r={_loop:!0,_fullLoop:s.length===i.length,options:e};this.updateElement(n,void 0,r,t)}this.updateElements(i,0,i.length,t)}updateElements(t,e,n,i){const s=this._cachedMeta.rScale,r="reset"===i;for(let o=e;o<e+n;o++){const e=t[o],n=this.resolveDataElementOptions(o,e.active?"active":i),a=s.getPointPositionForValue(o,this.getParsed(o).r),c=r?s.xCenter:a.x,h=r?s.yCenter:a.y,l={x:c,y:h,angle:a.angle,skip:isNaN(c)||isNaN(h),options:n};this.updateElement(e,o,l,i)}}}Gx.id="radar",Gx.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}},Gx.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class Yx{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}hasValue(){return Lb(this.x)&&Lb(this.y)}getProps(t,e){const n=this.$animations;if(!e||!n)return this;const i={};return t.forEach((t=>{i[t]=n[t]&&n[t].active()?n[t]._to:this[t]})),i}}Yx.defaults={},Yx.defaultRoutes=void 0;const Xx={values:t=>sb(t)?t:""+t,numeric(t,e,n){if(0===t)return"0";const i=this.chart.options.locale;let s,r=t;if(n.length>1){const e=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(e<1e-4||e>1e15)&&(s="scientific"),r=function(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t));return n}(t,n)}const o=Pb(Math.abs(r)),a=Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(c,this.options.ticks.format),ox(t,i,c)},logarithmic(t,e,n){if(0===t)return"0";const i=t/Math.pow(10,Math.floor(Pb(t)));return 1===i||2===i||5===i?Xx.numeric.call(this,t,e,n):""}};var Qx={formatters:Xx};function Jx(t,e){const n=t.options.ticks,i=n.maxTicksLimit||function(t){const e=t.options.offset,n=t._tickSize(),i=t._length/n+(e?0:1),s=t._maxLength/n;return Math.floor(Math.min(i,s))}(t),s=n.major.enabled?function(t){const e=[];let n,i;for(n=0,i=t.length;n<i;n++)t[n].major&&e.push(n);return e}(e):[],r=s.length,o=s[0],a=s[r-1],c=[];if(r>i)return function(t,e,n,i){let s,r=0,o=n[0];for(i=Math.ceil(i),s=0;s<t.length;s++)s===o&&(e.push(t[s]),r++,o=n[r*i])}(e,c,s,r/i),c;const h=function(t,e,n){const i=function(t){const e=t.length;let n,i;if(e<2)return!1;for(i=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==i)return!1;return i}(t),s=e.length/n;if(!i)return Math.max(s,1);const r=function(t){const e=[],n=Math.sqrt(t);let i;for(i=1;i<n;i++)t%i==0&&(e.push(i),e.push(t/i));return n===(0|n)&&e.push(n),e.sort(((t,e)=>t-e)).pop(),e}(i);for(let o=0,a=r.length-1;o<a;o++){const t=r[o];if(t>s)return t}return Math.max(s,1)}(s,e,i);if(r>0){let t,n;const i=r>1?Math.round((a-o)/(r-1)):null;for(Zx(e,c,h,ib(i)?0:o-i,o),t=0,n=r-1;t<n;t++)Zx(e,c,h,s[t],s[t+1]);return Zx(e,c,h,a,ib(i)?e.length:a+i),c}return Zx(e,c,h),c}function Zx(t,e,n,i,s){const r=cb(i,0),o=Math.min(cb(s,t.length),t.length);let a,c,h,l=0;for(n=Math.ceil(n),s&&(a=s-i,n=a/Math.floor(a/n)),h=r;h<0;)l++,h=Math.round(r+l*n);for(c=Math.max(r,0);c<o;c++)c===h&&(e.push(t[c]),l++,h=Math.round(r+l*n))}J_.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Qx.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),J_.route("scale.ticks","color","","color"),J_.route("scale.grid","color","","borderColor"),J_.route("scale.grid","borderColor","","borderColor"),J_.route("scale.title","color","","color"),J_.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t}),J_.describe("scales",{_fallback:"scale"}),J_.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t});const tS=(t,e,n)=>"top"===e||"left"===e?t[e]+n:t[e]-n;function eS(t,e){const n=[],i=t.length/e,s=t.length;let r=0;for(;r<s;r+=i)n.push(t[Math.floor(r)]);return n}function nS(t,e,n){const i=t.ticks.length,s=Math.min(e,i-1),r=t._startPixel,o=t._endPixel,a=1e-6;let c,h=t.getPixelForTick(s);if(!(n&&(c=1===i?Math.max(h-r,o-h):0===e?(t.getPixelForTick(1)-h)/2:(h-t.getPixelForTick(s-1))/2,h+=s<e?c:-c,h<r-a||h>o+a)))return h}function iS(t){return t.drawTicks?t.tickLength:0}function sS(t,e){if(!t.display)return 0;const n=_w(t.font,e),i=bw(t.padding);return(sb(t.text)?t.text.length:1)*n.lineHeight+i.height}function rS(t,e,n){let i=i_(t);return(n&&"right"!==e||!n&&"right"===e)&&(i=(t=>"left"===t?"right":"right"===t?"left":t)(i)),i}class oS extends Yx{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:n,_suggestedMax:i}=this;return t=ab(t,Number.POSITIVE_INFINITY),e=ab(e,Number.NEGATIVE_INFINITY),n=ab(n,Number.POSITIVE_INFINITY),i=ab(i,Number.NEGATIVE_INFINITY),{min:ab(t,n),max:ab(e,i),minDefined:ob(t),maxDefined:ob(e)}}getMinMax(t){let e,{min:n,max:i,minDefined:s,maxDefined:r}=this.getUserBounds();if(s&&r)return{min:n,max:i};const o=this.getMatchingVisibleMetas();for(let a=0,c=o.length;a<c;++a)e=o[a].controller.getMinMax(this,t),s||(n=Math.min(n,e.min)),r||(i=Math.max(i,e.max));return n=r&&n>i?i:n,i=s&&n>i?n:i,{min:ab(n,ab(i,n)),max:ab(i,ab(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){lb(this.options.beforeUpdate,[this])}update(t,e,n){const{beginAtZero:i,grace:s,ticks:r}=this.options,o=r.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(t,e,n){const{min:i,max:s}=t,r=hb(e,(s-i)/2),o=(t,e)=>n&&0===t?0:t+e;return{min:o(i,-Math.abs(r)),max:o(s,r)}}(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const a=o<this.ticks.length;this._convertTicksToLabels(a?eS(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),r.display&&(r.autoSkip||"auto"===r.source)&&(this.ticks=Jx(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),a&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,n=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,n=!n),this._startPixel=t,this._endPixel=e,this._reversePixels=n,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){lb(this.options.afterUpdate,[this])}beforeSetDimensions(){lb(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){lb(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),lb(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){lb(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let n,i,s;for(n=0,i=t.length;n<i;n++)s=t[n],s.label=lb(e.callback,[s.value,n,t],this)}afterTickToLabelConversion(){lb(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){lb(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,n=this.ticks.length,i=e.minRotation||0,s=e.maxRotation;let r,o,a,c=i;if(!this._isVisible()||!e.display||i>=s||n<=1||!this.isHorizontal())return void(this.labelRotation=i);const h=this._getLabelSizes(),l=h.widest.width,u=h.highest.height,d=Kb(this.chart.width-l,0,this.maxWidth);r=t.offset?this.maxWidth/n:d/(n-1),l+6>r&&(r=d/(n-(t.offset?.5:1)),o=this.maxHeight-iS(t.grid)-e.padding-sS(t.title,this.chart.options.font),a=Math.sqrt(l*l+u*u),c=jb(Math.min(Math.asin(Kb((h.highest.height+6)/r,-1,1)),Math.asin(Kb(o/a,-1,1))-Math.asin(Kb(u/a,-1,1)))),c=Math.max(i,Math.min(s,c))),this.labelRotation=c}afterCalculateLabelRotation(){lb(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){lb(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:n,title:i,grid:s}}=this,r=this._isVisible(),o=this.isHorizontal();if(r){const r=sS(i,e.options.font);if(o?(t.width=this.maxWidth,t.height=iS(s)+r):(t.height=this.maxHeight,t.width=iS(s)+r),n.display&&this.ticks.length){const{first:e,last:i,widest:s,highest:r}=this._getLabelSizes(),a=2*n.padding,c=Ub(this.labelRotation),h=Math.cos(c),l=Math.sin(c);if(o){const e=n.mirror?0:l*s.width+h*r.height;t.height=Math.min(this.maxHeight,t.height+e+a)}else{const e=n.mirror?0:h*s.width+l*r.height;t.width=Math.min(this.maxWidth,t.width+e+a)}this._calculatePadding(e,i,l,h)}}this._handleMargins(),o?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,n,i){const{ticks:{align:s,padding:r},position:o}=this.options,a=0!==this.labelRotation,c="top"!==o&&"x"===this.axis;if(this.isHorizontal()){const o=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let l=0,u=0;a?c?(l=i*t.width,u=n*e.height):(l=n*t.height,u=i*e.width):"start"===s?u=e.width:"end"===s?l=t.width:"inner"!==s&&(l=t.width/2,u=e.width/2),this.paddingLeft=Math.max((l-o+r)*this.width/(this.width-o),0),this.paddingRight=Math.max((u-h+r)*this.width/(this.width-h),0)}else{let n=e.height/2,i=t.height/2;"start"===s?(n=0,i=t.height):"end"===s&&(n=e.height,i=0),this.paddingTop=n+r,this.paddingBottom=i+r}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){lb(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,n=t.length;e<n;e++)ib(t[e].label)&&(t.splice(e,1),n--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let n=this.ticks;e<n.length&&(n=eS(n,e)),this._labelSizes=t=this._computeLabelSizes(n,n.length)}return t}_computeLabelSizes(t,e){const{ctx:n,_longestTextCache:i}=this,s=[],r=[];let o,a,c,h,l,u,d,f,p,g,m,y=0,v=0;for(o=0;o<e;++o){if(h=t[o].label,l=this._resolveTickFontOptions(o),n.font=u=l.string,d=i[u]=i[u]||{data:{},gc:[]},f=l.lineHeight,p=g=0,ib(h)||sb(h)){if(sb(h))for(a=0,c=h.length;a<c;++a)m=h[a],ib(m)||sb(m)||(p=Z_(n,d.data,d.gc,p,m),g+=f)}else p=Z_(n,d.data,d.gc,p,h),g=f;s.push(p),r.push(g),y=Math.max(p,y),v=Math.max(g,v)}!function(t,e){ub(t,(t=>{const n=t.gc,i=n.length/2;let s;if(i>e){for(s=0;s<i;++s)delete t.data[n[s]];n.splice(0,i)}}))}(i,e);const b=s.indexOf(y),_=r.indexOf(v),w=t=>({width:s[t]||0,height:r[t]||0});return{first:w(0),last:w(e-1),widest:w(b),highest:w(_),widths:s,heights:r}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return Kb(this._alignToPixels?ew(this.chart,e,0):e,-32768,32767)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const n=e[t];return n.$context||(n.$context=function(t,e,n){return xw(t,{tick:n,index:e,type:"tick"})}(this.getContext(),t,n))}return this.$context||(this.$context=xw(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const t=this.options.ticks,e=Ub(this.labelRotation),n=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),s=this._getLabelSizes(),r=t.autoSkipPadding||0,o=s?s.widest.width+r:0,a=s?s.highest.height+r:0;return this.isHorizontal()?a*n>o*i?o/n:a/i:a*i<o*n?a/n:o/i}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,n=this.chart,i=this.options,{grid:s,position:r}=i,o=s.offset,a=this.isHorizontal(),c=this.ticks.length+(o?1:0),h=iS(s),l=[],u=s.setContext(this.getContext()),d=u.drawBorder?u.borderWidth:0,f=d/2,p=function(t){return ew(n,t,d)};let g,m,y,v,b,_,w,x,S,E,T,k;if("top"===r)g=p(this.bottom),_=this.bottom-h,x=g-f,E=p(t.top)+f,k=t.bottom;else if("bottom"===r)g=p(this.top),E=t.top,k=p(t.bottom)-f,_=g+f,x=this.top+h;else if("left"===r)g=p(this.right),b=this.right-h,w=g-f,S=p(t.left)+f,T=t.right;else if("right"===r)g=p(this.left),S=t.left,T=p(t.right)-f,b=g+f,w=this.left+h;else if("x"===e){if("center"===r)g=p((t.top+t.bottom)/2+.5);else if(rb(r)){const t=Object.keys(r)[0],e=r[t];g=p(this.chart.scales[t].getPixelForValue(e))}E=t.top,k=t.bottom,_=g+f,x=_+h}else if("y"===e){if("center"===r)g=p((t.left+t.right)/2);else if(rb(r)){const t=Object.keys(r)[0],e=r[t];g=p(this.chart.scales[t].getPixelForValue(e))}b=g-f,w=b-h,S=t.left,T=t.right}const I=cb(i.ticks.maxTicksLimit,c),C=Math.max(1,Math.ceil(c/I));for(m=0;m<c;m+=C){const t=s.setContext(this.getContext(m)),e=t.lineWidth,i=t.color,r=t.borderDash||[],c=t.borderDashOffset,h=t.tickWidth,u=t.tickColor,d=t.tickBorderDash||[],f=t.tickBorderDashOffset;y=nS(this,m,o),void 0!==y&&(v=ew(n,y,e),a?b=w=S=T=v:_=x=E=k=v,l.push({tx1:b,ty1:_,tx2:w,ty2:x,x1:S,y1:E,x2:T,y2:k,width:e,color:i,borderDash:r,borderDashOffset:c,tickWidth:h,tickColor:u,tickBorderDash:d,tickBorderDashOffset:f}))}return this._ticksLength=c,this._borderValue=g,l}_computeLabelItems(t){const e=this.axis,n=this.options,{position:i,ticks:s}=n,r=this.isHorizontal(),o=this.ticks,{align:a,crossAlign:c,padding:h,mirror:l}=s,u=iS(n.grid),d=u+h,f=l?-h:d,p=-Ub(this.labelRotation),g=[];let m,y,v,b,_,w,x,S,E,T,k,I,C="middle";if("top"===i)w=this.bottom-f,x=this._getXAxisLabelAlignment();else if("bottom"===i)w=this.top+f,x=this._getXAxisLabelAlignment();else if("left"===i){const t=this._getYAxisLabelAlignment(u);x=t.textAlign,_=t.x}else if("right"===i){const t=this._getYAxisLabelAlignment(u);x=t.textAlign,_=t.x}else if("x"===e){if("center"===i)w=(t.top+t.bottom)/2+d;else if(rb(i)){const t=Object.keys(i)[0],e=i[t];w=this.chart.scales[t].getPixelForValue(e)+d}x=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===i)_=(t.left+t.right)/2-d;else if(rb(i)){const t=Object.keys(i)[0],e=i[t];_=this.chart.scales[t].getPixelForValue(e)}x=this._getYAxisLabelAlignment(u).textAlign}"y"===e&&("start"===a?C="top":"end"===a&&(C="bottom"));const A=this._getLabelSizes();for(m=0,y=o.length;m<y;++m){v=o[m],b=v.label;const t=s.setContext(this.getContext(m));S=this.getPixelForTick(m)+s.labelOffset,E=this._resolveTickFontOptions(m),T=E.lineHeight,k=sb(b)?b.length:1;const e=k/2,n=t.color,a=t.textStrokeColor,h=t.textStrokeWidth;let u,d=x;if(r?(_=S,"inner"===x&&(d=m===y-1?this.options.reverse?"left":"right":0===m?this.options.reverse?"right":"left":"center"),I="top"===i?"near"===c||0!==p?-k*T+T/2:"center"===c?-A.highest.height/2-e*T+T:-A.highest.height+T/2:"near"===c||0!==p?T/2:"center"===c?A.highest.height/2-e*T:A.highest.height-k*T,l&&(I*=-1)):(w=S,I=(1-k)*T/2),t.showLabelBackdrop){const e=bw(t.backdropPadding),n=A.heights[m],i=A.widths[m];let s=w+I-e.top,r=_-e.left;switch(C){case"middle":s-=n/2;break;case"bottom":s-=n}switch(x){case"center":r-=i/2;break;case"right":r-=i}u={left:r,top:s,width:i+e.width,height:n+e.height,color:t.backdropColor}}g.push({rotation:p,label:b,font:E,color:n,strokeColor:a,strokeWidth:h,textOffset:I,textAlign:d,textBaseline:C,translation:[_,w],backdrop:u})}return g}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-Ub(this.labelRotation))return"top"===t?"left":"right";let n="center";return"start"===e.align?n="left":"end"===e.align?n="right":"inner"===e.align&&(n="inner"),n}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:n,mirror:i,padding:s}}=this.options,r=t+s,o=this._getLabelSizes().widest.width;let a,c;return"left"===e?i?(c=this.right+s,"near"===n?a="left":"center"===n?(a="center",c+=o/2):(a="right",c+=o)):(c=this.right-r,"near"===n?a="right":"center"===n?(a="center",c-=o/2):(a="left",c=this.left)):"right"===e?i?(c=this.left+s,"near"===n?a="right":"center"===n?(a="center",c-=o/2):(a="left",c-=o)):(c=this.left+r,"near"===n?a="left":"center"===n?(a="center",c+=o/2):(a="right",c=this.right)):a="right",{textAlign:a,x:c}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:n,top:i,width:s,height:r}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(n,i,s,r),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const n=this.ticks.findIndex((e=>e.value===t));if(n>=0){return e.setContext(this.getContext(n)).lineWidth}return 0}drawGrid(t){const e=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let s,r;const o=(t,e,i)=>{i.width&&i.color&&(n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.setLineDash(i.borderDash||[]),n.lineDashOffset=i.borderDashOffset,n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(e.x,e.y),n.stroke(),n.restore())};if(e.display)for(s=0,r=i.length;s<r;++s){const t=i[s];e.drawOnChartArea&&o({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),e.drawTicks&&o({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{grid:n}}=this,i=n.setContext(this.getContext()),s=n.drawBorder?i.borderWidth:0;if(!s)return;const r=n.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let a,c,h,l;this.isHorizontal()?(a=ew(t,this.left,s)-s/2,c=ew(t,this.right,r)+r/2,h=l=o):(h=ew(t,this.top,s)-s/2,l=ew(t,this.bottom,r)+r/2,a=c=o),e.save(),e.lineWidth=i.borderWidth,e.strokeStyle=i.borderColor,e.beginPath(),e.moveTo(a,h),e.lineTo(c,l),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const e=this.ctx,n=this._computeLabelArea();n&&ow(e,n);const i=this._labelItems||(this._labelItems=this._computeLabelItems(t));let s,r;for(s=0,r=i.length;s<r;++s){const t=i[s],n=t.font,r=t.label;t.backdrop&&(e.fillStyle=t.backdrop.color,e.fillRect(t.backdrop.left,t.backdrop.top,t.backdrop.width,t.backdrop.height)),lw(e,r,0,t.textOffset,n,t)}n&&aw(e)}drawTitle(){const{ctx:t,options:{position:e,title:n,reverse:i}}=this;if(!n.display)return;const s=_w(n.font),r=bw(n.padding),o=n.align;let a=s.lineHeight/2;"bottom"===e||"center"===e||rb(e)?(a+=r.bottom,sb(n.text)&&(a+=s.lineHeight*(n.text.length-1))):a+=r.top;const{titleX:c,titleY:h,maxWidth:l,rotation:u}=function(t,e,n,i){const{top:s,left:r,bottom:o,right:a,chart:c}=t,{chartArea:h,scales:l}=c;let u,d,f,p=0;const g=o-s,m=a-r;if(t.isHorizontal()){if(d=s_(i,r,a),rb(n)){const t=Object.keys(n)[0],i=n[t];f=l[t].getPixelForValue(i)+g-e}else f="center"===n?(h.bottom+h.top)/2+g-e:tS(t,n,e);u=a-r}else{if(rb(n)){const t=Object.keys(n)[0],i=n[t];d=l[t].getPixelForValue(i)-m+e}else d="center"===n?(h.left+h.right)/2-m+e:tS(t,n,e);f=s_(i,o,s),p="left"===n?-Mb:Mb}return{titleX:d,titleY:f,maxWidth:u,rotation:p}}(this,a,e,o);lw(t,n.text,0,0,s,{color:n.color,maxWidth:l,rotation:u,textAlign:rS(o,e,i),textBaseline:"middle",translation:[c,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,n=cb(t.grid&&t.grid.z,-1);return this._isVisible()&&this.draw===oS.prototype.draw?[{z:n,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:n+1,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let s,r;for(s=0,r=e.length;s<r;++s){const r=e[s];r[n]!==this.id||t&&r.type!==t||i.push(r)}return i}_resolveTickFontOptions(t){return _w(this.options.ticks.setContext(this.getContext(t)).font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class aS{constructor(t,e,n){this.type=t,this.scope=e,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let n;(function(t){return"id"in t&&"defaults"in t})(e)&&(n=this.register(e));const i=this.items,s=t.id,r=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+t);return s in i||(i[s]=t,function(t,e,n){const i=mb(Object.create(null),[n?J_.get(n):{},J_.get(e),t.defaults]);J_.set(e,i),t.defaultRoutes&&function(t,e){Object.keys(e).forEach((n=>{const i=n.split("."),s=i.pop(),r=[t].concat(i).join("."),o=e[n].split("."),a=o.pop(),c=o.join(".");J_.route(r,s,c,a)}))}(e,t.defaultRoutes);t.descriptors&&J_.describe(e,t.descriptors)}(t,r,n),this.override&&J_.override(t.id,t.overrides)),r}get(t){return this.items[t]}unregister(t){const e=this.items,n=t.id,i=this.scope;n in e&&delete e[n],i&&n in J_[i]&&(delete J_[i][n],this.override&&delete G_[n])}}var cS=new class{constructor(){this.controllers=new aS(Px,"datasets",!0),this.elements=new aS(Yx,"elements"),this.plugins=new aS(Object,"plugins"),this.scales=new aS(oS,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,n){[...e].forEach((e=>{const i=n||this._getRegistryForType(e);n||i.isForType(e)||i===this.plugins&&e.id?this._exec(t,i,e):ub(e,(e=>{const i=n||this._getRegistryForType(e);this._exec(t,i,e)}))}))}_exec(t,e,n){const i=wb(t);lb(n["before"+i],[],n),e[t](n),lb(n["after"+i],[],n)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const n=this._typedRegistries[e];if(n.isForType(t))return n}return this.plugins}_get(t,e,n){const i=e.get(t);if(void 0===i)throw new Error('"'+t+'" is not a registered '+n+".");return i}};class hS extends Px{update(t){const e=this._cachedMeta,{data:n=[]}=e,i=this.chart._animationsDisabled;let{start:s,count:r}=r_(e,n,i);if(this._drawStart=s,this._drawCount=r,o_(e)&&(s=0,r=n.length),this.options.showLine){const{dataset:s,_dataset:r}=e;s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!r._decimated,s.points=n;const o=this.resolveDatasetElementOptions(t);o.segment=this.options.segment,this.updateElement(s,void 0,{animated:!i,options:o},t)}this.updateElements(n,s,r,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=cS.getElement("line")),super.addElements()}updateElements(t,e,n,i){const s="reset"===i,{iScale:r,vScale:o,_stacked:a,_dataset:c}=this._cachedMeta,h=this.resolveDataElementOptions(e,i),l=this.getSharedOptions(h),u=this.includeOptions(i,l),d=r.axis,f=o.axis,{spanGaps:p,segment:g}=this.options,m=Lb(p)?p:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||s||"none"===i;let v=e>0&&this.getParsed(e-1);for(let b=e;b<e+n;++b){const e=t[b],n=this.getParsed(b),h=y?e:{},p=ib(n[f]),_=h[d]=r.getPixelForValue(n[d],b),w=h[f]=s||p?o.getBasePixel():o.getPixelForValue(a?this.applyStack(o,n,a):n[f],b);h.skip=isNaN(_)||isNaN(w)||p,h.stop=b>0&&Math.abs(n[d]-v[d])>m,g&&(h.parsed=n,h.raw=c.data[b]),u&&(h.options=l||this.resolveDataElementOptions(b,e.active?"active":i)),y||this.updateElement(e,b,h,i),v=n}this.updateSharedOptions(l,i,h)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let t=0;for(let n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}const n=t.dataset,i=n.options&&n.options.borderWidth||0;if(!e.length)return i;const s=e[0].size(this.resolveDataElementOptions(0)),r=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(i,s,r)/2}}hS.id="scatter",hS.defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1},hS.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title:()=>"",label:t=>"("+t.label+", "+t.formattedValue+")"}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var lS=Object.freeze({__proto__:null,BarController:zx,BubbleController:Hx,DoughnutController:Wx,LineController:$x,PolarAreaController:qx,PieController:Kx,RadarController:Gx,ScatterController:hS});function uS(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class dS{constructor(t){this.options=t||{}}init(t){}formats(){return uS()}parse(t,e){return uS()}format(t,e){return uS()}add(t,e,n){return uS()}diff(t,e,n){return uS()}startOf(t,e,n){return uS()}endOf(t,e){return uS()}}dS.override=function(t){Object.assign(dS.prototype,t)};var fS={_date:dS};function pS(t,e,n,i){const{controller:s,data:r,_sorted:o}=t,a=s._cachedMeta.iScale;if(a&&e===a.axis&&"r"!==e&&o&&r.length){const t=a._reversePixels?Qb:Xb;if(!i)return t(r,e,n);if(s._sharedOptions){const i=r[0],s="function"==typeof i.getRange&&i.getRange(e);if(s){const i=t(r,e,n-s),o=t(r,e,n+s);return{lo:i.lo,hi:o.hi}}}}return{lo:0,hi:r.length-1}}function gS(t,e,n,i,s){const r=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,c=r.length;a<c;++a){const{index:t,data:n}=r[a],{lo:c,hi:h}=pS(r[a],e,o,s);for(let e=c;e<=h;++e){const s=n[e];s.skip||i(s,t,e)}}}function mS(t,e,n,i,s){const r=[];if(!s&&!t.isPointInArea(e))return r;return gS(t,n,e,(function(n,o,a){(s||rw(n,t.chartArea,0))&&n.inRange(e.x,e.y,i)&&r.push({element:n,datasetIndex:o,index:a})}),!0),r}function yS(t,e,n,i,s,r){let o=[];const a=function(t){const e=-1!==t.indexOf("x"),n=-1!==t.indexOf("y");return function(t,i){const s=e?Math.abs(t.x-i.x):0,r=n?Math.abs(t.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(r,2))}}(n);let c=Number.POSITIVE_INFINITY;return gS(t,n,e,(function(n,h,l){const u=n.inRange(e.x,e.y,s);if(i&&!u)return;const d=n.getCenterPoint(s);if(!(!!r||t.isPointInArea(d))&&!u)return;const f=a(e,d);f<c?(o=[{element:n,datasetIndex:h,index:l}],c=f):f===c&&o.push({element:n,datasetIndex:h,index:l})})),o}function vS(t,e,n,i,s,r){return r||t.isPointInArea(e)?"r"!==n||i?yS(t,e,n,i,s,r):function(t,e,n,i){let s=[];return gS(t,n,e,(function(t,n,r){const{startAngle:o,endAngle:a}=t.getProps(["startAngle","endAngle"],i),{angle:c}=zb(t,{x:e.x,y:e.y});qb(c,o,a)&&s.push({element:t,datasetIndex:n,index:r})})),s}(t,e,n,s):[]}function bS(t,e,n,i,s){const r=[],o="x"===n?"inXRange":"inYRange";let a=!1;return gS(t,n,e,((t,i,c)=>{t[o](e[n],s)&&(r.push({element:t,datasetIndex:i,index:c}),a=a||t.inRange(e.x,e.y,s))})),i&&!a?[]:r}var _S={evaluateInteractionItems:gS,modes:{index(t,e,n,i){const s=Xw(e,t),r=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?mS(t,s,r,i,o):vS(t,s,r,!1,i,o),c=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach((t=>{const e=a[0].index,n=t.data[e];n&&!n.skip&&c.push({element:n,datasetIndex:t.index,index:e})})),c):[]},dataset(t,e,n,i){const s=Xw(e,t),r=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?mS(t,s,r,i,o):vS(t,s,r,!1,i,o);if(a.length>0){const e=a[0].datasetIndex,n=t.getDatasetMeta(e).data;a=[];for(let t=0;t<n.length;++t)a.push({element:n[t],datasetIndex:e,index:t})}return a},point:(t,e,n,i)=>mS(t,Xw(e,t),n.axis||"xy",i,n.includeInvisible||!1),nearest(t,e,n,i){const s=Xw(e,t),r=n.axis||"xy",o=n.includeInvisible||!1;return vS(t,s,r,n.intersect,i,o)},x:(t,e,n,i)=>bS(t,Xw(e,t),"x",n.intersect,i),y:(t,e,n,i)=>bS(t,Xw(e,t),"y",n.intersect,i)}};const wS=["left","top","right","bottom"];function xS(t,e){return t.filter((t=>t.pos===e))}function SS(t,e){return t.filter((t=>-1===wS.indexOf(t.pos)&&t.box.axis===e))}function ES(t,e){return t.sort(((t,n)=>{const i=e?n:t,s=e?t:n;return i.weight===s.weight?i.index-s.index:i.weight-s.weight}))}function TS(t,e){const n=function(t){const e={};for(const n of t){const{stack:t,pos:i,stackWeight:s}=n;if(!t||!wS.includes(i))continue;const r=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});r.count++,r.weight+=s}return e}(t),{vBoxMaxWidth:i,hBoxMaxHeight:s}=e;let r,o,a;for(r=0,o=t.length;r<o;++r){a=t[r];const{fullSize:o}=a.box,c=n[a.stack],h=c&&a.stackWeight/c.weight;a.horizontal?(a.width=h?h*i:o&&e.availableWidth,a.height=s):(a.width=i,a.height=h?h*s:o&&e.availableHeight)}return n}function kS(t,e,n,i){return Math.max(t[n],e[n])+Math.max(t[i],e[i])}function IS(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function CS(t,e,n,i){const{pos:s,box:r}=n,o=t.maxPadding;if(!rb(s)){n.size&&(t[s]-=n.size);const e=i[n.stack]||{size:0,count:1};e.size=Math.max(e.size,n.horizontal?r.height:r.width),n.size=e.size/e.count,t[s]+=n.size}r.getPadding&&IS(o,r.getPadding());const a=Math.max(0,e.outerWidth-kS(o,t,"left","right")),c=Math.max(0,e.outerHeight-kS(o,t,"top","bottom")),h=a!==t.w,l=c!==t.h;return t.w=a,t.h=c,n.horizontal?{same:h,other:l}:{same:l,other:h}}function AS(t,e){const n=e.maxPadding;function i(t){const i={left:0,top:0,right:0,bottom:0};return t.forEach((t=>{i[t]=Math.max(e[t],n[t])})),i}return i(t?["left","right"]:["top","bottom"])}function MS(t,e,n,i){const s=[];let r,o,a,c,h,l;for(r=0,o=t.length,h=0;r<o;++r){a=t[r],c=a.box,c.update(a.width||e.w,a.height||e.h,AS(a.horizontal,e));const{same:o,other:u}=CS(e,n,a,i);h|=o&&s.length,l=l||u,c.fullSize||s.push(a)}return h&&MS(s,e,n,i)||l}function DS(t,e,n,i,s){t.top=n,t.left=e,t.right=e+i,t.bottom=n+s,t.width=i,t.height=s}function OS(t,e,n,i){const s=n.padding;let{x:r,y:o}=e;for(const a of t){const t=a.box,c=i[a.stack]||{count:1,placed:0,weight:1},h=a.stackWeight/c.weight||1;if(a.horizontal){const i=e.w*h,r=c.size||t.height;xb(c.start)&&(o=c.start),t.fullSize?DS(t,s.left,o,n.outerWidth-s.right-s.left,r):DS(t,e.left+c.placed,o,i,r),c.start=o,c.placed+=i,o=t.bottom}else{const i=e.h*h,o=c.size||t.width;xb(c.start)&&(r=c.start),t.fullSize?DS(t,r,s.top,o,n.outerHeight-s.bottom-s.top):DS(t,r,e.top+c.placed,o,i),c.start=r,c.placed+=i,r=t.right}}e.x=r,e.y=o}J_.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var PS={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;-1!==n&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,i){if(!t)return;const s=bw(t.options.layout.padding),r=Math.max(e-s.width,0),o=Math.max(n-s.height,0),a=function(t){const e=function(t){const e=[];let n,i,s,r,o,a;for(n=0,i=(t||[]).length;n<i;++n)s=t[n],({position:r,options:{stack:o,stackWeight:a=1}}=s),e.push({index:n,box:s,pos:r,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&r+o,stackWeight:a});return e}(t),n=ES(e.filter((t=>t.box.fullSize)),!0),i=ES(xS(e,"left"),!0),s=ES(xS(e,"right")),r=ES(xS(e,"top"),!0),o=ES(xS(e,"bottom")),a=SS(e,"x"),c=SS(e,"y");return{fullSize:n,leftAndTop:i.concat(r),rightAndBottom:s.concat(c).concat(o).concat(a),chartArea:xS(e,"chartArea"),vertical:i.concat(s).concat(c),horizontal:r.concat(o).concat(a)}}(t.boxes),c=a.vertical,h=a.horizontal;ub(t.boxes,(t=>{"function"==typeof t.beforeLayout&&t.beforeLayout()}));const l=c.reduce(((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1),0)||1,u=Object.freeze({outerWidth:e,outerHeight:n,padding:s,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/l,hBoxMaxHeight:o/2}),d=Object.assign({},s);IS(d,bw(i));const f=Object.assign({maxPadding:d,w:r,h:o,x:s.left,y:s.top},s),p=TS(c.concat(h),u);MS(a.fullSize,f,u,p),MS(c,f,u,p),MS(h,f,u,p)&&MS(c,f,u,p),function(t){const e=t.maxPadding;function n(n){const i=Math.max(e[n]-t[n],0);return t[n]+=i,i}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}(f),OS(a.leftAndTop,f,u,p),f.x+=f.w,f.y+=f.h,OS(a.rightAndBottom,f,u,p),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},ub(a.chartArea,(e=>{const n=e.box;Object.assign(n,t.chartArea),n.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})}))}};class RS{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,n){}removeEventListener(t,e,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,n,i){return e=Math.max(0,e||t.width),n=n||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):n)}}isAttached(t){return!0}updateConfig(t){}}class NS extends RS{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const LS={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},VS=t=>null===t||""===t;const FS=!!tx&&{passive:!0};function US(t,e,n){t.canvas.removeEventListener(e,n,FS)}function jS(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function BS(t,e,n){const i=t.canvas,s=new MutationObserver((t=>{let e=!1;for(const n of t)e=e||jS(n.addedNodes,i),e=e&&!jS(n.removedNodes,i);e&&n()}));return s.observe(document,{childList:!0,subtree:!0}),s}function zS(t,e,n){const i=t.canvas,s=new MutationObserver((t=>{let e=!1;for(const n of t)e=e||jS(n.removedNodes,i),e=e&&!jS(n.addedNodes,i);e&&n()}));return s.observe(document,{childList:!0,subtree:!0}),s}const HS=new Map;let WS=0;function $S(){const t=window.devicePixelRatio;t!==WS&&(WS=t,HS.forEach(((e,n)=>{n.currentDevicePixelRatio!==t&&e()})))}function qS(t,e,n){const i=t.canvas,s=i&&$w(i);if(!s)return;const r=n_(((t,e)=>{const i=s.clientWidth;n(t,e),i<s.clientWidth&&n()}),window),o=new ResizeObserver((t=>{const e=t[0],n=e.contentRect.width,i=e.contentRect.height;0===n&&0===i||r(n,i)}));return o.observe(s),function(t,e){HS.size||window.addEventListener("resize",$S),HS.set(t,e)}(t,r),o}function KS(t,e,n){n&&n.disconnect(),"resize"===e&&function(t){HS.delete(t),HS.size||window.removeEventListener("resize",$S)}(t)}function GS(t,e,n){const i=t.canvas,s=n_((e=>{null!==t.ctx&&n(function(t,e){const n=LS[t.type]||t.type,{x:i,y:s}=Xw(t,e);return{type:n,chart:e,native:t,x:void 0!==i?i:null,y:void 0!==s?s:null}}(e,t))}),t,(t=>{const e=t[0];return[e,e.offsetX,e.offsetY]}));return function(t,e,n){t.addEventListener(e,n,FS)}(i,e,s),s}class YS extends RS{acquireContext(t,e){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(function(t,e){const n=t.style,i=t.getAttribute("height"),s=t.getAttribute("width");if(t.$chartjs={initial:{height:i,width:s,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",VS(s)){const e=ex(t,"width");void 0!==e&&(t.width=e)}if(VS(i))if(""===t.style.height)t.height=t.width/(e||2);else{const e=ex(t,"height");void 0!==e&&(t.height=e)}}(t,e),n):null}releaseContext(t){const e=t.canvas;if(!e.$chartjs)return!1;const n=e.$chartjs.initial;["height","width"].forEach((t=>{const i=n[t];ib(i)?e.removeAttribute(t):e.setAttribute(t,i)}));const i=n.style||{};return Object.keys(i).forEach((t=>{e.style[t]=i[t]})),e.width=e.width,delete e.$chartjs,!0}addEventListener(t,e,n){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),s={attach:BS,detach:zS,resize:qS}[e]||GS;i[e]=s(t,e,n)}removeEventListener(t,e){const n=t.$proxies||(t.$proxies={}),i=n[e];if(!i)return;({attach:KS,detach:KS,resize:KS}[e]||US)(t,e,i),n[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,n,i){return Jw(t,e,n,i)}isAttached(t){const e=$w(t);return!(!e||!e.isConnected)}}class XS{constructor(){this._init=[]}notify(t,e,n,i){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const s=i?this._descriptors(t).filter(i):this._descriptors(t),r=this._notify(s,t,e,n);return"afterDestroy"===e&&(this._notify(s,t,"stop"),this._notify(this._init,t,"uninstall")),r}_notify(t,e,n,i){i=i||{};for(const s of t){const t=s.plugin;if(!1===lb(t[n],[e,i,s.options],t)&&i.cancelable)return!1}return!0}invalidate(){ib(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const n=t&&t.config,i=cb(n.options&&n.options.plugins,{}),s=function(t){const e={},n=[],i=Object.keys(cS.plugins.items);for(let r=0;r<i.length;r++)n.push(cS.getPlugin(i[r]));const s=t.plugins||[];for(let r=0;r<s.length;r++){const t=s[r];-1===n.indexOf(t)&&(n.push(t),e[t.id]=!0)}return{plugins:n,localIds:e}}(n);return!1!==i||e?function(t,{plugins:e,localIds:n},i,s){const r=[],o=t.getContext();for(const a of e){const e=a.id,c=QS(i[e],s);null!==c&&r.push({plugin:a,options:JS(t.config,{plugin:a,local:n[e]},c,o)})}return r}(t,s,i,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],n=this._cache,i=(t,e)=>t.filter((t=>!e.some((e=>t.plugin.id===e.plugin.id))));this._notify(i(e,n),t,"stop"),this._notify(i(n,e),t,"start")}}function QS(t,e){return e||!1!==t?!0===t?{}:t:null}function JS(t,{plugin:e,local:n},i,s){const r=t.pluginScopeKeys(e),o=t.getOptionScopes(i,r);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ZS(t,e){const n=J_.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function tE(t,e){return"x"===t||"y"===t?t:e.axis||("top"===(n=e.position)||"bottom"===n?"x":"left"===n||"right"===n?"y":void 0)||t.charAt(0).toLowerCase();var n}function eE(t){const e=t.options||(t.options={});e.plugins=cb(e.plugins,{}),e.scales=function(t,e){const n=G_[t.type]||{scales:{}},i=e.scales||{},s=ZS(t.type,e),r=Object.create(null),o=Object.create(null);return Object.keys(i).forEach((t=>{const e=i[t];if(!rb(e))return console.error(`Invalid scale configuration for scale: ${t}`);if(e._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${t}`);const a=tE(t,e),c=function(t,e){return t===e?"_index_":"_value_"}(a,s),h=n.scales||{};r[a]=r[a]||t,o[t]=yb(Object.create(null),[{axis:a},e,h[a],h[c]])})),t.data.datasets.forEach((n=>{const s=n.type||t.type,a=n.indexAxis||ZS(s,e),c=(G_[s]||{}).scales||{};Object.keys(c).forEach((t=>{const e=function(t,e){let n=t;return"_index_"===t?n=e:"_value_"===t&&(n="x"===e?"y":"x"),n}(t,a),s=n[e+"AxisID"]||r[e]||e;o[s]=o[s]||Object.create(null),yb(o[s],[{axis:e},i[s],c[t]])}))})),Object.keys(o).forEach((t=>{const e=o[t];yb(e,[J_.scales[e.type],J_.scale])})),o}(t,e)}function nE(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const iE=new Map,sE=new Set;function rE(t,e){let n=iE.get(t);return n||(n=e(),iE.set(t,n),sE.add(n)),n}const oE=(t,e,n)=>{const i=_b(e,n);void 0!==i&&t.add(i)};class aE{constructor(t){this._config=function(t){return(t=t||{}).data=nE(t.data),eE(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=nE(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),eE(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return rE(t,(()=>[[`datasets.${t}`,""]]))}datasetAnimationScopeKeys(t,e){return rE(`${t}.transition.${e}`,(()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]]))}datasetElementScopeKeys(t,e){return rE(`${t}-${e}`,(()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]]))}pluginScopeKeys(t){const e=t.id;return rE(`${this.type}-plugin-${e}`,(()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]]))}_cachedScopes(t,e){const n=this._scopeCache;let i=n.get(t);return i&&!e||(i=new Map,n.set(t,i)),i}getOptionScopes(t,e,n){const{options:i,type:s}=this,r=this._cachedScopes(t,n),o=r.get(e);if(o)return o;const a=new Set;e.forEach((e=>{t&&(a.add(t),e.forEach((e=>oE(a,t,e)))),e.forEach((t=>oE(a,i,t))),e.forEach((t=>oE(a,G_[s]||{},t))),e.forEach((t=>oE(a,J_,t))),e.forEach((t=>oE(a,Y_,t)))}));const c=Array.from(a);return 0===c.length&&c.push(Object.create(null)),sE.has(e)&&r.set(e,c),c}chartOptionScopes(){const{options:t,type:e}=this;return[t,G_[e]||{},J_.datasets[e]||{},{type:e},J_,Y_]}resolveNamedOptions(t,e,n,i=[""]){const s={$shared:!0},{resolver:r,subPrefixes:o}=cE(this._resolverCache,t,i);let a=r;if(function(t,e){const{isScriptable:n,isIndexable:i}=Tw(t);for(const s of e){const e=n(s),r=i(s),o=(r||e)&&t[s];if(e&&(Sb(o)||hE(o))||r&&sb(o))return!0}return!1}(r,e)){s.$shared=!1;a=Ew(r,n=Sb(n)?n():n,this.createResolver(t,n,o))}for(const c of e)s[c]=a[c];return s}createResolver(t,e,n=[""],i){const{resolver:s}=cE(this._resolverCache,t,n);return rb(e)?Ew(s,e,void 0,i):s}}function cE(t,e,n){let i=t.get(e);i||(i=new Map,t.set(e,i));const s=n.join();let r=i.get(s);if(!r){r={resolver:Sw(e,n),subPrefixes:n.filter((t=>!t.toLowerCase().includes("hover")))},i.set(s,r)}return r}const hE=t=>rb(t)&&Object.getOwnPropertyNames(t).reduce(((e,n)=>e||Sb(t[n])),!1);const lE=["top","bottom","left","right","chartArea"];function uE(t,e){return"top"===t||"bottom"===t||-1===lE.indexOf(t)&&"x"===e}function dE(t,e){return function(n,i){return n[t]===i[t]?n[e]-i[e]:n[t]-i[t]}}function fE(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),lb(n&&n.onComplete,[t],e)}function pE(t){const e=t.chart,n=e.options.animation;lb(n&&n.onProgress,[t],e)}function gE(t){return Ww()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const mE={},yE=t=>{const e=gE(t);return Object.values(mE).filter((t=>t.canvas===e)).pop()};function vE(t,e,n){const i=Object.keys(t);for(const s of i){const i=+s;if(i>=e){const r=t[s];delete t[s],(n>0||i>e)&&(t[i+n]=r)}}}class bE{constructor(t,e){const n=this.config=new aE(e),i=gE(t),s=yE(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const r=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||function(t){return!Ww()||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas?NS:YS}(i)),this.platform.updateConfig(n);const o=this.platform.acquireContext(i,r.aspectRatio),a=o&&o.canvas,c=a&&a.height,h=a&&a.width;this.id=nb(),this.ctx=o,this.canvas=a,this.width=h,this.height=c,this._options=r,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new XS,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(t,e){let n;return function(...i){return e?(clearTimeout(n),n=setTimeout(t,e,i)):t.apply(this,i),e}}((t=>this.update(t)),r.resizeDelay||0),this._dataChanges=[],mE[this.id]=this,o&&a?(yx.listen(this,"complete",fE),yx.listen(this,"progress",pE),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:n,height:i,_aspectRatio:s}=this;return ib(t)?e&&s?s:i?n/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Zw(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return nw(this.canvas,this.ctx),this}stop(){return yx.stop(this),this}resize(t,e){yx.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const n=this.options,i=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,r=this.platform.getMaximumSize(i,t,e,s),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),a=this.width?"resize":"attach";this.width=r.width,this.height=r.height,this._aspectRatio=this.aspectRatio,Zw(this,o,!0)&&(this.notifyPlugins("resize",{size:r}),lb(n.onResize,[this,r],this),this.attached&&this._doResize(a)&&this.render())}ensureScalesHaveIDs(){ub(this.options.scales||{},((t,e)=>{t.id=e}))}buildOrUpdateScales(){const t=this.options,e=t.scales,n=this.scales,i=Object.keys(n).reduce(((t,e)=>(t[e]=!1,t)),{});let s=[];e&&(s=s.concat(Object.keys(e).map((t=>{const n=e[t],i=tE(t,n),s="r"===i,r="x"===i;return{options:n,dposition:s?"chartArea":r?"bottom":"left",dtype:s?"radialLinear":r?"category":"linear"}})))),ub(s,(e=>{const s=e.options,r=s.id,o=tE(r,s),a=cb(s.type,e.dtype);void 0!==s.position&&uE(s.position,o)===uE(e.dposition)||(s.position=e.dposition),i[r]=!0;let c=null;if(r in n&&n[r].type===a)c=n[r];else{c=new(cS.getScale(a))({id:r,type:a,ctx:this.ctx,chart:this}),n[c.id]=c}c.init(s,t)})),ub(i,((t,e)=>{t||delete n[e]})),ub(n,(t=>{PS.configure(this,t,t.options),PS.addBox(this,t)}))}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,n=t.length;if(t.sort(((t,e)=>t.index-e.index)),n>e){for(let t=e;t<n;++t)this._destroyDatasetMeta(t);t.splice(e,n-e)}this._sortedMetasets=t.slice(0).sort(dE("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach(((t,n)=>{0===e.filter((e=>e===t._dataset)).length&&this._destroyDatasetMeta(n)}))}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=e.length;n<i;n++){const i=e[n];let s=this.getDatasetMeta(n);const r=i.type||this.config.type;if(s.type&&s.type!==r&&(this._destroyDatasetMeta(n),s=this.getDatasetMeta(n)),s.type=r,s.indexAxis=i.indexAxis||ZS(r,this.options),s.order=i.order||0,s.index=n,s.label=""+i.label,s.visible=this.isDatasetVisible(n),s.controller)s.controller.updateIndex(n),s.controller.linkScales();else{const e=cS.getController(r),{datasetElementType:i,dataElementType:o}=J_.datasets[r];Object.assign(e.prototype,{dataElementType:cS.getElement(o),datasetElementType:i&&cS.getElement(i)}),s.controller=new e(this,n),t.push(s.controller)}}return this._updateMetasets(),t}_resetElements(){ub(this.data.datasets,((t,e)=>{this.getDatasetMeta(e).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const n=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let r=0;for(let c=0,h=this.data.datasets.length;c<h;c++){const{controller:t}=this.getDatasetMeta(c),e=!i&&-1===s.indexOf(t);t.buildOrUpdateElements(e),r=Math.max(+t.getMaxOverflow(),r)}r=this._minPadding=n.layout.autoPadding?r:0,this._updateLayout(r),i||ub(s,(t=>{t.reset()})),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(dE("z","_idx"));const{_active:o,_lastEvent:a}=this;a?this._eventHandler(a,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){ub(this.scales,(t=>{PS.removeBox(this,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),n=new Set(t.events);Eb(e,n)&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:s}of e){vE(t,i,"_removeElements"===n?-s:s)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,n=e=>new Set(t.filter((t=>t[0]===e)).map(((t,e)=>e+","+t.splice(1).join(",")))),i=n(0);for(let s=1;s<e;s++)if(!Eb(i,n(s)))return;return Array.from(i).map((t=>t.split(","))).map((t=>({method:t[1],start:+t[2],count:+t[3]})))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;PS.update(this,this.width,this.height,t);const e=this.chartArea,n=e.width<=0||e.height<=0;this._layers=[],ub(this.boxes,(t=>{n&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))}),this),this._layers.forEach(((t,e)=>{t._idx=e})),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,n=this.data.datasets.length;e<n;++e)this._updateDataset(e,Sb(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const n=this.getDatasetMeta(t),i={meta:n,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",i)&&(n.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(yx.has(this)?this.attached&&!yx.running(this)&&yx.start(this):(this.draw(),fE({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:t,height:e}=this._resizeBeforeDraw;this._resize(t,e),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,n=[];let i,s;for(i=0,s=e.length;i<s;++i){const s=e[i];t&&!s.visible||n.push(s)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,n=t._clip,i=!n.disabled,s=this.chartArea,r={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",r)&&(i&&ow(e,{left:!1===n.left?0:s.left-n.left,right:!1===n.right?this.width:s.right+n.right,top:!1===n.top?0:s.top-n.top,bottom:!1===n.bottom?this.height:s.bottom+n.bottom}),t.controller.draw(),i&&aw(e),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(t){return rw(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,n,i){const s=_S.modes[e];return"function"==typeof s?s(this,t,n,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],n=this._metasets;let i=n.filter((t=>t&&t._dataset===e)).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=xw(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const n=this.getDatasetMeta(t);return"boolean"==typeof n.hidden?!n.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,n){const i=n?"show":"hide",s=this.getDatasetMeta(t),r=s.controller._resolveAnimations(void 0,i);xb(e)?(s.data[e].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),r.update(s,{visible:n}),this.update((e=>e.datasetIndex===t?i:void 0)))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),yx.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),nw(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete mE[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,n=(n,i)=>{e.addEventListener(this,n,i),t[n]=i},i=(t,e,n)=>{t.offsetX=e,t.offsetY=n,this._eventHandler(t)};ub(this.options.events,(t=>n(t,i)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,n=(n,i)=>{e.addEventListener(this,n,i),t[n]=i},i=(n,i)=>{t[n]&&(e.removeEventListener(this,n,i),delete t[n])},s=(t,e)=>{this.canvas&&this.resize(t,e)};let r;const o=()=>{i("attach",o),this.attached=!0,this.resize(),n("resize",s),n("detach",r)};r=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),n("attach",o)},e.isAttached(this.canvas)?o():r()}unbindEvents(){ub(this._listeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._listeners={},ub(this._responsiveListeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._responsiveListeners=void 0}updateHoverStyle(t,e,n){const i=n?"set":"remove";let s,r,o,a;for("dataset"===e&&(s=this.getDatasetMeta(t[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),o=0,a=t.length;o<a;++o){r=t[o];const e=r&&this.getDatasetMeta(r.datasetIndex).controller;e&&e[i+"HoverStyle"](r.element,r.datasetIndex,r.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],n=t.map((({datasetIndex:t,index:e})=>{const n=this.getDatasetMeta(t);if(!n)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:n.data[e],index:e}}));!db(n,e)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,e))}notifyPlugins(t,e,n){return this._plugins.notify(this,t,e,n)}_updateHoverStyles(t,e,n){const i=this.options.hover,s=(t,e)=>t.filter((t=>!e.some((e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)))),r=s(e,t),o=n?t:s(t,e);r.length&&this.updateHoverStyle(r,i.mode,!1),o.length&&i.mode&&this.updateHoverStyle(o,i.mode,!0)}_eventHandler(t,e){const n={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},i=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",n,i))return;const s=this._handleEvent(t,e,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(s||n.changed)&&this.render(),this}_handleEvent(t,e,n){const{_active:i=[],options:s}=this,r=e,o=this._getActiveElements(t,i,n,r),a=function(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}(t),c=function(t,e,n,i){return n&&"mouseout"!==t.type?i?e:t:null}(t,this._lastEvent,n,a);n&&(this._lastEvent=null,lb(s.onHover,[t,o,this],this),a&&lb(s.onClick,[t,o,this],this));const h=!db(o,i);return(h||e)&&(this._active=o,this._updateHoverStyles(o,i,e)),this._lastEvent=c,h}_getActiveElements(t,e,n,i){if("mouseout"===t.type)return[];if(!n)return e;const s=this.options.hover;return this.getElementsAtEventForMode(t,s.mode,s,i)}}const _E=()=>ub(bE.instances,(t=>t._plugins.invalidate()));function wE(t,e,n){const{startAngle:i,pixelMargin:s,x:r,y:o,outerRadius:a,innerRadius:c}=e;let h=s/a;t.beginPath(),t.arc(r,o,a,i-h,n+h),c>s?(h=s/c,t.arc(r,o,c,n+h,i-h,!0)):t.arc(r,o,s,n+Mb,i-Mb),t.closePath(),t.clip()}function xE(t,e,n,i){const s=mw(t.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const r=(n-e)/2,o=Math.min(r,i*e/2),a=t=>{const e=(n-Math.min(r,t))*i/2;return Kb(t,0,Math.min(r,e))};return{outerStart:a(s.outerStart),outerEnd:a(s.outerEnd),innerStart:Kb(s.innerStart,0,o),innerEnd:Kb(s.innerEnd,0,o)}}function SE(t,e,n,i){return{x:n+t*Math.cos(e),y:i+t*Math.sin(e)}}function EE(t,e,n,i,s,r){const{x:o,y:a,startAngle:c,pixelMargin:h,innerRadius:l}=e,u=Math.max(e.outerRadius+i+n-h,0),d=l>0?l+i+n+h:0;let f=0;const p=s-c;if(i){const t=((l>0?l-i:0)+(u>0?u-i:0))/2;f=(p-(0!==t?p*t/(t+i):p))/2}const g=(p-Math.max(.001,p*u-n/Tb)/u)/2,m=c+g+f,y=s-g-f,{outerStart:v,outerEnd:b,innerStart:_,innerEnd:w}=xE(e,d,u,y-m),x=u-v,S=u-b,E=m+v/x,T=y-b/S,k=d+_,I=d+w,C=m+_/k,A=y-w/I;if(t.beginPath(),r){if(t.arc(o,a,u,E,T),b>0){const e=SE(S,T,o,a);t.arc(e.x,e.y,b,T,y+Mb)}const e=SE(I,y,o,a);if(t.lineTo(e.x,e.y),w>0){const e=SE(I,A,o,a);t.arc(e.x,e.y,w,y+Mb,A+Math.PI)}if(t.arc(o,a,d,y-w/d,m+_/d,!0),_>0){const e=SE(k,C,o,a);t.arc(e.x,e.y,_,C+Math.PI,m-Mb)}const n=SE(x,m,o,a);if(t.lineTo(n.x,n.y),v>0){const e=SE(x,E,o,a);t.arc(e.x,e.y,v,m-Mb,E)}}else{t.moveTo(o,a);const e=Math.cos(E)*u+o,n=Math.sin(E)*u+a;t.lineTo(e,n);const i=Math.cos(T)*u+o,s=Math.sin(T)*u+a;t.lineTo(i,s)}t.closePath()}function TE(t,e,n,i,s,r){const{options:o}=e,{borderWidth:a,borderJoinStyle:c}=o,h="inner"===o.borderAlign;a&&(h?(t.lineWidth=2*a,t.lineJoin=c||"round"):(t.lineWidth=a,t.lineJoin=c||"bevel"),e.fullCircles&&function(t,e,n){const{x:i,y:s,startAngle:r,pixelMargin:o,fullCircles:a}=e,c=Math.max(e.outerRadius-o,0),h=e.innerRadius+o;let l;for(n&&wE(t,e,r+kb),t.beginPath(),t.arc(i,s,h,r+kb,r,!0),l=0;l<a;++l)t.stroke();for(t.beginPath(),t.arc(i,s,c,r,r+kb),l=0;l<a;++l)t.stroke()}(t,e,h),h&&wE(t,e,s),EE(t,e,n,i,s,r),t.stroke())}Object.defineProperties(bE,{defaults:{enumerable:true,value:J_},instances:{enumerable:true,value:mE},overrides:{enumerable:true,value:G_},registry:{enumerable:true,value:cS},version:{enumerable:true,value:"3.9.1"},getChart:{enumerable:true,value:yE},register:{enumerable:true,value:(...t)=>{cS.add(...t),_E()}},unregister:{enumerable:true,value:(...t)=>{cS.remove(...t),_E()}}});class kE extends Yx{constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,n){const i=this.getProps(["x","y"],n),{angle:s,distance:r}=zb(i,{x:t,y:e}),{startAngle:o,endAngle:a,innerRadius:c,outerRadius:h,circumference:l}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),u=this.options.spacing/2,d=cb(l,a-o)>=kb||qb(s,o,a),f=Gb(r,c+u,h+u);return d&&f}getCenterPoint(t){const{x:e,y:n,startAngle:i,endAngle:s,innerRadius:r,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],t),{offset:a,spacing:c}=this.options,h=(i+s)/2,l=(r+o+c+a)/2;return{x:e+Math.cos(h)*l,y:n+Math.sin(h)*l}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:n}=this,i=(e.offset||0)/2,s=(e.spacing||0)/2,r=e.circular;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=n>kb?Math.floor(n/kb):0,0===n||this.innerRadius<0||this.outerRadius<0)return;t.save();let o=0;if(i){o=i/2;const e=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(e)*o,Math.sin(e)*o),this.circumference>=Tb&&(o=i)}t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor;const a=function(t,e,n,i,s){const{fullCircles:r,startAngle:o,circumference:a}=e;let c=e.endAngle;if(r){EE(t,e,n,i,o+kb,s);for(let e=0;e<r;++e)t.fill();isNaN(a)||(c=o+a%kb,a%kb==0&&(c+=kb))}return EE(t,e,n,i,c,s),t.fill(),c}(t,this,o,s,r);TE(t,this,o,s,a,r),t.restore()}}function IE(t,e,n=e){t.lineCap=cb(n.borderCapStyle,e.borderCapStyle),t.setLineDash(cb(n.borderDash,e.borderDash)),t.lineDashOffset=cb(n.borderDashOffset,e.borderDashOffset),t.lineJoin=cb(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=cb(n.borderWidth,e.borderWidth),t.strokeStyle=cb(n.borderColor,e.borderColor)}function CE(t,e,n){t.lineTo(n.x,n.y)}function AE(t,e,n={}){const i=t.length,{start:s=0,end:r=i-1}=n,{start:o,end:a}=e,c=Math.max(s,o),h=Math.min(r,a),l=s<o&&r<o||s>a&&r>a;return{count:i,start:c,loop:e.loop,ilen:h<c&&!l?i+h-c:h-c}}function ME(t,e,n,i){const{points:s,options:r}=e,{count:o,start:a,loop:c,ilen:h}=AE(s,n,i),l=function(t){return t.stepped?cw:t.tension||"monotone"===t.cubicInterpolationMode?hw:CE}(r);let u,d,f,{move:p=!0,reverse:g}=i||{};for(u=0;u<=h;++u)d=s[(a+(g?h-u:u))%o],d.skip||(p?(t.moveTo(d.x,d.y),p=!1):l(t,f,d,g,r.stepped),f=d);return c&&(d=s[(a+(g?h:0))%o],l(t,f,d,g,r.stepped)),!!c}function DE(t,e,n,i){const s=e.points,{count:r,start:o,ilen:a}=AE(s,n,i),{move:c=!0,reverse:h}=i||{};let l,u,d,f,p,g,m=0,y=0;const v=t=>(o+(h?a-t:t))%r,b=()=>{f!==p&&(t.lineTo(m,p),t.lineTo(m,f),t.lineTo(m,g))};for(c&&(u=s[v(0)],t.moveTo(u.x,u.y)),l=0;l<=a;++l){if(u=s[v(l)],u.skip)continue;const e=u.x,n=u.y,i=0|e;i===d?(n<f?f=n:n>p&&(p=n),m=(y*m+e)/++y):(b(),t.lineTo(e,n),d=i,y=0,f=p=n),g=n}b()}function OE(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!(t._decimated||t._loop||e.tension||"monotone"===e.cubicInterpolationMode||e.stepped||n)?DE:ME}kE.id="arc",kE.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0},kE.defaultRoutes={backgroundColor:"backgroundColor"};const PE="function"==typeof Path2D;function RE(t,e,n,i){PE&&!e.options.segment?function(t,e,n,i){let s=e._path;s||(s=e._path=new Path2D,e.path(s,n,i)&&s.closePath()),IE(t,e.options),t.stroke(s)}(t,e,n,i):function(t,e,n,i){const{segments:s,options:r}=e,o=OE(e);for(const a of s)IE(t,r,a.style),t.beginPath(),o(t,e,a,{start:n,end:n+i-1})&&t.closePath(),t.stroke()}(t,e,n,i)}class NE extends Yx{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;Hw(this._points,n,t,i,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(t,e){const n=t.points,i=t.options.spanGaps,s=n.length;if(!s)return[];const r=!!t._loop,{start:o,end:a}=function(t,e,n,i){let s=0,r=e-1;if(n&&!i)for(;s<e&&!t[s].skip;)s++;for(;s<e&&t[s].skip;)s++;for(s%=e,n&&(r+=s);r>s&&t[r%e].skip;)r--;return r%=e,{start:s,end:r}}(n,s,r,i);return px(t,!0===i?[{start:o,end:a,loop:r}]:function(t,e,n,i){const s=t.length,r=[];let o,a=e,c=t[e];for(o=e+1;o<=n;++o){const n=t[o%s];n.skip||n.stop?c.skip||(i=!1,r.push({start:e%s,end:(o-1)%s,loop:i}),e=a=n.stop?o:null):(a=o,c.skip&&(e=o)),c=n}return null!==a&&r.push({start:e%s,end:a%s,loop:i}),r}(n,o,a<o?a+s:a,!!t._fullLoop&&0===o&&a===s-1),n,e)}(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,n=t.length;return n&&e[t[n-1].end]}interpolate(t,e){const n=this.options,i=t[e],s=this.points,r=fx(this,{property:e,start:i,end:i});if(!r.length)return;const o=[],a=function(t){return t.stepped?ix:t.tension||"monotone"===t.cubicInterpolationMode?sx:nx}(n);let c,h;for(c=0,h=r.length;c<h;++c){const{start:h,end:l}=r[c],u=s[h],d=s[l];if(u===d){o.push(u);continue}const f=a(u,d,Math.abs((i-u[e])/(d[e]-u[e])),n.stepped);f[e]=t[e],o.push(f)}return 1===o.length?o[0]:o}pathSegment(t,e,n){return OE(this)(t,this,e,n)}path(t,e,n){const i=this.segments,s=OE(this);let r=this._loop;e=e||0,n=n||this.points.length-e;for(const o of i)r&=s(t,this,o,{start:e,end:e+n-1});return!!r}draw(t,e,n,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(t.save(),RE(t,this,n,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function LE(t,e,n,i){const s=t.options,{[n]:r}=t.getProps([n],i);return Math.abs(e-r)<s.radius+s.hitRadius}NE.id="line",NE.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0},NE.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},NE.descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t};class VE extends Yx{constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,n){const i=this.options,{x:s,y:r}=this.getProps(["x","y"],n);return Math.pow(t-s,2)+Math.pow(e-r,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(t,e){return LE(this,t,"x",e)}inYRange(t,e){return LE(this,t,"y",e)}getCenterPoint(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}size(t){let e=(t=t||this.options||{}).radius||0;e=Math.max(e,e&&t.hoverRadius||0);return 2*(e+(e&&t.borderWidth||0))}draw(t,e){const n=this.options;this.skip||n.radius<.1||!rw(this,e,this.size(n)/2)||(t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.fillStyle=n.backgroundColor,iw(t,n,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function FE(t,e){const{x:n,y:i,base:s,width:r,height:o}=t.getProps(["x","y","base","width","height"],e);let a,c,h,l,u;return t.horizontal?(u=o/2,a=Math.min(n,s),c=Math.max(n,s),h=i-u,l=i+u):(u=r/2,a=n-u,c=n+u,h=Math.min(i,s),l=Math.max(i,s)),{left:a,top:h,right:c,bottom:l}}function UE(t,e,n,i){return t?0:Kb(e,n,i)}function jE(t){const e=FE(t),n=e.right-e.left,i=e.bottom-e.top,s=function(t,e,n){const i=t.options.borderWidth,s=t.borderSkipped,r=yw(i);return{t:UE(s.top,r.top,0,n),r:UE(s.right,r.right,0,e),b:UE(s.bottom,r.bottom,0,n),l:UE(s.left,r.left,0,e)}}(t,n/2,i/2),r=function(t,e,n){const{enableBorderRadius:i}=t.getProps(["enableBorderRadius"]),s=t.options.borderRadius,r=vw(s),o=Math.min(e,n),a=t.borderSkipped,c=i||rb(s);return{topLeft:UE(!c||a.top||a.left,r.topLeft,0,o),topRight:UE(!c||a.top||a.right,r.topRight,0,o),bottomLeft:UE(!c||a.bottom||a.left,r.bottomLeft,0,o),bottomRight:UE(!c||a.bottom||a.right,r.bottomRight,0,o)}}(t,n/2,i/2);return{outer:{x:e.left,y:e.top,w:n,h:i,radius:r},inner:{x:e.left+s.l,y:e.top+s.t,w:n-s.l-s.r,h:i-s.t-s.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,r.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(s.b,s.r))}}}}function BE(t,e,n,i){const s=null===e,r=null===n,o=t&&!(s&&r)&&FE(t,i);return o&&(s||Gb(e,o.left,o.right))&&(r||Gb(n,o.top,o.bottom))}function zE(t,e){t.rect(e.x,e.y,e.w,e.h)}function HE(t,e,n={}){const i=t.x!==n.x?-e:0,s=t.y!==n.y?-e:0,r=(t.x+t.w!==n.x+n.w?e:0)-i,o=(t.y+t.h!==n.y+n.h?e:0)-s;return{x:t.x+i,y:t.y+s,w:t.w+r,h:t.h+o,radius:t.radius}}VE.id="point",VE.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0},VE.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};class WE extends Yx{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:n,backgroundColor:i}}=this,{inner:s,outer:r}=jE(this),o=(a=r.radius).topLeft||a.topRight||a.bottomLeft||a.bottomRight?dw:zE;var a;t.save(),r.w===s.w&&r.h===s.h||(t.beginPath(),o(t,HE(r,e,s)),t.clip(),o(t,HE(s,-e,r)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),o(t,HE(s,e)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,e,n){return BE(this,t,e,n)}inXRange(t,e){return BE(this,t,null,e)}inYRange(t,e){return BE(this,null,t,e)}getCenterPoint(t){const{x:e,y:n,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],t);return{x:s?(e+i)/2:e,y:s?n:(n+i)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}WE.id="bar",WE.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0},WE.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var $E=Object.freeze({__proto__:null,ArcElement:kE,LineElement:NE,PointElement:VE,BarElement:WE});function qE(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{value:e})}}function KE(t){t.data.datasets.forEach((t=>{qE(t)}))}var GE={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,n)=>{if(!n.enabled)return void KE(t);const i=t.width;t.data.datasets.forEach(((e,s)=>{const{_data:o,indexAxis:a}=e,c=t.getDatasetMeta(s),h=o||e.data;if("y"===ww([a,t.options.indexAxis]))return;if(!c.controller.supportsDecimation)return;const l=t.scales[c.xAxisID];if("linear"!==l.type&&"time"!==l.type)return;if(t.options.parsing)return;let{start:u,count:d}=function(t,e){const n=e.length;let i,s=0;const{iScale:r}=t,{min:o,max:a,minDefined:c,maxDefined:h}=r.getUserBounds();return c&&(s=Kb(Xb(e,r.axis,o).lo,0,n-1)),i=h?Kb(Xb(e,r.axis,a).hi+1,s,n)-s:n-s,{start:s,count:i}}(c,h);if(d<=(n.threshold||4*i))return void qE(e);let f;switch(ib(o)&&(e._data=h,delete e.data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(t){this._data=t}})),n.algorithm){case"lttb":f=function(t,e,n,i,s){const r=s.samples||i;if(r>=n)return t.slice(e,e+n);const o=[],a=(n-2)/(r-2);let c=0;const h=e+n-1;let l,u,d,f,p,g=e;for(o[c++]=t[g],l=0;l<r-2;l++){let i,s=0,r=0;const h=Math.floor((l+1)*a)+1+e,m=Math.min(Math.floor((l+2)*a)+1,n)+e,y=m-h;for(i=h;i<m;i++)s+=t[i].x,r+=t[i].y;s/=y,r/=y;const v=Math.floor(l*a)+1+e,b=Math.min(Math.floor((l+1)*a)+1,n)+e,{x:_,y:w}=t[g];for(d=f=-1,i=v;i<b;i++)f=.5*Math.abs((_-s)*(t[i].y-w)-(_-t[i].x)*(r-w)),f>d&&(d=f,u=t[i],p=i);o[c++]=u,g=p}return o[c++]=t[h],o}(h,u,d,i,n);break;case"min-max":f=function(t,e,n,i){let s,o,a,c,h,l,u,d,f,p,g=0,m=0;const y=[],v=e+n-1,b=t[e].x,_=t[v].x-b;for(s=e;s<e+n;++s){o=t[s],a=(o.x-b)/_*i,c=o.y;const e=0|a;if(e===h)c<f?(f=c,l=s):c>p&&(p=c,u=s),g=(m*g+o.x)/++m;else{const n=s-1;if(!ib(l)&&!ib(u)){const e=Math.min(l,u),i=Math.max(l,u);e!==d&&e!==n&&y.push(r(r({},t[e]),{x:g})),i!==d&&i!==n&&y.push(r(r({},t[i]),{x:g}))}s>0&&n!==d&&y.push(t[n]),y.push(o),h=e,m=0,f=p=c,l=u=d=s}}return y}(h,u,d,i);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}e._decimated=f}))},destroy(t){KE(t)}};function YE(t,e,n,i){if(i)return;let s=e[t],r=n[t];return"angle"===t&&(s=$b(s),r=$b(r)),{property:t,start:s,end:r}}function XE(t,e,n){for(;e>t;e--){const t=n[e];if(!isNaN(t.x)&&!isNaN(t.y))break}return e}function QE(t,e,n,i){return t&&e?i(t[n],e[n]):t?t[n]:e?e[n]:0}function JE(t,e){let n=[],i=!1;return sb(t)?(i=!0,n=t):n=function(t,e){const{x:n=null,y:i=null}=t||{},s=e.points,r=[];return e.segments.forEach((({start:t,end:e})=>{e=XE(t,e,s);const o=s[t],a=s[e];null!==i?(r.push({x:o.x,y:i}),r.push({x:a.x,y:i})):null!==n&&(r.push({x:n,y:o.y}),r.push({x:n,y:a.y}))})),r}(t,e),n.length?new NE({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function ZE(t){return t&&!1!==t.fill}function tT(t,e,n){let i=t[e].fill;const s=[e];let r;if(!n)return i;for(;!1!==i&&-1===s.indexOf(i);){if(!ob(i))return i;if(r=t[i],!r)return!1;if(r.visible)return i;s.push(i),i=r.fill}return!1}function eT(t,e,n){const i=function(t){const e=t.options,n=e.fill;let i=cb(n&&n.target,n);void 0===i&&(i=!!e.backgroundColor);if(!1===i||null===i)return!1;if(!0===i)return"origin";return i}(t);if(rb(i))return!isNaN(i.value)&&i;let s=parseFloat(i);return ob(s)&&Math.floor(s)===s?function(t,e,n,i){"-"!==t&&"+"!==t||(n=e+n);if(n===e||n<0||n>=i)return!1;return n}(i[0],e,s,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function nT(t,e,n){const i=[];for(let s=0;s<n.length;s++){const r=n[s],{first:o,last:a,point:c}=iT(r,e,"x");if(!(!c||o&&a))if(o)i.unshift(c);else if(t.push(c),!a)break}t.push(...i)}function iT(t,e,n){const i=t.interpolate(e,n);if(!i)return{};const s=i[n],r=t.segments,o=t.points;let a=!1,c=!1;for(let h=0;h<r.length;h++){const t=r[h],e=o[t.start][n],i=o[t.end][n];if(Gb(s,e,i)){a=s===e,c=s===i;break}}return{first:a,last:c,point:i}}class sT{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,n){const{x:i,y:s,radius:r}=this;return e=e||{start:0,end:kb},t.arc(i,s,r,e.end,e.start,!0),!n.bounds}interpolate(t){const{x:e,y:n,radius:i}=this,s=t.angle;return{x:e+Math.cos(s)*i,y:n+Math.sin(s)*i,angle:s}}}function rT(t){const{chart:e,fill:n,line:i}=t;if(ob(n))return function(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}(e,n);if("stack"===n)return function(t){const{scale:e,index:n,line:i}=t,s=[],r=i.segments,o=i.points,a=function(t,e){const n=[],i=t.getMatchingVisibleMetas("line");for(let s=0;s<i.length;s++){const t=i[s];if(t.index===e)break;t.hidden||n.unshift(t.dataset)}return n}(e,n);a.push(JE({x:null,y:e.bottom},i));for(let c=0;c<r.length;c++){const t=r[c];for(let e=t.start;e<=t.end;e++)nT(s,o[e],a)}return new NE({points:s,options:{}})}(t);if("shape"===n)return!0;const s=function(t){if((t.scale||{}).getPointPositionForValue)return function(t){const{scale:e,fill:n}=t,i=e.options,s=e.getLabels().length,r=i.reverse?e.max:e.min,o=function(t,e,n){let i;return i="start"===t?n:"end"===t?e.options.reverse?e.min:e.max:rb(t)?t.value:e.getBaseValue(),i}(n,e,r),a=[];if(i.grid.circular){const t=e.getPointPositionForValue(0,r);return new sT({x:t.x,y:t.y,radius:e.getDistanceFromCenterForValue(o)})}for(let c=0;c<s;++c)a.push(e.getPointPositionForValue(c,o));return a}(t);return function(t){const{scale:e={},fill:n}=t,i=function(t,e){let n=null;return"start"===t?n=e.bottom:"end"===t?n=e.top:rb(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}(n,e);if(ob(i)){const t=e.isHorizontal();return{x:t?i:null,y:t?null:i}}return null}(t)}(t);return s instanceof sT?s:JE(s,i)}function oT(t,e,n){const i=rT(e),{line:s,scale:r,axis:o}=e,a=s.options,c=a.fill,h=a.backgroundColor,{above:l=h,below:u=h}=c||{};i&&s.points.length&&(ow(t,n),function(t,e){const{line:n,target:i,above:s,below:r,area:o,scale:a}=e,c=n._loop?"angle":e.axis;t.save(),"x"===c&&r!==s&&(aT(t,i,o.top),cT(t,{line:n,target:i,color:s,scale:a,property:c}),t.restore(),t.save(),aT(t,i,o.bottom));cT(t,{line:n,target:i,color:r,scale:a,property:c}),t.restore()}(t,{line:s,target:i,above:l,below:u,area:n,scale:r,axis:o}),aw(t))}function aT(t,e,n){const{segments:i,points:s}=e;let r=!0,o=!1;t.beginPath();for(const a of i){const{start:i,end:c}=a,h=s[i],l=s[XE(i,c,s)];r?(t.moveTo(h.x,h.y),r=!1):(t.lineTo(h.x,n),t.lineTo(h.x,h.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(l.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function cT(t,e){const{line:n,target:i,property:s,color:r,scale:o}=e,a=function(t,e,n){const i=t.segments,s=t.points,r=e.points,o=[];for(const a of i){let{start:t,end:i}=a;i=XE(t,i,s);const c=YE(n,s[t],s[i],a.loop);if(!e.segments){o.push({source:a,target:c,start:s[t],end:s[i]});continue}const h=fx(e,c);for(const e of h){const t=YE(n,r[e.start],r[e.end],e.loop),i=dx(a,s,t);for(const s of i)o.push({source:s,target:e,start:{[n]:QE(c,t,"start",Math.max)},end:{[n]:QE(c,t,"end",Math.min)}})}}return o}(n,i,s);for(const{source:c,target:h,start:l,end:u}of a){const{style:{backgroundColor:e=r}={}}=c,a=!0!==i;t.save(),t.fillStyle=e,hT(t,o,a&&YE(s,l,u)),t.beginPath();const d=!!n.pathSegment(t,c);let f;if(a){d?t.closePath():lT(t,i,u,s);const e=!!i.pathSegment(t,h,{move:d,reverse:!0});f=d&&e,f||lT(t,i,l,s)}t.closePath(),t.fill(f?"evenodd":"nonzero"),t.restore()}}function hT(t,e,n){const{top:i,bottom:s}=e.chart.chartArea,{property:r,start:o,end:a}=n||{};"x"===r&&(t.beginPath(),t.rect(o,i,a-o,s-i),t.clip())}function lT(t,e,n,i){const s=e.interpolate(n,i);s&&t.lineTo(s.x,s.y)}var uT={id:"filler",afterDatasetsUpdate(t,e,n){const i=(t.data.datasets||[]).length,s=[];let r,o,a,c;for(o=0;o<i;++o)r=t.getDatasetMeta(o),a=r.dataset,c=null,a&&a.options&&a instanceof NE&&(c={visible:t.isDatasetVisible(o),index:o,fill:eT(a,o,i),chart:t,axis:r.controller.options.indexAxis,scale:r.vScale,line:a}),r.$filler=c,s.push(c);for(o=0;o<i;++o)c=s[o],c&&!1!==c.fill&&(c.fill=tT(s,o,n.propagate))},beforeDraw(t,e,n){const i="beforeDraw"===n.drawTime,s=t.getSortedVisibleDatasetMetas(),r=t.chartArea;for(let o=s.length-1;o>=0;--o){const e=s[o].$filler;e&&(e.line.updateControlPoints(r,e.axis),i&&e.fill&&oT(t.ctx,e,r))}},beforeDatasetsDraw(t,e,n){if("beforeDatasetsDraw"!==n.drawTime)return;const i=t.getSortedVisibleDatasetMetas();for(let s=i.length-1;s>=0;--s){const e=i[s].$filler;ZE(e)&&oT(t.ctx,e,t.chartArea)}},beforeDatasetDraw(t,e,n){const i=e.meta.$filler;ZE(i)&&"beforeDatasetDraw"===n.drawTime&&oT(t.ctx,i,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const dT=(t,e)=>{let{boxHeight:n=e,boxWidth:i=e}=t;return t.usePointStyle&&(n=Math.min(n,e),i=t.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(e,n)}};class fT extends Yx{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,n){this.maxWidth=t,this.maxHeight=e,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=lb(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter((e=>t.filter(e,this.chart.data)))),t.sort&&(e=e.sort(((e,n)=>t.sort(e,n,this.chart.data)))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display)return void(this.width=this.height=0);const n=t.labels,i=_w(n.font),s=i.size,r=this._computeTitleHeight(),{boxWidth:o,itemHeight:a}=dT(n,s);let c,h;e.font=i.string,this.isHorizontal()?(c=this.maxWidth,h=this._fitRows(r,s,o,a)+10):(h=this.maxHeight,c=this._fitCols(r,s,o,a)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,e,n,i){const{ctx:s,maxWidth:r,options:{labels:{padding:o}}}=this,a=this.legendHitBoxes=[],c=this.lineWidths=[0],h=i+o;let l=t;s.textAlign="left",s.textBaseline="middle";let u=-1,d=-h;return this.legendItems.forEach(((t,f)=>{const p=n+e/2+s.measureText(t.text).width;(0===f||c[c.length-1]+p+2*o>r)&&(l+=h,c[c.length-(f>0?0:1)]=0,d+=h,u++),a[f]={left:0,top:d,row:u,width:p,height:i},c[c.length-1]+=p+o})),l}_fitCols(t,e,n,i){const{ctx:s,maxHeight:r,options:{labels:{padding:o}}}=this,a=this.legendHitBoxes=[],c=this.columnSizes=[],h=r-t;let l=o,u=0,d=0,f=0,p=0;return this.legendItems.forEach(((t,r)=>{const g=n+e/2+s.measureText(t.text).width;r>0&&d+i+2*o>h&&(l+=u+o,c.push({width:u,height:d}),f+=u+o,p++,u=d=0),a[r]={left:f,top:d,col:p,width:g,height:i},u=Math.max(u,g),d+=i+o})),l+=u,c.push({width:u,height:d}),l}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:n,labels:{padding:i},rtl:s}}=this,r=ax(s,this.left,this.width);if(this.isHorizontal()){let s=0,o=s_(n,this.left+i,this.right-this.lineWidths[s]);for(const a of e)s!==a.row&&(s=a.row,o=s_(n,this.left+i,this.right-this.lineWidths[s])),a.top+=this.top+t+i,a.left=r.leftForLtr(r.x(o),a.width),o+=a.width+i}else{let s=0,o=s_(n,this.top+t+i,this.bottom-this.columnSizes[s].height);for(const a of e)a.col!==s&&(s=a.col,o=s_(n,this.top+t+i,this.bottom-this.columnSizes[s].height)),a.top=o,a.left+=this.left+i,a.left=r.leftForLtr(r.x(a.left),a.width),o+=a.height+i}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const t=this.ctx;ow(t,this),this._draw(),aw(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:n,ctx:i}=this,{align:s,labels:r}=t,o=J_.color,a=ax(t.rtl,this.left,this.width),c=_w(r.font),{color:h,padding:l}=r,u=c.size,d=u/2;let f;this.drawTitle(),i.textAlign=a.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=c.string;const{boxWidth:p,boxHeight:g,itemHeight:m}=dT(r,u),y=this.isHorizontal(),v=this._computeTitleHeight();f=y?{x:s_(s,this.left+l,this.right-n[0]),y:this.top+l+v,line:0}:{x:this.left+l,y:s_(s,this.top+v+l,this.bottom-e[0].height),line:0},cx(this.ctx,t.textDirection);const b=m+l;this.legendItems.forEach(((_,w)=>{i.strokeStyle=_.fontColor||h,i.fillStyle=_.fontColor||h;const x=i.measureText(_.text).width,S=a.textAlign(_.textAlign||(_.textAlign=r.textAlign)),E=p+d+x;let T=f.x,k=f.y;a.setWidth(this.width),y?w>0&&T+E+l>this.right&&(k=f.y+=b,f.line++,T=f.x=s_(s,this.left+l,this.right-n[f.line])):w>0&&k+b>this.bottom&&(T=f.x=T+e[f.line].width+l,f.line++,k=f.y=s_(s,this.top+v+l,this.bottom-e[f.line].height));!function(t,e,n){if(isNaN(p)||p<=0||isNaN(g)||g<0)return;i.save();const s=cb(n.lineWidth,1);if(i.fillStyle=cb(n.fillStyle,o),i.lineCap=cb(n.lineCap,"butt"),i.lineDashOffset=cb(n.lineDashOffset,0),i.lineJoin=cb(n.lineJoin,"miter"),i.lineWidth=s,i.strokeStyle=cb(n.strokeStyle,o),i.setLineDash(cb(n.lineDash,[])),r.usePointStyle){const o={radius:g*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:s},c=a.xPlus(t,p/2);sw(i,o,c,e+d,r.pointStyleWidth&&p)}else{const r=e+Math.max((u-g)/2,0),o=a.leftForLtr(t,p),c=vw(n.borderRadius);i.beginPath(),Object.values(c).some((t=>0!==t))?dw(i,{x:o,y:r,w:p,h:g,radius:c}):i.rect(o,r,p,g),i.fill(),0!==s&&i.stroke()}i.restore()}(a.x(T),k,_),T=((t,e,n,i)=>t===(i?"left":"right")?n:"center"===t?(e+n)/2:e)(S,T+p+d,y?T+E:this.right,t.rtl),function(t,e,n){lw(i,n.text,t,e+m/2,c,{strikethrough:n.hidden,textAlign:a.textAlign(n.textAlign)})}(a.x(T),k,_),y?f.x+=E+l:f.y+=b})),hx(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,n=_w(e.font),i=bw(e.padding);if(!e.display)return;const s=ax(t.rtl,this.left,this.width),r=this.ctx,o=e.position,a=n.size/2,c=i.top+a;let h,l=this.left,u=this.width;if(this.isHorizontal())u=Math.max(...this.lineWidths),h=this.top+c,l=s_(t.align,l,this.right-u);else{const e=this.columnSizes.reduce(((t,e)=>Math.max(t,e.height)),0);h=c+s_(t.align,this.top,this.bottom-e-t.labels.padding-this._computeTitleHeight())}const d=s_(o,l,l+u);r.textAlign=s.textAlign(i_(o)),r.textBaseline="middle",r.strokeStyle=e.color,r.fillStyle=e.color,r.font=n.string,lw(r,e.text,d,h,n)}_computeTitleHeight(){const t=this.options.title,e=_w(t.font),n=bw(t.padding);return t.display?e.lineHeight+n.height:0}_getLegendItemAt(t,e){let n,i,s;if(Gb(t,this.left,this.right)&&Gb(e,this.top,this.bottom))for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(i=s[n],Gb(t,i.left,i.left+i.width)&&Gb(e,i.top,i.top+i.height))return this.legendItems[n];return null}handleEvent(t){const e=this.options;if(!function(t,e){if(("mousemove"===t||"mouseout"===t)&&(e.onHover||e.onLeave))return!0;if(e.onClick&&("click"===t||"mouseup"===t))return!0;return!1}(t.type,e))return;const n=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type||"mouseout"===t.type){const i=this._hoveredItem,s=((t,e)=>null!==t&&null!==e&&t.datasetIndex===e.datasetIndex&&t.index===e.index)(i,n);i&&!s&&lb(e.onLeave,[t,i,this],this),this._hoveredItem=n,n&&!s&&lb(e.onHover,[t,n,this],this)}else n&&lb(e.onClick,[t,n,this],this)}}var pT={id:"legend",_element:fT,start(t,e,n){const i=t.legend=new fT({ctx:t.ctx,options:n,chart:t});PS.configure(t,i,n),PS.addBox(t,i)},stop(t){PS.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const i=t.legend;PS.configure(t,i,n),i.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const i=e.datasetIndex,s=n.chart;s.isDatasetVisible(i)?(s.hide(i),e.hidden=!0):(s.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:s,color:r}}=t.legend.options;return t._getSortedDatasetMetas().map((t=>{const o=t.controller.getStyle(n?0:void 0),a=bw(o.borderWidth);return{text:e[t.index].label,fillStyle:o.backgroundColor,fontColor:r,hidden:!t.visible,lineCap:o.borderCapStyle,lineDash:o.borderDash,lineDashOffset:o.borderDashOffset,lineJoin:o.borderJoinStyle,lineWidth:(a.width+a.height)/4,strokeStyle:o.borderColor,pointStyle:i||o.pointStyle,rotation:o.rotation,textAlign:s||o.textAlign,borderRadius:0,datasetIndex:t.index}}),this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class gT extends Yx{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const i=sb(n.text)?n.text.length:1;this._padding=bw(n.padding);const s=i*_w(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:n,bottom:i,right:s,options:r}=this,o=r.align;let a,c,h,l=0;return this.isHorizontal()?(c=s_(o,n,s),h=e+t,a=s-n):("left"===r.position?(c=n+t,h=s_(o,i,e),l=-.5*Tb):(c=s-t,h=s_(o,e,i),l=.5*Tb),a=i-e),{titleX:c,titleY:h,maxWidth:a,rotation:l}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const n=_w(e.font),i=n.lineHeight/2+this._padding.top,{titleX:s,titleY:r,maxWidth:o,rotation:a}=this._drawArgs(i);lw(t,e.text,0,0,n,{color:e.color,maxWidth:o,rotation:a,textAlign:i_(e.align),textBaseline:"middle",translation:[s,r]})}}var mT={id:"title",_element:gT,start(t,e,n){!function(t,e){const n=new gT({ctx:t.ctx,options:e,chart:t});PS.configure(t,n,e),PS.addBox(t,n),t.titleBlock=n}(t,n)},stop(t){const e=t.titleBlock;PS.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const i=t.titleBlock;PS.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const yT=new WeakMap;var vT={id:"subtitle",start(t,e,n){const i=new gT({ctx:t.ctx,options:n,chart:t});PS.configure(t,i,n),PS.addBox(t,i),yT.set(t,i)},stop(t){PS.removeBox(t,yT.get(t)),yT.delete(t)},beforeUpdate(t,e,n){const i=yT.get(t);PS.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const bT={average(t){if(!t.length)return!1;let e,n,i=0,s=0,r=0;for(e=0,n=t.length;e<n;++e){const n=t[e].element;if(n&&n.hasValue()){const t=n.tooltipPosition();i+=t.x,s+=t.y,++r}}return{x:i/r,y:s/r}},nearest(t,e){if(!t.length)return!1;let n,i,s,r=e.x,o=e.y,a=Number.POSITIVE_INFINITY;for(n=0,i=t.length;n<i;++n){const i=t[n].element;if(i&&i.hasValue()){const t=Hb(e,i.getCenterPoint());t<a&&(a=t,s=i)}}if(s){const t=s.tooltipPosition();r=t.x,o=t.y}return{x:r,y:o}}};function _T(t,e){return e&&(sb(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function wT(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function xT(t,e){const{element:n,datasetIndex:i,index:s}=e,r=t.getDatasetMeta(i).controller,{label:o,value:a}=r.getLabelAndValue(s);return{chart:t,label:o,parsed:r.getParsed(s),raw:t.data.datasets[i].data[s],formattedValue:a,dataset:r.getDataset(),dataIndex:s,datasetIndex:i,element:n}}function ST(t,e){const n=t.chart.ctx,{body:i,footer:s,title:r}=t,{boxWidth:o,boxHeight:a}=e,c=_w(e.bodyFont),h=_w(e.titleFont),l=_w(e.footerFont),u=r.length,d=s.length,f=i.length,p=bw(e.padding);let g=p.height,m=0,y=i.reduce(((t,e)=>t+e.before.length+e.lines.length+e.after.length),0);if(y+=t.beforeBody.length+t.afterBody.length,u&&(g+=u*h.lineHeight+(u-1)*e.titleSpacing+e.titleMarginBottom),y){g+=f*(e.displayColors?Math.max(a,c.lineHeight):c.lineHeight)+(y-f)*c.lineHeight+(y-1)*e.bodySpacing}d&&(g+=e.footerMarginTop+d*l.lineHeight+(d-1)*e.footerSpacing);let v=0;const b=function(t){m=Math.max(m,n.measureText(t).width+v)};return n.save(),n.font=h.string,ub(t.title,b),n.font=c.string,ub(t.beforeBody.concat(t.afterBody),b),v=e.displayColors?o+2+e.boxPadding:0,ub(i,(t=>{ub(t.before,b),ub(t.lines,b),ub(t.after,b)})),v=0,n.font=l.string,ub(t.footer,b),n.restore(),m+=p.width,{width:m,height:g}}function ET(t,e,n,i){const{x:s,width:r}=n,{width:o,chartArea:{left:a,right:c}}=t;let h="center";return"center"===i?h=s<=(a+c)/2?"left":"right":s<=r/2?h="left":s>=o-r/2&&(h="right"),function(t,e,n,i){const{x:s,width:r}=i,o=n.caretSize+n.caretPadding;return"left"===t&&s+r+o>e.width||"right"===t&&s-r-o<0||void 0}(h,t,e,n)&&(h="center"),h}function TT(t,e,n){const i=n.yAlign||e.yAlign||function(t,e){const{y:n,height:i}=e;return n<i/2?"top":n>t.height-i/2?"bottom":"center"}(t,n);return{xAlign:n.xAlign||e.xAlign||ET(t,e,n,i),yAlign:i}}function kT(t,e,n,i){const{caretSize:s,caretPadding:r,cornerRadius:o}=t,{xAlign:a,yAlign:c}=n,h=s+r,{topLeft:l,topRight:u,bottomLeft:d,bottomRight:f}=vw(o);let p=function(t,e){let{x:n,width:i}=t;return"right"===e?n-=i:"center"===e&&(n-=i/2),n}(e,a);const g=function(t,e,n){let{y:i,height:s}=t;return"top"===e?i+=n:i-="bottom"===e?s+n:s/2,i}(e,c,h);return"center"===c?"left"===a?p+=h:"right"===a&&(p-=h):"left"===a?p-=Math.max(l,d)+s:"right"===a&&(p+=Math.max(u,f)+s),{x:Kb(p,0,i.width-e.width),y:Kb(g,0,i.height-e.height)}}function IT(t,e,n){const i=bw(n.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-i.right:t.x+i.left}function CT(t){return _T([],wT(t))}function AT(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}class MT extends Yx{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart||t._chart,this._chart=this.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&e.options.animation&&n.animations,s=new wx(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=(t=this.chart.getContext(),e=this,n=this._tooltipItems,xw(t,{tooltip:e,tooltipItems:n,type:"tooltip"})));var t,e,n}getTitle(t,e){const{callbacks:n}=e,i=n.beforeTitle.apply(this,[t]),s=n.title.apply(this,[t]),r=n.afterTitle.apply(this,[t]);let o=[];return o=_T(o,wT(i)),o=_T(o,wT(s)),o=_T(o,wT(r)),o}getBeforeBody(t,e){return CT(e.callbacks.beforeBody.apply(this,[t]))}getBody(t,e){const{callbacks:n}=e,i=[];return ub(t,(t=>{const e={before:[],lines:[],after:[]},s=AT(n,t);_T(e.before,wT(s.beforeLabel.call(this,t))),_T(e.lines,s.label.call(this,t)),_T(e.after,wT(s.afterLabel.call(this,t))),i.push(e)})),i}getAfterBody(t,e){return CT(e.callbacks.afterBody.apply(this,[t]))}getFooter(t,e){const{callbacks:n}=e,i=n.beforeFooter.apply(this,[t]),s=n.footer.apply(this,[t]),r=n.afterFooter.apply(this,[t]);let o=[];return o=_T(o,wT(i)),o=_T(o,wT(s)),o=_T(o,wT(r)),o}_createItems(t){const e=this._active,n=this.chart.data,i=[],s=[],r=[];let o,a,c=[];for(o=0,a=e.length;o<a;++o)c.push(xT(this.chart,e[o]));return t.filter&&(c=c.filter(((e,i,s)=>t.filter(e,i,s,n)))),t.itemSort&&(c=c.sort(((e,i)=>t.itemSort(e,i,n)))),ub(c,(e=>{const n=AT(t.callbacks,e);i.push(n.labelColor.call(this,e)),s.push(n.labelPointStyle.call(this,e)),r.push(n.labelTextColor.call(this,e))})),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=r,this.dataPoints=c,c}update(t,e){const n=this.options.setContext(this.getContext()),i=this._active;let s,r=[];if(i.length){const t=bT[n.position].call(this,i,this._eventPosition);r=this._createItems(n),this.title=this.getTitle(r,n),this.beforeBody=this.getBeforeBody(r,n),this.body=this.getBody(r,n),this.afterBody=this.getAfterBody(r,n),this.footer=this.getFooter(r,n);const e=this._size=ST(this,n),o=Object.assign({},t,e),a=TT(this.chart,n,o),c=kT(n,o,a,this.chart);this.xAlign=a.xAlign,this.yAlign=a.yAlign,s={opacity:1,x:c.x,y:c.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(s={opacity:0});this._tooltipItems=r,this.$context=void 0,s&&this._resolveAnimations().update(this,s),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,n,i){const s=this.getCaretPosition(t,n,i);e.lineTo(s.x1,s.y1),e.lineTo(s.x2,s.y2),e.lineTo(s.x3,s.y3)}getCaretPosition(t,e,n){const{xAlign:i,yAlign:s}=this,{caretSize:r,cornerRadius:o}=n,{topLeft:a,topRight:c,bottomLeft:h,bottomRight:l}=vw(o),{x:u,y:d}=t,{width:f,height:p}=e;let g,m,y,v,b,_;return"center"===s?(b=d+p/2,"left"===i?(g=u,m=g-r,v=b+r,_=b-r):(g=u+f,m=g+r,v=b-r,_=b+r),y=g):(m="left"===i?u+Math.max(a,h)+r:"right"===i?u+f-Math.max(c,l)-r:this.caretX,"top"===s?(v=d,b=v-r,g=m-r,y=m+r):(v=d+p,b=v+r,g=m+r,y=m-r),_=v),{x1:g,x2:m,x3:y,y1:v,y2:b,y3:_}}drawTitle(t,e,n){const i=this.title,s=i.length;let r,o,a;if(s){const c=ax(n.rtl,this.x,this.width);for(t.x=IT(this,n.titleAlign,n),e.textAlign=c.textAlign(n.titleAlign),e.textBaseline="middle",r=_w(n.titleFont),o=n.titleSpacing,e.fillStyle=n.titleColor,e.font=r.string,a=0;a<s;++a)e.fillText(i[a],c.x(t.x),t.y+r.lineHeight/2),t.y+=r.lineHeight+o,a+1===s&&(t.y+=n.titleMarginBottom-o)}}_drawColorBox(t,e,n,i,s){const r=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:a,boxWidth:c,boxPadding:h}=s,l=_w(s.bodyFont),u=IT(this,"left",s),d=i.x(u),f=a<l.lineHeight?(l.lineHeight-a)/2:0,p=e.y+f;if(s.usePointStyle){const e={radius:Math.min(c,a)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},n=i.leftForLtr(d,c)+c/2,h=p+a/2;t.strokeStyle=s.multiKeyBackground,t.fillStyle=s.multiKeyBackground,iw(t,e,n,h),t.strokeStyle=r.borderColor,t.fillStyle=r.backgroundColor,iw(t,e,n,h)}else{t.lineWidth=rb(r.borderWidth)?Math.max(...Object.values(r.borderWidth)):r.borderWidth||1,t.strokeStyle=r.borderColor,t.setLineDash(r.borderDash||[]),t.lineDashOffset=r.borderDashOffset||0;const e=i.leftForLtr(d,c-h),n=i.leftForLtr(i.xPlus(d,1),c-h-2),o=vw(r.borderRadius);Object.values(o).some((t=>0!==t))?(t.beginPath(),t.fillStyle=s.multiKeyBackground,dw(t,{x:e,y:p,w:c,h:a,radius:o}),t.fill(),t.stroke(),t.fillStyle=r.backgroundColor,t.beginPath(),dw(t,{x:n,y:p+1,w:c-2,h:a-2,radius:o}),t.fill()):(t.fillStyle=s.multiKeyBackground,t.fillRect(e,p,c,a),t.strokeRect(e,p,c,a),t.fillStyle=r.backgroundColor,t.fillRect(n,p+1,c-2,a-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,e,n){const{body:i}=this,{bodySpacing:s,bodyAlign:r,displayColors:o,boxHeight:a,boxWidth:c,boxPadding:h}=n,l=_w(n.bodyFont);let u=l.lineHeight,d=0;const f=ax(n.rtl,this.x,this.width),p=function(n){e.fillText(n,f.x(t.x+d),t.y+u/2),t.y+=u+s},g=f.textAlign(r);let m,y,v,b,_,w,x;for(e.textAlign=r,e.textBaseline="middle",e.font=l.string,t.x=IT(this,g,n),e.fillStyle=n.bodyColor,ub(this.beforeBody,p),d=o&&"right"!==g?"center"===r?c/2+h:c+2+h:0,b=0,w=i.length;b<w;++b){for(m=i[b],y=this.labelTextColors[b],e.fillStyle=y,ub(m.before,p),v=m.lines,o&&v.length&&(this._drawColorBox(e,t,b,f,n),u=Math.max(l.lineHeight,a)),_=0,x=v.length;_<x;++_)p(v[_]),u=l.lineHeight;ub(m.after,p)}d=0,u=l.lineHeight,ub(this.afterBody,p),t.y-=s}drawFooter(t,e,n){const i=this.footer,s=i.length;let r,o;if(s){const a=ax(n.rtl,this.x,this.width);for(t.x=IT(this,n.footerAlign,n),t.y+=n.footerMarginTop,e.textAlign=a.textAlign(n.footerAlign),e.textBaseline="middle",r=_w(n.footerFont),e.fillStyle=n.footerColor,e.font=r.string,o=0;o<s;++o)e.fillText(i[o],a.x(t.x),t.y+r.lineHeight/2),t.y+=r.lineHeight+n.footerSpacing}}drawBackground(t,e,n,i){const{xAlign:s,yAlign:r}=this,{x:o,y:a}=t,{width:c,height:h}=n,{topLeft:l,topRight:u,bottomLeft:d,bottomRight:f}=vw(i.cornerRadius);e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.beginPath(),e.moveTo(o+l,a),"top"===r&&this.drawCaret(t,e,n,i),e.lineTo(o+c-u,a),e.quadraticCurveTo(o+c,a,o+c,a+u),"center"===r&&"right"===s&&this.drawCaret(t,e,n,i),e.lineTo(o+c,a+h-f),e.quadraticCurveTo(o+c,a+h,o+c-f,a+h),"bottom"===r&&this.drawCaret(t,e,n,i),e.lineTo(o+d,a+h),e.quadraticCurveTo(o,a+h,o,a+h-d),"center"===r&&"left"===s&&this.drawCaret(t,e,n,i),e.lineTo(o,a+l),e.quadraticCurveTo(o,a,o+l,a),e.closePath(),e.fill(),i.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,n=this.$animations,i=n&&n.x,s=n&&n.y;if(i||s){const n=bT[t.position].call(this,this._active,this._eventPosition);if(!n)return;const r=this._size=ST(this,t),o=Object.assign({},n,this._size),a=TT(e,t,o),c=kT(t,o,a,e);i._to===c.x&&s._to===c.y||(this.xAlign=a.xAlign,this.yAlign=a.yAlign,this.width=r.width,this.height=r.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,c))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(e);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const r=bw(e.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&o&&(t.save(),t.globalAlpha=n,this.drawBackground(s,t,i,e),cx(t,e.textDirection),s.y+=r.top,this.drawTitle(s,t,e),this.drawBody(s,t,e),this.drawFooter(s,t,e),hx(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const n=this._active,i=t.map((({datasetIndex:t,index:e})=>{const n=this.chart.getDatasetMeta(t);if(!n)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:n.data[e],index:e}})),s=!db(n,i),r=this._positionChanged(i,e);(s||r)&&(this._active=i,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,n=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],r=this._getActiveElements(t,s,e,n),o=this._positionChanged(r,t),a=e||!db(r,s)||o;return a&&(this._active=r,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),a}_getActiveElements(t,e,n,i){const s=this.options;if("mouseout"===t.type)return[];if(!i)return e;const r=this.chart.getElementsAtEventForMode(t,s.mode,s,n);return s.reverse&&r.reverse(),r}_positionChanged(t,e){const{caretX:n,caretY:i,options:s}=this,r=bT[s.position].call(this,t,e);return!1!==r&&(n!==r.x||i!==r.y)}}MT.positioners=bT;var DT={id:"tooltip",_element:MT,positioners:bT,afterInit(t,e,n){n&&(t.tooltip=new MT({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(!1===t.notifyPlugins("beforeTooltipDraw",n))return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:eb,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,i=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return n[e.dataIndex]}return""},afterTitle:eb,beforeBody:eb,beforeLabel:eb,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return ib(n)||(e+=n),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:eb,afterBody:eb,beforeFooter:eb,footer:eb,afterFooter:eb}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},OT=Object.freeze({__proto__:null,Decimation:GE,Filler:uT,Legend:pT,SubTitle:vT,Title:mT,Tooltip:DT});function PT(t,e,n,i){const s=t.indexOf(e);if(-1===s)return((t,e,n,i)=>("string"==typeof e?(n=t.push(e)-1,i.unshift({index:n,label:e})):isNaN(e)&&(n=null),n))(t,e,n,i);return s!==t.lastIndexOf(e)?n:s}class RT extends oS{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const t=this.getLabels();for(const{index:n,label:i}of e)t[n]===i&&t.splice(n,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(ib(t))return null;const n=this.getLabels();return((t,e)=>null===t?null:Kb(Math.round(t),0,e))(e=isFinite(e)&&n[e]===t?e:PT(n,t,cb(e,t),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(n=0),e||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const t=this.min,e=this.max,n=this.options.offset,i=[];let s=this.getLabels();s=0===t&&e===s.length-1?s:s.slice(t,e+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let r=t;r<=e;r++)i.push({value:r});return i}getLabelForValue(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!=typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function NT(t,e){const n=[],{bounds:i,step:s,min:r,max:o,precision:a,count:c,maxTicks:h,maxDigits:l,includeBounds:u}=t,d=s||1,f=h-1,{min:p,max:g}=e,m=!ib(r),y=!ib(o),v=!ib(c),b=(g-p)/(l+1);let _,w,x,S,E=Nb((g-p)/f/d)*d;if(E<1e-14&&!m&&!y)return[{value:p},{value:g}];S=Math.ceil(g/E)-Math.floor(p/E),S>f&&(E=Nb(S*E/f/d)*d),ib(a)||(_=Math.pow(10,a),E=Math.ceil(E*_)/_),"ticks"===i?(w=Math.floor(p/E)*E,x=Math.ceil(g/E)*E):(w=p,x=g),m&&y&&s&&function(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}((o-r)/s,E/1e3)?(S=Math.round(Math.min((o-r)/E,h)),E=(o-r)/S,w=r,x=o):v?(w=m?r:w,x=y?o:x,S=c-1,E=(x-w)/S):(S=(x-w)/E,S=Vb(S,Math.round(S),E/1e3)?Math.round(S):Math.ceil(S));const T=Math.max(Bb(E),Bb(w));_=Math.pow(10,ib(a)?T:a),w=Math.round(w*_)/_,x=Math.round(x*_)/_;let k=0;for(m&&(u&&w!==r?(n.push({value:r}),w<r&&k++,Vb(Math.round((w+k*E)*_)/_,r,LT(r,b,t))&&k++):w<r&&k++);k<S;++k)n.push({value:Math.round((w+k*E)*_)/_});return y&&u&&x!==o?n.length&&Vb(n[n.length-1].value,o,LT(o,b,t))?n[n.length-1].value=o:n.push({value:o}):y&&x!==o||n.push({value:x}),n}function LT(t,e,{horizontal:n,minRotation:i}){const s=Ub(i),r=(n?Math.sin(s):Math.cos(s))||.001,o=.75*e*(""+t).length;return Math.min(e/r,o)}RT.id="category",RT.defaults={ticks:{callback:RT.prototype.getLabelForValue}};class VT extends oS{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return ib(t)||("number"==typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:i,max:s}=this;const r=t=>i=e?i:t,o=t=>s=n?s:t;if(t){const t=Rb(i),e=Rb(s);t<0&&e<0?o(0):t>0&&e>0&&r(0)}if(i===s){let e=1;(s>=Number.MAX_SAFE_INTEGER||i<=Number.MIN_SAFE_INTEGER)&&(e=Math.abs(.05*s)),o(s+e),t||r(i-e)}this.min=i,this.max=s}getTickLimit(){const t=this.options.ticks;let e,{maxTicksLimit:n,stepSize:i}=t;return i?(e=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,e>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${e} ticks. Limiting to 1000.`),e=1e3)):(e=this.computeTickLimit(),n=n||11),n&&(e=Math.min(n,e)),e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i=NT({maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&Fb(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}configure(){const t=this.ticks;let e=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const i=(n-e)/Math.max(t.length-1,1)/2;e-=i,n+=i}this._startValue=e,this._endValue=n,this._valueRange=n-e}getLabelForValue(t){return ox(t,this.chart.options.locale,this.options.ticks.format)}}class FT extends VT{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=ob(t)?t:0,this.max=ob(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,n=Ub(this.options.ticks.minRotation),i=(t?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,s.lineHeight/i))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}function UT(t){return 1===t/Math.pow(10,Math.floor(Pb(t)))}FT.id="linear",FT.defaults={ticks:{callback:Qx.formatters.numeric}};class jT extends oS{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const n=VT.prototype.parse.apply(this,[t,e]);if(0!==n)return ob(n)&&n>0?n:null;this._zero=!0}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=ob(t)?Math.max(0,t):null,this.max=ob(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let n=this.min,i=this.max;const s=e=>n=t?n:e,r=t=>i=e?i:t,o=(t,e)=>Math.pow(10,Math.floor(Pb(t))+e);n===i&&(n<=0?(s(1),r(10)):(s(o(n,-1)),r(o(i,1)))),n<=0&&s(o(i,-1)),i<=0&&r(o(n,1)),this._zero&&this.min!==this._suggestedMin&&n===o(this.min,0)&&s(o(n,-1)),this.min=n,this.max=i}buildTicks(){const t=this.options,e=function(t,e){const n=Math.floor(Pb(e.max)),i=Math.ceil(e.max/Math.pow(10,n)),s=[];let r=ab(t.min,Math.pow(10,Math.floor(Pb(e.min)))),o=Math.floor(Pb(r)),a=Math.floor(r/Math.pow(10,o)),c=o<0?Math.pow(10,Math.abs(o)):1;do{s.push({value:r,major:UT(r)}),++a,10===a&&(a=1,++o,c=o>=0?1:c),r=Math.round(a*Math.pow(10,o)*c)/c}while(o<n||o===n&&a<i);const h=ab(t.max,r);return s.push({value:h,major:UT(r)}),s}({min:this._userMin,max:this._userMax},this);return"ticks"===t.bounds&&Fb(e,this,"value"),t.reverse?(e.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),e}getLabelForValue(t){return void 0===t?"0":ox(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=Pb(t),this._valueRange=Pb(this.max)-Pb(t)}getPixelForValue(t){return void 0!==t&&0!==t||(t=this.min),null===t||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(Pb(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function BT(t){const e=t.ticks;if(e.display&&t.display){const t=bw(e.backdropPadding);return cb(e.font&&e.font.size,J_.font.size)+t.height}return 0}function zT(t,e,n,i,s){return t===i||t===s?{start:e-n/2,end:e+n/2}:t<i||t>s?{start:e-n,end:e}:{start:e,end:e+n}}function HT(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),i=[],s=[],r=t._pointLabels.length,o=t.options.pointLabels,a=o.centerPointLabels?Tb/r:0;for(let u=0;u<r;u++){const r=o.setContext(t.getPointLabelContext(u));s[u]=r.padding;const d=t.getPointPosition(u,t.drawingArea+s[u],a),f=_w(r.font),p=(c=t.ctx,h=f,l=sb(l=t._pointLabels[u])?l:[l],{w:tw(c,h.string,l),h:l.length*h.lineHeight});i[u]=p;const g=$b(t.getIndexAngle(u)+a),m=Math.round(jb(g));WT(n,e,g,zT(m,d.x,p.w,0,180),zT(m,d.y,p.h,90,270))}var c,h,l;t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=function(t,e,n){const i=[],s=t._pointLabels.length,r=t.options,o=BT(r)/2,a=t.drawingArea,c=r.pointLabels.centerPointLabels?Tb/s:0;for(let h=0;h<s;h++){const s=t.getPointPosition(h,a+o+n[h],c),r=Math.round(jb($b(s.angle+Mb))),l=e[h],u=KT(s.y,l.h,r),d=$T(r),f=qT(s.x,l.w,d);i.push({x:s.x,y:u,textAlign:d,left:f,top:u,right:f+l.w,bottom:u+l.h})}return i}(t,i,s)}function WT(t,e,n,i,s){const r=Math.abs(Math.sin(n)),o=Math.abs(Math.cos(n));let a=0,c=0;i.start<e.l?(a=(e.l-i.start)/r,t.l=Math.min(t.l,e.l-a)):i.end>e.r&&(a=(i.end-e.r)/r,t.r=Math.max(t.r,e.r+a)),s.start<e.t?(c=(e.t-s.start)/o,t.t=Math.min(t.t,e.t-c)):s.end>e.b&&(c=(s.end-e.b)/o,t.b=Math.max(t.b,e.b+c))}function $T(t){return 0===t||180===t?"center":t<180?"left":"right"}function qT(t,e,n){return"right"===n?t-=e:"center"===n&&(t-=e/2),t}function KT(t,e,n){return 90===n||270===n?t-=e/2:(n>270||n<90)&&(t-=e),t}function GT(t,e,n,i){const{ctx:s}=t;if(n)s.arc(t.xCenter,t.yCenter,e,0,kb);else{let n=t.getPointPosition(0,e);s.moveTo(n.x,n.y);for(let r=1;r<i;r++)n=t.getPointPosition(r,e),s.lineTo(n.x,n.y)}}jT.id="logarithmic",jT.defaults={ticks:{callback:Qx.formatters.logarithmic,major:{enabled:!0}}};class YT extends VT{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=bw(BT(this.options)/2),e=this.width=this.maxWidth-t.width,n=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+n/2+t.top),this.drawingArea=Math.floor(Math.min(e,n)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=ob(t)&&!isNaN(t)?t:0,this.max=ob(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/BT(this.options))}generateTickLabels(t){VT.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map(((t,e)=>{const n=lb(this.options.pointLabels.callback,[t,e],this);return n||0===n?n:""})).filter(((t,e)=>this.chart.getDataVisibility(e)))}fit(){const t=this.options;t.display&&t.pointLabels.display?HT(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,n,i){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((n-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,n,i))}getIndexAngle(t){return $b(t*(kb/(this._pointLabels.length||1))+Ub(this.options.startAngle||0))}getDistanceFromCenterForValue(t){if(ib(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(ib(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const n=e[t];return function(t,e,n){return xw(t,{label:n,index:e,type:"pointLabel"})}(this.getContext(),t,n)}}getPointPosition(t,e,n=0){const i=this.getIndexAngle(t)-Mb+n;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter,angle:i}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:n,right:i,bottom:s}=this._pointLabelItems[t];return{left:e,top:n,right:i,bottom:s}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const n=this.ctx;n.save(),n.beginPath(),GT(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),n.closePath(),n.fillStyle=t,n.fill(),n.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:n,grid:i}=e,s=this._pointLabels.length;let r,o,a;if(e.pointLabels.display&&function(t,e){const{ctx:n,options:{pointLabels:i}}=t;for(let s=e-1;s>=0;s--){const e=i.setContext(t.getPointLabelContext(s)),r=_w(e.font),{x:o,y:a,textAlign:c,left:h,top:l,right:u,bottom:d}=t._pointLabelItems[s],{backdropColor:f}=e;if(!ib(f)){const t=vw(e.borderRadius),i=bw(e.backdropPadding);n.fillStyle=f;const s=h-i.left,r=l-i.top,o=u-h+i.width,a=d-l+i.height;Object.values(t).some((t=>0!==t))?(n.beginPath(),dw(n,{x:s,y:r,w:o,h:a,radius:t}),n.fill()):n.fillRect(s,r,o,a)}lw(n,t._pointLabels[s],o,a+r.lineHeight/2,r,{color:e.color,textAlign:c,textBaseline:"middle"})}}(this,s),i.display&&this.ticks.forEach(((t,e)=>{if(0!==e){o=this.getDistanceFromCenterForValue(t.value);!function(t,e,n,i){const s=t.ctx,r=e.circular,{color:o,lineWidth:a}=e;!r&&!i||!o||!a||n<0||(s.save(),s.strokeStyle=o,s.lineWidth=a,s.setLineDash(e.borderDash),s.lineDashOffset=e.borderDashOffset,s.beginPath(),GT(t,n,r,i),s.closePath(),s.stroke(),s.restore())}(this,i.setContext(this.getContext(e-1)),o,s)}})),n.display){for(t.save(),r=s-1;r>=0;r--){const i=n.setContext(this.getPointLabelContext(r)),{color:s,lineWidth:c}=i;c&&s&&(t.lineWidth=c,t.strokeStyle=s,t.setLineDash(i.borderDash),t.lineDashOffset=i.borderDashOffset,o=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),a=this.getPointPosition(r,o),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(a.x,a.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,n=e.ticks;if(!n.display)return;const i=this.getIndexAngle(0);let s,r;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(i),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach(((i,o)=>{if(0===o&&!e.reverse)return;const a=n.setContext(this.getContext(o)),c=_w(a.font);if(s=this.getDistanceFromCenterForValue(this.ticks[o].value),a.showLabelBackdrop){t.font=c.string,r=t.measureText(i.label).width,t.fillStyle=a.backdropColor;const e=bw(a.backdropPadding);t.fillRect(-r/2-e.left,-s-c.size/2-e.top,r+e.width,c.size+e.height)}lw(t,i.label,0,-s,c,{color:a.color})})),t.restore()}drawTitle(){}}YT.id="radialLinear",YT.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Qx.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:t=>t,padding:5,centerPointLabels:!1}},YT.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"},YT.descriptors={angleLines:{_fallback:"grid"}};const XT={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},QT=Object.keys(XT);function JT(t,e){return t-e}function ZT(t,e){if(ib(e))return null;const n=t._adapter,{parser:i,round:s,isoWeekday:r}=t._parseOpts;let o=e;return"function"==typeof i&&(o=i(o)),ob(o)||(o="string"==typeof i?n.parse(o,i):n.parse(o)),null===o?null:(s&&(o="week"!==s||!Lb(r)&&!0!==r?n.startOf(o,s):n.startOf(o,"isoWeek",r)),+o)}function tk(t,e,n,i){const s=QT.length;for(let r=QT.indexOf(t);r<s-1;++r){const t=XT[QT[r]],s=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((n-e)/(s*t.size))<=i)return QT[r]}return QT[s-1]}function ek(t,e,n){if(n){if(n.length){const{lo:i,hi:s}=Yb(n,e);t[n[i]>=e?n[i]:n[s]]=!0}}else t[e]=!0}function nk(t,e,n){const i=[],s={},r=e.length;let o,a;for(o=0;o<r;++o)a=e[o],s[a]=o,i.push({value:a,major:!1});return 0!==r&&n?function(t,e,n,i){const s=t._adapter,r=+s.startOf(e[0].value,i),o=e[e.length-1].value;let a,c;for(a=r;a<=o;a=+s.add(a,1,i))c=n[a],c>=0&&(e[c].major=!0);return e}(t,i,s,n):i}class ik extends oS{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e){const n=t.time||(t.time={}),i=this._adapter=new fS._date(t.adapters.date);i.init(e),yb(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:ZT(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,n=t.time.unit||"day";let{min:i,max:s,minDefined:r,maxDefined:o}=this.getUserBounds();function a(t){r||isNaN(t.min)||(i=Math.min(i,t.min)),o||isNaN(t.max)||(s=Math.max(s,t.max))}r&&o||(a(this._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||a(this.getMinMax(!1))),i=ob(i)&&!isNaN(i)?i:+e.startOf(Date.now(),n),s=ob(s)&&!isNaN(s)?s:+e.endOf(Date.now(),n)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],n=t[t.length-1]),{min:e,max:n}}buildTicks(){const t=this.options,e=t.time,n=t.ticks,i="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,r=function(t,e,n){let i=0,s=t.length;for(;i<s&&t[i]<e;)i++;for(;s>i&&t[s-1]>n;)s--;return i>0||s<t.length?t.slice(i,s):t}(i,s,this.max);return this._unit=e.unit||(n.autoSkip?tk(e.minUnit,this.min,this.max,this._getLabelCapacity(s)):function(t,e,n,i,s){for(let r=QT.length-1;r>=QT.indexOf(n);r--){const n=QT[r];if(XT[n].common&&t._adapter.diff(s,i,n)>=e-1)return n}return QT[n?QT.indexOf(n):0]}(this,r.length,e.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(t){for(let e=QT.indexOf(t)+1,n=QT.length;e<n;++e)if(XT[QT[e]].common)return QT[e]}(this._unit):void 0,this.initOffsets(i),t.reverse&&r.reverse(),nk(this,r,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((t=>+t.value)))}initOffsets(t){let e,n,i=0,s=0;this.options.offset&&t.length&&(e=this.getDecimalForValue(t[0]),i=1===t.length?1-e:(this.getDecimalForValue(t[1])-e)/2,n=this.getDecimalForValue(t[t.length-1]),s=1===t.length?n:(n-this.getDecimalForValue(t[t.length-2]))/2);const r=t.length<3?.5:.25;i=Kb(i,0,r),s=Kb(s,0,r),this._offsets={start:i,end:s,factor:1/(i+1+s)}}_generate(){const t=this._adapter,e=this.min,n=this.max,i=this.options,s=i.time,r=s.unit||tk(s.minUnit,e,n,this._getLabelCapacity(e)),o=cb(s.stepSize,1),a="week"===r&&s.isoWeekday,c=Lb(a)||!0===a,h={};let l,u,d=e;if(c&&(d=+t.startOf(d,"isoWeek",a)),d=+t.startOf(d,c?"day":r),t.diff(n,e,r)>1e5*o)throw new Error(e+" and "+n+" are too far apart with stepSize of "+o+" "+r);const f="data"===i.ticks.source&&this.getDataTimestamps();for(l=d,u=0;l<n;l=+t.add(l,o,r),u++)ek(h,l,f);return l!==n&&"ticks"!==i.bounds&&1!==u||ek(h,l,f),Object.keys(h).sort(((t,e)=>t-e)).map((t=>+t))}getLabelForValue(t){const e=this._adapter,n=this.options.time;return n.tooltipFormat?e.format(t,n.tooltipFormat):e.format(t,n.displayFormats.datetime)}_tickFormatFunction(t,e,n,i){const s=this.options,r=s.time.displayFormats,o=this._unit,a=this._majorUnit,c=o&&r[o],h=a&&r[a],l=n[e],u=a&&h&&l&&l.major,d=this._adapter.format(t,i||(u?h:c)),f=s.ticks.callback;return f?lb(f,[d,e,n],this):d}generateTickLabels(t){let e,n,i;for(e=0,n=t.length;e<n;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+n)*e.factor)}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,n=this.ctx.measureText(t).width,i=Ub(this.isHorizontal()?e.maxRotation:e.minRotation),s=Math.cos(i),r=Math.sin(i),o=this._resolveTickFontOptions(0).size;return{w:n*s+o*r,h:n*r+o*s}}_getLabelCapacity(t){const e=this.options.time,n=e.displayFormats,i=n[e.unit]||n.millisecond,s=this._tickFormatFunction(t,0,nk(this,[t],this._majorUnit),i),r=this._getLabelSize(s),o=Math.floor(this.isHorizontal()?this.width/r.w:this.height/r.h)-1;return o>0?o:1}getDataTimestamps(){let t,e,n=this._cache.data||[];if(n.length)return n;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,e=i.length;t<e;++t)n=n.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const t=this._cache.labels||[];let e,n;if(t.length)return t;const i=this.getLabels();for(e=0,n=i.length;e<n;++e)t.push(ZT(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return t_(t.sort(JT))}}function sk(t,e,n){let i,s,r,o,a=0,c=t.length-1;n?(e>=t[a].pos&&e<=t[c].pos&&({lo:a,hi:c}=Xb(t,"pos",e)),({pos:i,time:r}=t[a]),({pos:s,time:o}=t[c])):(e>=t[a].time&&e<=t[c].time&&({lo:a,hi:c}=Xb(t,"time",e)),({time:i,pos:r}=t[a]),({time:s,pos:o}=t[c]));const h=s-i;return h?r+(o-r)*(e-i)/h:r}ik.id="time",ik.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};class rk extends ik{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=sk(e,this.min),this._tableRange=sk(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:n}=this,i=[],s=[];let r,o,a,c,h;for(r=0,o=t.length;r<o;++r)c=t[r],c>=e&&c<=n&&i.push(c);if(i.length<2)return[{time:e,pos:0},{time:n,pos:1}];for(r=0,o=i.length;r<o;++r)h=i[r+1],a=i[r-1],c=i[r],Math.round((h+a)/2)!==c&&s.push({time:c,pos:r/(o-1)});return s}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),n=this.getLabelTimestamps();return t=e.length&&n.length?this.normalize(e.concat(n)):e.length?e:n,t=this._cache.all=t,t}getDecimalForValue(t){return(sk(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return sk(this._table,n*this._tableRange+this._minPos,!0)}}rk.id="timeseries",rk.defaults=ik.defaults;const ok=[lS,$E,OT,Object.freeze({__proto__:null,CategoryScale:RT,LinearScale:FT,LogarithmicScale:jT,RadialLinearScale:YT,TimeScale:ik,TimeSeriesScale:rk})],ak=new WeakMap,ck=_((t=>e=>{if(!(e instanceof O))throw new Error("unsafeHTML can only be used in text bindings");const n=ak.get(e);if(void 0!==n&&C(t)&&t===n.value&&e.value===n.fragment)return;const i=document.createElement("template");i.innerHTML=t;const s=document.importNode(i.content,!0);e.setValue(s),ak.set(e,{value:t,fragment:s})}));
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
As("firebase","9.9.4","app");export{ev as A,bE as C,yy as D,tv as E,Ie as R,wy as U,oo as a,co as b,uo as c,Zy as d,Yv as e,Qv as f,ha as g,lt as h,H as i,ht as j,nt as k,Xv as l,ck as m,ai as n,Si as o,Se as p,it as q,ok as r,ao as s,Ee as t,tb as u,Is as v,vy as x};
